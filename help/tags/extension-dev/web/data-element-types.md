---
title: Web 拡張機能のデータ要素タイプ
description: Web プロパティのタグ拡張機能用にデータ要素タイプライブラリモジュールを定義する方法について説明します。
source-git-commit: 7e27735697882065566ebdeccc36998ec368e404
workflow-type: ht
source-wordcount: '596'
ht-degree: 100%

---

# Web 拡張機能のデータ要素タイプ

>[!NOTE]
>
>Adobe Experience Platform Launch は、Adobe Experience Platform のデータ収集テクノロジースイートとしてリブランドされています。 その結果、製品ドキュメント全体でいくつかの用語の変更がロールアウトされました。用語の変更点の一覧については、次の[ドキュメント](../../term-updates.md)を参照してください。

データ収集タグにおいて、データ要素は基本的にページ上のデータに対するエイリアスです。 このデータは、クエリ文字列パラメーター、Cookie、DOM 要素、その他の場所にあります。 データ要素は、ルールから参照でき、これらのデータにアクセスするための抽象型として機能します。 

データ要素タイプは拡張機能によって提供されます。ユーザーはデータ要素タイプを使用することで、特定の方法でデータにアクセスするようデータ要素を設定できます。例えば、拡張機能には「local storage item」データ要素タイプを指定できます。ここで、 のユーザーは、ローカルストレージアイテム名を指定できます。 データ要素がルールで参照される場合、拡張機能では、ユーザーがデータ要素の設定時に指定したローカルストレージアイテム名を使用して、ローカルストレージアイテムの値を検索できます。

このドキュメントでは、Adobe Experience Platform で web 拡張機能のデータ要素タイプを定義する方法について説明します。

>[!IMPORTANT]
>
>エッジ拡張機能を開発する場合は、代わりに [エッジ拡張機能のデータ要素タイプ](../edge/data-element-types.md) に関するガイドを参照してください。
>
>このドキュメントでは、読者がライブラリモジュールと、ライブラリモジュールが web 拡張機能に統合される仕組みについて理解していることを前提としています。説明が必要な場合は、このガイドに戻る前に、 [ライブラリモジュールの形式](./format.md) の概要を参照してください。

通常、データ要素タイプは次の要素で構成されます。

1. データ収集 UI に表示される [ビュー](./views.md)。データ要素の設定を変更できます。
2. タグのランタイムライブラリ内で生成されるライブラリモジュール。設定を解釈し、データを取得します。

ユーザーが `productName` という名前のローカルストレージ項目からデータを取得できるようにするとします。モジュールは次のようになります。

```js
module.exports = function(settings) {
  return localStorage.getItem('productName');
}
```

Adobe Experience Platform ユーザーがローカルストレージ項目名を設定できるようにする場合は、ユーザーが名前を入力し、その名前を `settings` オブジェクトに保存できるようにします。オブジェクトは次のようになります。

```js
{
  itemName: "campaignId"
}
```

ユーザー定義のローカルストレージ項目名を操作するには、モジュールを次のように変更する必要があります。

```js
module.exports = function(settings) {
  return localStorage.getItem(settings.itemName);
}
```

## デフォルト値のサポート

ユーザーは、データ要素のデフォルト値を設定できることに注意してください。データ要素ライブラリモジュールが `undefined` または `null` の値を返す場合、ユーザーがデータ要素に設定したデフォルト値へと自動的に置き換えられます。

## コンテキストイベントデータ

トリガーされたルールの結果としてデータ要素が取得される場合（例えば、ルールの条件やアクションでデータ要素が使用される場合）、ルールを発動したイベントに関するコンテキスト情報を含む 2 つ目の引数がモジュールに渡されます。これは状況によってはメリットがあり、次のように指定することで実現できます。

```js
module.exports = function(settings, event) {
  // event contains information regarding the event that fired the rule
};
```

`event` オブジェクトには次のプロパティが含まれている必要があります。

| プロパティ | 説明 |
| --- | --- |
| `$type` | 拡張機能名とイベント名を表す文字列（ピリオドを使用して結合）。例：`youtube.play` |
| `$rule` | 現在実行中のルールに関する情報を含むオブジェクト。 オブジェクトには、次のサブプロパティが含まれている必要があります。<ul><li>`id`：現在実行中のルールの ID。</li><li>`name`：現在実行中のルールの名前。</li></ul> |

ルールをトリガーしたイベントタイプを提供する拡張機能では、必要に応じて、その他の役に立つ情報をこの `event` オブジェクトに追加できます。
