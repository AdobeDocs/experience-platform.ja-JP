---
title: Google Data Layer 拡張機能
description: Adobe Experience PlatformのGoogle Client Data Layer タグ拡張機能について説明します。
exl-id: 7990351d-8669-432b-94a9-4f9db1c2b3fe
source-git-commit: 51a263dc2f42fe3538f15f32c7573c69a2e2adc4
workflow-type: tm+mt
source-wordcount: '819'
ht-degree: 8%

---

# Google Data Layer 拡張機能（ベータ版）

>[!IMPORTANT]
>
>この拡張機能は現在ベータ版で、実稼動環境では完全にテストされていません。

Google データレイヤー拡張機能を使用すると、タグ実装で Google データレイヤーを使用できます。この拡張機能は、単独で、またはGoogleソリューションと同時に、Googleのオープンソースと共に使用できます [データレイヤーヘルパーライブラリ](https://github.com/google/data-layer-helper).

ヘルパーライブラリは、イベントクライアントデータデイヤー (ACDL) と同様のAdobe駆動型機能を提供します。 Google Data Layer 拡張機能のデータ要素、ルールおよびアクションは、 [ACDL 拡張機能](../client-data-layer/overview.md).

## 成熟度

拡張機能のバージョン 1.0.x はベータ版です。 この拡張機能は、実稼動環境では完全にテストされていません。

## インストール

拡張機能をインストールするには、データ収集 UI の拡張機能カタログに移動し、「 」を選択します。 **Google Data Layer**.

インストールすると、Web サイトでタグライブラリが読み込まれるたびに、拡張機能がデータレイヤーを作成するか、データレイヤーにアクセスします。

## 拡張機能ビュー

拡張機能を設定する場合（拡張機能のインストール時、または「 」を選択して） **[!UICONTROL 設定]** 拡張機能カタログから )、拡張機能が使用するデータレイヤーの名前を定義する必要があります。 ライブラリの読み込み時に設定済みの名前を持つデータレイヤーが存在しない場合、代わりに拡張機能によって作成されます。

>[!NOTE]
>
>GoogleまたはAdobeコードが最初に読み込まれて、データレイヤーが作成されるかどうかは関係ありません。 両方のシステムが、存在しない場合はデータレイヤーを作成するか、既存のデータレイヤーを使用します。

デフォルトでは、データレイヤーはGoogleのデフォルト名を使用します `dataLayer`.

## イベント

拡張機能を使用すると、データレイヤー内の変更（イベント）をリッスンできます。 イベントは、次のいずれかになります。

* イベントのタグ付け（読み込まれるライブラリなど）
* JavaScript イベント
* を使用してデータレイヤーにプッシュされたデータ `event` キーワード。

この [`event` キーワード](https://developers.google.com/tag-platform/devguides/datalayer#use_a_data_layer_with_event_handlers) データがGoogleデータレイヤーにプッシュされたとき (Adobeクライアントデータレイヤーと同様 )。 この `event` キーワードは、Googleデータレイヤーの動作を変更するので、それに応じて拡張機能の動作が更新されます。

以下の節では、拡張機能がリッスンできる様々なイベントタイプの概要を説明します。

### データレイヤーへのすべてのプッシュをリッスンします

このオプションを選択した場合、拡張機能では、データレイヤーに加えられた変更をリッスンします。

### イベントを除くプッシュのリッスン

このオプションを選択した場合、拡張機能は、データレイヤーにプッシュされるすべての情報（イベントを除く）をリッスンします。

次のサンプルのプッシュイベントは、リスナーによって追跡されます。

```js
dataLayer.push({"data":"something"})
```

次のサンプルのプッシュイベントは、リスナーによって追跡されません。

```js
dataLayer.push({"event":"myevent"})
dataLayer.push({"event":"myevent","data":"something"})
```

### すべてのイベントをリッスンする

このオプションを選択すると、拡張機能は、データレイヤーにプッシュされるイベントをリッスンします。

次のプッシュイベントの例は、リスナーによってトラッキングされます。

```js
dataLayer.push({"event":"myevent"})
dataLayer.push({"event":"myevent","data":"something"})
```

次のプッシュイベントの例は、リスナーによってトラッキングされません。

```js
dataLayer.push({"data":"something"})
```

### 特定のイベントをリッスンする

特定のイベントをリッスンする場合は、このオプションを選択して、特定の文字列に一致するイベントをイベントリスナーが追跡するようにします。

例えば、`myEvent` を指定してこの設定を使用すると、リスナーは次のプッシュイベントのみをトラッキングします。

```js
dataLayer.push({"event":"myEvent"})
```

正規表現文字列を使用してイベント名を照合することもできます。 例： `myEvent\d` は、 `myEvent` その後に数字が続く。

```js
dataLayer.push({"event":"myEvent1"})
dataLayer.push({"event":"myEvent2"})
```

## アクション

以下の節では、 [ルール](../../../ui/managing-resources/rules.md).

### データレイヤーにプッシュ {#push-to-data-layer}

このアクションは、JSON コンテンツをデータレイヤー自体にプッシュするので、JSON ペイロードで直接データ要素を使用できます。 提供される JSON エディター内で、パーセント表記を使用してデータ要素を参照できます ( 例： `%dataElementName%`) をクリックします。

```json
{
    "page": {
        "url": "%url%",
        "previous_url": "%previous_url%",
        "concatenated_values": "static string %dataElement%"
    }
}
```

### Google DL の計算済み状態へのリセット

>[!NOTE]
>
>このアクションは、v1.0.5 以降で使用できます。

この操作を実行すると、データレイヤーがリセットされます。 Googleのデータレイヤーの変更を処理するルールで使用すると、データレイヤーは、ルールがトリガーされた時点で、データレイヤーの計算済み状態にリセットされます。 Googleのデータレイヤーの変更を処理しないルールでアクションが使用される場合、このアクションはデータレイヤーを空にします。

## データ要素

拡張機能は、キーを使用してデータレイヤーにアクセスする一意のデータ要素を提供します ( 例： `page.url` 内 [上記のスニペット](#push-to-data-layer)) をクリックします。

データ要素は、次のいずれかを提供できます。

* データレイヤーの特定の値 ( 例： `page.url`)
* データレイヤー配列全体（空のキーフィールド）
* キーを使用してデータレイヤーイベントから取得した値 ( `event` キーワードが使用されました )
* イベントオブジェクト全体（空のキーフィールド）

拡張機能では、常にイベント情報が優先されます。 データレイヤーが `event` が処理中の場合、値は常にそのイベントから読み取られます。 次の場合、 `event` が存在しない場合、値は代わりに直接データレイヤーから読み込まれます。

## 追加情報

追加情報は、 [project README](https://github.com/adobe/reactor-extension-googledatalayer/blob/main/README.md) とを使用します。
