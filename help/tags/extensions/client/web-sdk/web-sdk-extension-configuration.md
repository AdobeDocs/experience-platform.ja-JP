---
title: Web SDK タグ拡張機能の設定
description: タグ UI でExperience Platform Web SDK タグ拡張機能を設定する方法について説明します。
exl-id: 22425daa-10bd-4f06-92de-dff9f48ef16e
source-git-commit: 1d1bb754769defd122faaa2160e06671bf02c974
workflow-type: tm+mt
source-wordcount: '1734'
ht-degree: 6%

---

# Web SDK 拡張機能の設定

この [!DNL Web SDK] タグ拡張機能は、web プロパティからExperience PlatformEdge Networkを介してAdobe Experience Cloudにデータを送信します。

拡張機能を使用すると、データを Platform にストリーミングし、ID を同期し、顧客同意シグナルを処理して、コンテキストデータを自動的に収集できます。

このドキュメントでは、タグ UI でタグ拡張機能を設定する方法について説明します。

## Web SDK タグ拡張機能のインストール {#install}

Web SDK タグ拡張機能には、プロパティをインストールする必要があります。 まだ行っていない場合は、のドキュメントを参照してください。 [タグプロパティの作成](https://experienceleague.adobe.com/docs/platform-learn/implement-in-websites/configure-tags/create-a-property.html?lang=ja).

プロパティを作成したら、プロパティを開き、 **[!UICONTROL 拡張機能]** 左側のバーの Tab キー。

「」を選択します **[!UICONTROL カタログ]** タブ。 使用可能な拡張機能のリストから、を見つけます [!DNL Web SDK] 拡張機能と選択 **[!UICONTROL インストール]**.

![Web SDK 拡張機能が選択されたタグ UI を示す画像](assets/web-sdk-install.png)

選択後 **[!UICONTROL インストール]**&#x200B;は、Web SDK タグ拡張機能を設定して、設定を保存する必要があります。

>[!NOTE]
>
>タグ拡張機能は、設定を保存した後にのみインストールされます。 タグ拡張機能の設定方法については、次の節を参照してください。

## インスタンス設定を指定 {#general}

ページ上部の設定オプションは、データのルーティング先と、サーバーで使用する設定をAdobe Experience Platformに指示します。

![タグ UI の Web SDK タグ拡張機能の一般設定を示す画像](assets/web-sdk-ext-general.png)

* **[!UICONTROL 名前]**:Adobe Experience Platform Web SDK 拡張機能は、ページ上の複数のインスタンスをサポートします。 この名前は、タグ設定を持つ複数の組織にデータを送信する場合に使用します。 インスタンス名のデフォルトはです。 `alloy`. ただし、インスタンス名を任意の有効な JavaScript オブジェクト名に変更できます。
* **[!UICONTROL IMS 組織 ID]**:Adobe時にデータを送信する組織の ID。 ほとんどの場合、自動入力されるデフォルト値を使用します。 ページ上に複数のインスタンスがある場合、データの送信先の 2 番目の組織の値をこのフィールドに入力します。
* **[!UICONTROL Edge ドメイン]**：拡張機能がデータを送受信するドメイン。 Adobeでは、この拡張機能にファーストパーティドメイン（CNAME）を使用することをお勧めします。 デフォルトのサードパーティドメインは開発環境で使用できますが、実稼動環境には適していません。ファーストパーティ CNAME の設定方法については、[ここ](https://experienceleague.adobe.com/docs/core-services/interface/ec-cookies/cookies-first-party.html?lang=ja)で説明します。

## データストリーム設定の指定 {#datastreams}

このセクションでは、使用可能な 3 つの環境（実稼働、ステージング、開発）のそれぞれに使用するデータストリームを選択できます。

リクエストがサーバーに送信されると、Edge Network側の設定を参照するために、データストリーム ID が使用されます。 Web サイト上でコードを変更することなく、設定を更新できます。

のガイドを参照してください [データストリーム](../../../../datastreams/overview.md) データストリームの設定方法については、を参照してください。

使用可能なドロップダウンメニューからデータストリームを選択するか、を選択できます。 **[!UICONTROL 値を入力]** また、各環境のカスタムデータストリーム ID を入力します。

![タグ UI の Web SDK タグ拡張機能のデータストリーム設定を示す画像](assets/web-sdk-ext-datastreams.png)

## プライバシー設定の指定 {#privacy}

この節では、Web SDK が web サイトからのユーザー同意シグナルをどのように処理するかを設定できます。 特に、他の明示的な同意環境設定が指定されていない場合にユーザーが想定されるデフォルトの同意レベルを選択できます。

デフォルトの同意レベルは、ユーザープロファイルに保存されません。

![タグ UI の Web SDK タグ拡張機能のプライバシー設定を示す画像](assets/web-sdk-ext-privacy.png)

| [!UICONTROL デフォルトの同意レベル] | 説明 |
| --- | --- |
| [!UICONTROL 対象：] | ユーザーが同意環境設定を指定する前に発生するイベントを収集します。 |
| [!UICONTROL Out] | ユーザーが同意環境設定を指定する前に発生するイベントを破棄します。 |
| [!UICONTROL 保留中] | ユーザーが同意環境設定を指定する前に発生するイベントをキューに追加します。 同意の環境設定が指定されると、指定された環境設定に応じてイベントが収集または破棄されます。 |
| [!UICONTROL データ要素によって提供] | デフォルトの同意レベルは、定義した別のデータ要素によって決まります。 このオプションを使用する場合は、提供されたドロップダウンメニューを使用してデータ要素を指定する必要があります。 |

>[!TIP]
>
>使用方法 **[!UICONTROL Out]** または **[!UICONTROL 保留中]** ビジネス運営に関して明示的なユーザー同意が必要な場合。

## ID 設定の指定 {#identity}

この節では、ユーザー識別の処理に関する Web SDK の動作を定義できます。

![タグ UI の Web SDK タグ拡張機能の ID 設定を示す画像](assets/web-sdk-ext-identity.png)

* **[!UICONTROL VisitorAPI からの ECID の移行]**：このオプションはデフォルトで有効になっています。 この機能が有効になっている場合、SDK は以下を読み取ることができます。 `AMCV` および `s_ecid` cookie と `AMCV` cookie の使用者 [!DNL Visitor.js]. この機能は、一部のページがまだ使用中の可能性があるので、Web SDK に移行する際に重要です [!DNL Visitor.js]. このオプションを使用すると、SDK で引き続き同じを使用できます [!DNL ECID] そのため、ユーザーが 2 人の異なるユーザーとして識別されることはありません。
* **[!UICONTROL サードパーティ Cookie の使用]**：このオプションを有効にすると、Web SDK はユーザー識別子をサードパーティ Cookie に保存しようとします。 成功した場合、ユーザーは、各ドメインで個別のユーザーとして識別されるのではなく、複数のドメインを移動する際に単一のユーザーとして識別されます。 このオプションが有効になっている場合、ブラウザーがサードパーティ cookie をサポートしていない場合や、ユーザーによってサードパーティ cookie を許可しないように設定されている場合には、SDK はサードパーティ cookie にユーザー識別子を保存できない可能性があります。 この場合、SDK はファーストパーティドメインにのみ識別子を保存します。

  >[!IMPORTANT]
  >>サードパーティ cookie は、と互換性がありません [ファーストパーティデバイス ID](../../../../web-sdk/identity/first-party-device-ids.md) web SDK の機能。
ファーストパーティデバイス ID またはサードパーティ Cookie のいずれかを使用できますが、両方の機能を同時に使用することはできません。
  >
## パーソナライゼーション設定の指定 {#personalization}

このセクションでは、パーソナライズされたコンテンツの読み込み中にページの特定の部分を非表示にする方法を設定できます。 これにより、訪問者にはパーソナライズされたページのみが表示されます。

![タグ UI の Web SDK タグ拡張機能のパーソナライゼーション設定を示す画像](assets/web-sdk-ext-personalization.png)

* **[!UICONTROL at.js から Web SDK への Target の移行]**：このオプションを使用して有効にします [!DNL Web SDK] レガシーの読み書きを行う `mbox` および `mboxEdgeCluster` at.js で使用される cookie `1.x` または `2.x` ライブラリ。 これにより、訪問者プロファイルを維持しながら、Web SDK を使用するページから at.js を使用するページに移行できます `1.x` または `2.x` ライブラリとその逆も同様です。

### スタイルの事前非表示 {#prehiding-style}

事前非表示のスタイルエディターでは、ページの特定のセクションを非表示にするカスタム CSS ルールを定義できます。 ページが読み込まれると、Web SDK はこのスタイルを使用して、パーソナライズの必要なセクションを非表示にし、パーソナライゼーションを取得した後、パーソナライズされたページセクションの非表示を解除します。 これにより、訪問者には、パーソナライゼーション取得プロセスが表示されずに、既にパーソナライズされたページが表示されます。

### 事前非表示のスニペット {#prehiding-snippet}

事前非表示スニペットは、Web SDK ライブラリが非同期で読み込まれる際に役立ちます。 この場合、ちらつきを避けるために、Web SDK ライブラリが読み込まれる前にコンテンツを非表示にすることをお勧めします。

事前非表示のスニペットを使用するには、内にコピー&amp;ペーストします `<head>` ページの要素。

>[!IMPORTANT]
>
事前非表示スニペットを使用する場合、Adobeでは同じスニペットを使用することをお勧めします [!DNL CSS] が使用するルール [スタイルの事前非表示](#prehiding-style).

## データ収集設定の指定 {#data-collection}

![タグ UI の Web SDK タグ拡張機能のデータ収集設定を示す画像](assets/web-sdk-ext-collection.png)

* **[!UICONTROL コールバック関数]**：拡張機能で提供されるコールバック関数は、次とも呼ばれます [`onBeforeEventSend` 関数](/help/web-sdk/commands/configure/onbeforeeventsend.md) ライブラリ内。 この関数を使用すると、イベントをEdge Networkに送信する前にグローバルに変更できます。
* **[!UICONTROL クリックデータ収集の有効化]**:Web SDK は、リンククリック情報を自動的に収集できます。 デフォルトでは、この機能は有効になっていますが、このオプションを使用して無効にすることができます。 にリストされているダウンロード式のいずれかが含まれている場合、リンクにはダウンロードリンクというラベルも付けられます。 [!UICONTROL リンク修飾子をダウンロード] テキストボックス。 Adobeには、デフォルトのダウンロードリンク修飾子がいくつか用意されています。 必要に応じて編集できます。
* **[!UICONTROL 自動的に収集されたコンテキストデータ]**：デフォルトでは、Web SDK はデバイス、Web、環境、場所のコンテキストに関する特定のコンテキストデータを収集します。 このデータを収集しない場合や、特定のカテゴリのデータのみを収集する場合は、 **[!UICONTROL 特定のコンテキスト情報]** そして、収集するデータを選択します。 参照： [`context`](/help/web-sdk/commands/configure/context.md) を参照してください。

## メディアコレクション設定の指定 {#media-collection}

メディア収集機能は、web サイト上のメディアセッションに関連するデータを収集するのに役立ちます。

収集されたデータには、メディアプレイバック、一時停止、完了およびその他の関連イベントに関する情報を含めることができます。 収集したら、このデータをAdobe Experience PlatformやAdobe Analyticsに送信して、レポートを生成できます。 この機能は、web サイトでのメディア消費行動を追跡および把握するための包括的なソリューションを提供します。

![タグ UI の Web SDK タグ拡張機能のメディアコレクション設定を示す画像](assets/media-collection.png)


* **[!UICONTROL チャネル]**：メディアコレクションが発生するチャネルの名前。 例：`Video channel`。
* **[!UICONTROL プレーヤー名]**：メディアプレーヤーの名前。
* **[!UICONTROL アプリケーション バージョン]**：メディアプレーヤーアプリケーションのバージョン。
* **[!UICONTROL メインの ping 間隔]**：メインコンテンツに対する ping の頻度（秒単位）。 デフォルト値は `10` です。値の範囲は次のとおりです `10` 対象： `50` 秒。  値を指定しない場合、を使用するとデフォルト値が使用されます。 [自動的に追跡されたセッション](../../../../web-sdk/commands/createmediasession.md#automatic).
* **[!UICONTROL 広告 ping 間隔]**：広告コンテンツに対する ping の頻度（秒）。 デフォルト値は `10` です。値の範囲は次のとおりです `1` 対象： `10` 秒。 値を指定しない場合、を使用するとデフォルト値が使用されます。 [自動的に追跡されたセッション](../../../../web-sdk/commands/createmediasession.md#automatic)

## データストリームの上書きの設定 {#datastream-overrides}

データストリームの上書きを使用すると、Web SDK を介して Edge Network に渡されるデータストリームの追加設定を定義できます。

これにより、新しいデータストリームを作成したり、既存の設定を変更したりすることなく、デフォルトとは異なるデータストリームの動作をトリガーできます。

データストリーム設定の上書きは、次の 2 つの手順で構成されます。

1. 最初に、[データストリーム設定ページ](/help/datastreams/configure.md)でデータストリーム設定の上書きを定義する必要があります。
2. 次に、Web SDK コマンドまたは Web SDK タグ拡張機能を使用して、上書きをEdge Networkに送信する必要があります。

データストリームを参照 [設定の上書きに関するドキュメント](/help/datastreams/overrides.md) データストリーム設定を上書きする方法の詳細な手順については、を参照してください。

Web SDK コマンドを使用して上書きを渡す代わりに、以下に示すタグ拡張機能画面で上書きを設定できます。

>[!IMPORTANT]
>
データストリームの上書きは、環境ごとに設定する必要があります。 開発環境、ステージング環境および実稼動環境では、すべて別々のオーバーライドが行われます。 次の画面に示す専用オプションを使用して、設定間でコピーできます。

![Web SDK タグ拡張機能ページを使用したデータストリーム設定の上書きを示す画像。](assets/datastream-overrides.png)

## 詳細設定を指定

の使用 **[!UICONTROL エッジのベースパス]** Edge Networkとのやり取りに使用するベースパスを変更する必要がある場合は、フィールドに入力します。 アップデートは必要ありませんが、ベータ版やアルファ版の場合は、Adobeからフィールドの変更を求められる場合があります。

![Web SDK タグ拡張機能ページを使用した詳細設定を示す画像。](assets/advanced-settings.png)
