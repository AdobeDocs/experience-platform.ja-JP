---
title: データ要素
description: データ要素は、データディクショナリ（またはデータマップ）の構築ブロックです。データ要素を使用して、マーケティングおよび広告テクノロジー全体でデータを収集、整理、配信します。
exl-id: 1e7b03cc-5a54-403d-bf8d-dbc206cfeb2d
source-git-commit: 0c2ee3bbb4d85bd755b4847a509fc7bd50ba67bc
workflow-type: tm+mt
source-wordcount: '1631'
ht-degree: 99%

---

# データ要素

>[!NOTE]
>
>Adobe Experience Platform Launch は、Adobe Experience Platform のデータ収集テクノロジースイートとしてリブランドされています。 その結果、製品ドキュメント全体でいくつかの用語の変更がロールアウトされました。 用語の変更点の一覧については、次の[ドキュメント](../../term-updates.md)を参照してください。

データ要素は、データディクショナリ（またはデータマップ）の構築ブロックです。データ要素を使用して、マーケティングおよび広告テクノロジー全体でデータを収集、整理、配信します。

単一のデータ要素は、クエリ文字列、URL、cookie 値、JavaScript 変数などに値をマッピングできる変数です。この値は、Adobe Experience Platform 全体で変数名によって参照できます。このデータ要素コレクションは、ルール（イベント、条件、アクション）の作成に使用する、定義済みデータの辞書になります。このデータ要素は、プロパティに追加した拡張機能で使用するため、タグ全体で共有されます。

>[!IMPORTANT]
>
> 変更は [公開](../publishing/overview.md) されるまでは反映されません。

ルールの作成時には、できるだけ一貫してデータ要素を使用し、値のベタ書きを避けると、動的データの定義を集約できてタグ付け作業の効率が上がります。一度定義したデータルールは複数の場所で使用できます。

データ要素の再利用の考え方は非常に効果的です。ベストプラクティスとして、この仕組みをできるだけ活用することをお勧めします。

例えば、ページ名や製品 ID を参照したり、アフィリエイトリンクのクエリ文字列パラメーターや [!DNL AdWords] から情報を取得するなど、決まった方法がある場合は、そのソースから情報を取得してデータディクショナリ（データ要素）を作成し、そのデータを様々なタグルール内で使用できます。

一例としてページ名の場合を考えてみましょう。Web サイトのデータレイヤー、`document.title` 要素、title タグを参照する手段として、ある特定のページ名スキーマを使用できるとすると、Adobe Experience Platform のタグを使用すると、その特定のデータポイントに対する単一の参照ポイントとしてデータ要素を作成できます。そのデータ要素は、ページ名の参照を必要とする任意のルール内で使用できます。将来、何らかの理由でページ面の参照方法を変更することになった場合（例：従来 `document.title` を参照していたものを、特定のデータレイヤーの参照に変更する場合）にも、多数の異なるルールを編集することなく参照の変更に対応できます。単にデータ要素内の参照を一度変更すれば、データ要素を参照するすべてのルールが自動的にアップデートされます。

>[!NOTE]
>
> データ要素がルールで参照されていない場合、カスタムスクリプトで特に呼び出さない限り、どのページにも読み込まれません。

データ要素内のデータは、ルールで使用されたときや、スクリプトから手動で呼び出されたときに設定されます。概要としては、次の手順を実行します。

1. [データ要素を作成します](#create-a-data-element)（まだ作成していない場合）。
1. [ルール](./rules.md)またはカスタムスクリプトでデータ要素を使用します。

## データ要素の使用方法

### ルールの場合：

検索ボックスを使用してデータ要素の名前を検索し、ルール編集インターフェイスでデータ要素を使用できます。

### カスタムスクリプトの場合：

`_satellite` オブジェクト構文を使用して、カスタムスクリプトでデータ要素を使用できます。

`_satellite.getVar('data element name');`

## データ要素の作成 {#create-a-data-element}

データ要素は、ルールの構成要素です。データ要素を使用すると、サイトに含まれる任意のオブジェクトについて、ページ上で共通的に使用されるアイテム（クエリ文字列、URL、Cookie 値など、任意の場所から得られたもの）のデータディクショナリ（またはデータマップ）を作成できます。

1. プロパティページで、「[!UICONTROL データ要素]」タブを開き、「**[!UICONTROL 新しいデータ要素を作成]**」を選択します。
1. データソースに名前をつけます。
1. 拡張機能とタイプを選択します。

   使用可能なデータ要素のタイプは、拡張機能によって決まります。コアタグ拡張機能で使用できるタイプについて詳しくは、[データ要素のタイプ](data-elements.md#types-of-data-elements)を参照してください。

1. 指定されたフィールドに、選択したタイプについて要求された情報を入力します。
1. （オプション）デフォルト値を入力します。

   このオプションを選択しない場合、デフォルト値はありません。  ほとんどのユーザーは、この設定をデフォルトの状態のままにします。  システムが異なると、空の変数の処理方法も異なります。「なし」や「該当なし」などの値を入力すると、データ要素が値を返さない場合にレポートの一貫性を保つことができます。

1. 小文字の値を強制するか、改行とスペースを削除するかを選択します。
1. 期間を選択します。

   次の選択肢があります。

   * なし
      * 値は保存されません。
   * Page view
      * ページが更新されるか新しいページが読み込まれるまで、値は JavaScript 変数に保持されます。
      * `_satellite` オブジェクト構文を使用して、スクリプトで作成および設定できます。

         `_satellite.setVar('data_element_name')`
   * Session
      * ブラウザーのタブが閉じられるまで、値はブラウザーのセッションストレージに保持されます。
      * そのサイト訪問の期間中、常に利用できます。
   * Visitor
      * この値は、ブラウザーのローカルストレージで無期限に保存されます。

1. 「**[!UICONTROL 保存]**」を選択します。

要素を作成または編集する際、[アクティブなライブラリ](../publishing/libraries.md#active-library)に保存および作成できます。これにより、変更は直ちにライブラリに保存され、ビルドが実行されます。ビルドのステータスが表示されます。また、[!UICONTROL アクティブなライブラリ]ドロップダウンから新しいライブラリを作成することもできます。

## データ要素のタイプ {#types-of-data-elements}

データ要素のタイプは、拡張機能によって決まります。タイプはいくつでも作成することができます。

以降の節では、Core 拡張機能で使用できるデータ要素のタイプについて説明します。その他の拡張機能は、他のタイプのデータ要素を使用します。

### Cookie

使用可能なドメイン cookie は、「cookie name」フィールドで参照できます。

#### 例：

`cookieName`

### カスタムコード

カスタム JavaScript を UI に入力するには、「[!UICONTROL エディターを開く]」を選択してエディターウィンドウにコードを挿入します。

データ要素の値として設定する値を示すために、エディターウィンドウで return ステートメントを記述する必要があります。return ステートメントが含まれていない場合、データ要素は `undefined` に解決されます。  これにより、格納された値の検索にフォールバックし、格納された値が存在しない場合は、デフォルト値になります。

**例：**

```text
var pageType = $('div.page-wrapper').attr('class').split('')[1];
if (window.location.pathname == '/') {
  return 'homepage';
} else {
  return pageType;
}
```

カスタムコードは、呼び出しルールから `event` オブジェクトを引数として受け取ることができます。 これにより、コードはそこで値を読み取ることができます。

**例：**

```text
// `event` is the default object provided by the rule
var eventType = event.$type;
return eventType; // if this data element is called from a "DOM Ready" event, then `core.dom-ready` is returned
```

`_satellite` オブジェクト構文を使うと、この値をカスタムスクリプトで使用できます。

```javascript
// event refers to the calling rule's event
var rule = _satellite.getVar('return event rule', event);
```

パーセント (`%`) 構文を使用する場合、データ要素名のみを指定する必要があります。 `event` を指定する必要はありません。

```text
%data element name%
```

### DOM 属性

div または H1 タグなど、任意の要素の値を取得できます。

#### 例：

CSS セレクターチェーン：

`id#dc logo img`

値を取得する要素：

`src`

### JavaScript 変数

使用可能な JavaScript オブジェクトまたは変数は、パスフィールドを使用して参照できます。

マークアップで JavaScript 変数またはオブジェクトプロパティを収集し、拡張機能やルールで使用する場合は、データ要素を使用してこれらの値をキャプチャできます。この方法を使用すると、ルール全体でデータ要素を参照でき、データのソースが変更された場合でも、データ収集 UI の 1 か所でソース（データ要素）への参照を変更するだけで済みます。

例えば、次のように、マークアップに「`Page_Name`」という JavaScript 変数が含まれているとします。

```markup
<script>
  //data layer
  var Page_Name = "Homepage"
</script>
```

データ要素を作成する際は、その変数へのパスを指定する必要があります。

データレイヤーでデータコレクターオブジェクトを使用している場合は、パスに、データ要素に取得するオブジェクトおよびプロパティを参照するドット表記を使用します（例：`_myData.pageName` や `digitalData.pageName`）。

#### 例：

`window.document.title`

### ローカルストレージ

「[!UICONTROL ローカルストレージアイテム名]」フィールドにローカルストレージアイテムの名前を入力します。

ローカルストレージを使用すると、ブラウザーはページからページへと情報を保存できます（[https://www.w3schools.com/html/html5_webstorage.asp](https://www.w3schools.com/html/html5_webstorage.asp)）。ローカルストレージは cookie のように機能しますが、cookie よりもはるかに大きく、柔軟性があります。

指定したフィールドを使用して、ローカルストレージ項目用に作成した値（例：`lastProductViewed.`）を指定します。

### ページ情報

これらのデータポイントを使用して、ルールロジックで使用するページ情報をキャプチャしたり、[!DNL Analytics] や外部トラッキングシステムに情報を送信したりできます。

次のいずれかのページ属性を選択してデータ要素で使用できます。

* URL
* Hostname
* Pathname
* Protocol
* リファラー
* Title

### Query String Parameter

単一の URL パラメーターを「[!UICONTROL URL パラメーター]」フィールドで指定します。

名前セクションのみが必要で、特殊な指定子（「?」や「=」など）は、省略する必要があります。

#### 例：

`contentType`

### 乱数

乱数を生成するには、このデータ要素を使用します。多くの場合、データのサンプリングや、ID の作成（ヒット ID など）に使用されます。乱数を使用して、機密データを難読化またはソルト化することもできます。例として次のようなものが挙げられます。

* ヒット ID の生成
* 数字をユーザートークンまあはタイムスタンプと連結して一意性を確保する
* PII データでの単方向ハッシュの実行
* サイトでサーベイリクエストをいつ表示するかをランダムに決定する

乱数の最小値と最大値を指定します。

**デフォルト：**

最小：0

最大：1000000000

### セッションストレージ

「[!UICONTROL セッションストレージアイテム名]」フィールドにセッションストレージ項目の名前を入力します。

セッションストレージは、ローカルストレージと似ていますが、セッションの終了後はデータが破棄されるという点が異なります。ローカルストレージや cookie はデータを保持することがあります。

### 訪問者行動

ページ情報と同様に、このデータ要素は共通の動作タイプを使用して、ルールや他の Platform ソリューション内のロジックを強化します。

次のいずれかの訪問者行動属性を選択します。

* Landing page
* Traffic source
* Minutes on site
* Session count
* Session page view count
* Lifetime page view count
* Is new visitor

一般的なユースケースには次のものが含まれます。

* 訪問者がサイトに 5 分間滞在した後にサーベイを表示する
* 訪問のランディングページの場合は、[!DNL Analytics] 指標を生成する
* 「Session Counts」の数が X に到達したら訪問者に新しいオファーを表示する
* 初めての訪問者にはニュースレターへの新規登録を表示する

## ビルトインデータ要素

過去に次のいずれかのデータ要素を使用したことがある場合は、データ収集 UI でカスタムデータ要素を作成する必要があります。

* URI
* プロトコル
* ホスト名
