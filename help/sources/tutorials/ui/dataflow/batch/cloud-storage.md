---
keywords: Experience Platform；ホーム；人気のあるトピック；データフロー；データフロー
solution: Experience Platform
title: UI でのクラウドストレージバッチコネクタのデータフローの設定
topic-legacy: overview
type: Tutorial
description: データフローは、ソースから Platform データセットにデータを取得して取り込むスケジュール済みタスクです。 このチュートリアルでは、クラウドストレージアカウントを使用して新しいデータフローを設定する手順を説明します。
exl-id: b327bbea-039d-4c04-afd3-f1d6a5f902a6
source-git-commit: e980ca69517d6e51ce00f102492829aabaa52976
workflow-type: tm+mt
source-wordcount: '2002'
ht-degree: 4%

---

# UI でのクラウドストレージバッチ接続のデータフローの設定

データフローとは、ソースから [!DNL Platform] データセットにデータを取得して取り込むスケジュールタスクです。 このチュートリアルでは、クラウドストレージアカウントを使用して新しいデータフローを設定する手順を説明します。

## はじめに

このチュートリアルは、Adobe Experience Platform の次のコンポーネントを実際に利用および理解しているユーザーを対象としています。

* [[!DNL Experience Data Model (XDM)] システム](../../../../../xdm/home.md):顧客体験データを整理する際に使用す [!DNL Experience Platform] る標準化されたフレームワーク。
   * [スキーマ構成の基本](../../../../../xdm/schema/composition.md)：スキーマ構成の主要な原則やベストプラクティスなど、XDM スキーマの基本的な構成要素について学びます。
   * [スキーマエディターのチュートリアル](../../../../../xdm/tutorials/create-schema-ui.md):スキーマエディターの UI を使用してカスタムスキーマを作成する方法を説明します。
* [[!DNL Real-time Customer Profile]](../../../../../profile/home.md)：複数のソースからの集計データに基づいて、統合されたリアルタイムの顧客プロファイルを提供します。

さらに、このチュートリアルでは、クラウドストレージアカウントを確立している必要があります。 UI で様々なクラウドストレージアカウントを作成するためのチュートリアルのリストは、[ ソースコネクタの概要 ](../../../../home.md) に記載されています。

### サポートされているファイル形式

[!DNL Experience Platform] は、次のファイル形式をサポートし、外部ストレージから取り込むことができます。

* 区切り文字区切り値 (DSV):任意の 1 文字の値を DSV 形式のデータ・ファイルの区切り文字として使用できます。
* [!DNL JavaScript Object Notation] (JSON):JSON 形式のデータファイルは XDM に準拠している必要があります。
* [!DNL Apache Parquet]:Parquet 形式のデータファイルは、XDM に準拠している必要があります。
* 圧縮ファイル：JSON および区切り文字付きファイルは、次のように圧縮できます。`bzip2`、`gzip`、`deflate`、`zipDeflate`、`tarGzip`、および `tar`。

## データの選択

クラウドストレージアカウントを作成した後、「**[!UICONTROL データを選択]**」手順が表示され、クラウドストレージファイル階層を調べるためのインターフェイスが表示されます。

* インターフェイスの左側には、クラウドストレージファイルとディレクトリを表示するディレクトリブラウザーが表示されます。
* インターフェイスの右側では、互換性のあるファイルから最大 100 行のデータをプレビューできます。

![インターフェイス](../../../../images/tutorials/dataflow/cloud-storage/batch/interface.png)

リストに表示されたフォルダーを選択すると、フォルダー階層を移動して、より深いフォルダーに移動できます。 1 つのフォルダーを選択して、そのフォルダー内のすべてのファイルを再帰的に取り込むことができます。 フォルダー全体を取り込む場合は、フォルダー内のすべてのファイルが同じスキーマを共有していることを確認する必要があります。

互換性のあるファイルまたはフォルダーを選択したら、「[!UICONTROL  データフォーマットを選択 ]」ドロップダウンメニューから、対応するデータフォーマットを選択します。

次の表に、サポートされているファイルタイプに適したデータ形式を示します。

| ファイルタイプ | データフォーマット |
| --- | --- |
| CSV | [!UICONTROL 区切り] |
| JSON | [!UICONTROL JSON] |
| Parquet | [!UICONTROL XDM Parquet] |

**[!UICONTROL JSON]** を選択し、プレビューインターフェイスが設定されるまで数秒待ちます。

![select-data](../../../../images/tutorials/dataflow/cloud-storage/batch/select-data.png)

>[!NOTE]
>
>区切り形式や JSON 形式のファイルとは異なり、Parquet 形式のファイルはプレビューできません。

プレビューインターフェイスを使用すると、ファイルの内容と構造を検査できます。 デフォルトでは、プレビューインターフェイスには、選択したフォルダー内の最初のファイルが表示されます。

別のファイルをプレビューするには、検査するファイルの名前の横にあるプレビューアイコンを選択します。

![default-preview](../../../../images/tutorials/dataflow/cloud-storage/batch/default-preview.png)

フォルダー内のファイルの内容と構造を調べたら、「**[!UICONTROL 次へ]**」を選択して、フォルダー内のすべてのファイルを再帰的に取り込みます。

![select-folder](../../../../images/tutorials/dataflow/cloud-storage/batch/select-folder.png)

特定のファイルを選択する場合は、取り込むファイルを選択し、「**[!UICONTROL 次へ]**」を選択します。

![select-file](../../../../images/tutorials/dataflow/cloud-storage/batch/select-file.png)

### 区切り文字ファイルのカスタム区切り文字の設定

区切り文字付きファイルを取り込む際に、カスタム区切り文字を設定できます。 「**[!UICONTROL 区切り文字]**」オプションを選択し、ドロップダウンメニューから区切り文字を選択します。 このメニューには、コンマ (`,`)、タブ (`\t`)、パイプ (`|`) など、区切り文字に最も頻繁に使用されるオプションが表示されます。 カスタムの区切り文字を使用する場合は、「**[!UICONTROL カスタム]**」を選択し、ポップアップ入力バーに任意の 1 文字の区切り文字を入力します。

データ形式を選択して区切り文字を設定したら、「**[!UICONTROL 次へ]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/delimiter.png)

### 圧縮ファイルの取り込み

圧縮タイプを指定することで、圧縮 JSON または区切り形式のファイルを取り込むことができます。

[!UICONTROL  データを選択 ] 手順で、取り込む圧縮ファイルを選択し、適切なファイルタイプと、XDM に準拠しているかどうかを選択します。 次に、「**[!UICONTROL 圧縮タイプ]**」を選択し、ソースデータに適した圧縮ファイルタイプを選択します。

圧縮ファイルタイプを特定したら、「**[!UICONTROL 次へ]**」を選択して次に進みます。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/compressed-files.png)

## データフィールドの XDM スキーマへのマッピング

**[!UICONTROL マッピング]** 手順が表示され、ソースデータを [!DNL Platform] データセットにマッピングするインタラクティブなインターフェイスが提供されます。 Parquet でフォーマットされたソースファイルは XDM に準拠している必要があり、手動でマッピングを設定する必要はありません。CSV ファイルでは、マッピングを明示的に設定する必要がありますが、マッピングするソースデータフィールドを選択できます。 JSON ファイルは、XDM に準拠しているとマークされている場合、手動での設定は必要ありません。 ただし、XDM 準拠としてマークされていない場合は、マッピングを明示的に設定する必要があります。

取り込む受信データのデータセットを選択します。 既存のデータセットを使用するか、新しく作成できます。

**既存のデータセットを使用する**

データを既存のデータセットに取り込むには、**[!UICONTROL 既存のデータセット]** を選択し、データセットのアイコンを選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/use-existing-data.png)

**[!UICONTROL データセットの選択]** ダイアログが表示されます。 使用するデータセットを見つけて選択し、「**[!UICONTROL 続行]**」をクリックします。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/select-existing-dataset.png)

**新しいデータセットの使用**

データを新しいデータセットに取り込むには、**[!UICONTROL New dataset]** を選択し、指定したフィールドにデータセットの名前と説明を入力します。 スキーマを追加するには、**[!UICONTROL スキーマを選択]** ダイアログボックスで既存のスキーマ名を入力します。 または、「**[!UICONTROL スキーマ詳細検索]**」を選択して、適切なスキーマを検索できます。

この手順の間に、[!DNL Real-time Customer Profile] のデータセットを有効にし、エンティティの属性と動作の全体像を作成できます。 有効なすべてのデータセットのデータは [!DNL Profile] に含まれ、変更はデータフローの保存時に適用されます。

「**[!UICONTROL プロファイルデータセット]**」ボタンを切り替えて、[!DNL Profile] のターゲットデータセットを有効にします。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/new-dataset.png)

**[!UICONTROL スキーマを選択]** ダイアログが表示されます。 新しいデータセットに適用するスキーマを選択し、「**[!UICONTROL 完了]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/select-schema.png)

必要に応じて、フィールドを直接マッピングするか、データ準備関数を使用してソース・データを変換し、計算済値または計算済値を取得できます。 マッパー関数と計算フィールドの詳細については、『[ データ準備関数ガイド ](../../../../../data-prep/functions.md)』または『[ 計算フィールドガイド ](../../../../../data-prep/calculated-fields.md)』を参照してください。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/mapping.png)

JSON ファイルの場合は、フィールドを他のフィールドに直接マッピングするだけでなく、オブジェクトを他のオブジェクトや配列に直接マッピングすることもできます。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/source-field-json.png)

![](../../../../images/tutorials/dataflow/cloud-storage/batch/target-field-json.png)

異なるタイプにまたがってマッピングすることはできません。 例えば、オブジェクトを配列やフィールドにマップすることはできません。

>[!TIP]
>
>Platform は、選択したターゲットスキーマまたはデータセットに基づいて、自動マッピングされたフィールドに対してインテリジェントな推奨事項を提供します。 マッピングルールは、使用例に合わせて手動で調整できます。

「**[!UICONTROL データのプレビュー]**」を選択すると、選択したデータセットから最大 100 行のサンプルデータのマッピング結果が表示されます。

プレビュー時、ID 列は最初のフィールドとして優先付けされます。マッピング結果を検証する際に必要な重要な情報です。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/mapping-preview.png)

ソースデータがマッピングされたら、「**[!UICONTROL 閉じる]**」を選択します。

## 取得の実行のスケジュール

**[!UICONTROL スケジュール]** 手順が表示され、設定済みのマッピングを使用して選択したソースデータを自動的に取り込むように取り込みスケジュールを設定できます。 次の表に、スケジュール設定用の様々な設定可能フィールドの概要を示します。

| フィールド | 説明 |
| --- | --- |
| 頻度 | 選択可能な周波数は、`Once`、`Minute`、`Hour`、`Day`、`Week` です。 |
| 間隔 | 選択した頻度の間隔を設定する整数。 |
| 開始時間 | 最初の取り込みがいつおこなわれるかを示す UTC タイムスタンプ。 |
| バックフィル | 最初に取り込まれるデータを決定する boolean 値です。 **[!UICONTROL バックフィル]** が有効になっている場合、指定されたパス内の現在のファイルは、最初にスケジュールされた取り込みの間にすべて取り込まれます。 **[!UICONTROL バックフィル]** が無効になっている場合は、最初の取り込み実行から開始時刻までの間に読み込まれたファイルのみが取り込まれます。 開始時刻より前に読み込まれたファイルは取り込まれません。 |

データフローは、スケジュールに従ってデータを自動的に取り込むように設計されています。 まず、取得頻度を選択します。 次に、2 つのフロー実行間隔を指定する間隔を設定します。 間隔の値はゼロ以外の整数で、15 以上に設定する必要があります。

取り込みの開始時間を設定するには、開始時間ボックスに表示される日時を調整します。 または、カレンダーアイコンを選択して開始時間の値を編集できます。 開始時刻は、現在の時刻 (UTC) 以上にする必要があります。

スケジュールの値を指定し、「**[!UICONTROL 次へ]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/scheduling-interval-on.png)

### 1 回限りの取得データフローの設定

1 回限りの取り込みを設定するには、頻度ドロップダウン矢印を選択し、「**[!UICONTROL 1 回]**」を選択します。 開始時間が将来になる限り、1 回限りの頻度取り込み用にデータフローセットを引き続き編集できます。 開始時間が過ぎると、1 回限りの頻度の値は編集できなくなります。 **** 1 回限りの **** 取得データフローの設定時に、間隔およびバックフィルが表示されない。

>[!IMPORTANT]
>
>[FTP コネクタ ](../../../../connectors/cloud-storage/ftp.md) を使用する場合は、1 回限りの取り込みでデータフローをスケジュールすることを強くお勧めします。

スケジュールに適切な値を指定したら、「**[!UICONTROL 次へ]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/scheduling-once.png)

## データフローの詳細の入力

**[!UICONTROL データフローの詳細]** 手順が表示され、新しいデータフローに名前を付け、簡単な説明を入力できます。

このプロセスの間に、**[!UICONTROL 部分取得]** と **[!UICONTROL エラー診断]** を有効にすることもできます。 **[!UICONTROL 部分取得]** を有効にすると、エラーを含むデータを、設定可能なしきい値まで取り込むことができます。 **[!UICONTROL エラー診断]** を有効にすると、別々にバッチ処理される誤ったデータの詳細が表示されます。 詳しくは、「[ バッチ取得の部分の概要 ](../../../../../ingestion/batch-ingestion/partial.md)」を参照してください。

データフローの値を指定し、「**[!UICONTROL 次へ]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/dataflow-detail.png)

## データフローの確認

「**[!UICONTROL レビュー]**」手順が表示され、新しいデータフローを作成前に確認できます。 詳細は、次のカテゴリに分類されます。

* **[!UICONTROL 接続]**:ソースの種類、選択したソースファイルの関連パス、およびそのソースファイル内の列数を表示します。
* **[!UICONTROL データセットとマップのフィールドの割り当て]**:データセットが準拠するスキーマなど、ソースデータの取り込み先のデータセットを示します。
* **[!UICONTROL スケジュール]**:取り込みスケジュールのアクティブな期間、頻度、間隔を示します。

データフローをレビューしたら、「**[!UICONTROL 完了]**」をクリックし、データフローの作成に時間を割きます。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/review.png)

## データフローの監視

データフローを作成したら、データフローを介して取り込まれるデータを監視して、取り込み率、成功、エラーに関する情報を確認できます。 データフローの監視方法の詳細については、UI での [ アカウントとデータフローの監視に関するチュートリアル ](../../monitor.md) を参照してください。

## データフローの削除

不要になったデータフローや誤って作成されたデータフローは、**[!UICONTROL Dataflows]** ワークスペースの **[!UICONTROL Delete]** 関数を使用して削除できます。 データフローの削除方法の詳細については、[UI でのデータフローの削除 ](../../delete.md) に関するチュートリアルを参照してください。

## 次の手順

このチュートリアルに従うと、データフローを作成して外部クラウドストレージからデータを取り込み、データセットの監視に関するインサイトを得ることができます。 データフローの作成の詳細については、以下のビデオを見て学習を補完できます。 さらに、受信データは、[!DNL Real-time Customer Profile] や [!DNL Data Science Workspace] など、ダウンストリームの [!DNL Platform] サービスで使用できるようになりました。 詳しくは、次のドキュメントを参照してください。

* [[!DNL Real-time Customer Profile] の概要](../../../../../profile/home.md)
* [[!DNL Data Science Workspace] の概要](../../../../../data-science-workspace/home.md)

>[!WARNING]
>
> 次のビデオに示す [!DNL Platform] UI は古くなっています。最新の UI スクリーンショットと機能については、上記のドキュメントを参照してください。

>[!VIDEO](https://video.tv.adobe.com/v/29695?quality=12&learn=on)

## 付録

次の節では、ソースコネクタの操作に関する追加情報を示します。

### データフローの無効化

データフローを作成すると、すぐにアクティブになり、指定されたスケジュールに従ってデータが取り込まれます。 次の手順に従うことで、アクティブなデータフローをいつでも無効にできます。

**[!UICONTROL ソース]** ワークスペース内で、「**[!UICONTROL 参照]**」タブをクリックします。 次に、無効にするアクティブなデータフローに関連付けられているアカウントの名前をクリックします。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/browse.png)

**[!UICONTROL ソースアクティビティ]** ページが表示されます。 リストからアクティブなデータフローを選択し、画面の右側に「**[!UICONTROL Properties]**」列を開きます。この列には、「**[!UICONTROL Enabled]**」切り替えボタンが含まれています。 切り替えボタンをクリックして、データフローを無効にします。 同じ切り替えを使用して、データフローを無効にした後で再度有効にできます。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/disable-source.png)

### [!DNL Profile] 母集団の受信データをアクティブ化

ソースコネクタからの受信データは、[!DNL Real-time Customer Profile] データのエンリッチメントと入力に使用できます。 [!DNL Real-time Customer Profile] データの入力について詳しくは、[ プロファイルの母集団 ](../../profile.md) に関するチュートリアルを参照してください。
