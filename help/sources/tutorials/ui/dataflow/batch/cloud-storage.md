---
keywords: Experience Platform；ホーム；人気のあるトピック；データフロー；データフロー
solution: Experience Platform
title: UIでのクラウドストレージバッチコネクタのデータフローの設定
topic: overview
type: Tutorial
description: データフローとは、ソースからプラットフォームデータセットにデータを取得し、取り込むスケジュール設定されたタスクです。 このチュートリアルでは、クラウドストレージアカウントを使用して新しいデータフローを設定する手順を説明します。
translation-type: tm+mt
source-git-commit: 1fb4a272a914bf4ce7653f3f4f7fff63f36f9a48
workflow-type: tm+mt
source-wordcount: '1924'
ht-degree: 3%

---


# UIでのクラウドストレージバッチ接続のデータフローの設定

データフローとは、ソースからデータセット[!DNL Platform]にデータを取得し、取り込むスケジュール済みのタスクです。 このチュートリアルでは、クラウドストレージアカウントを使用して新しいデータフローを設定する手順を説明します。

## はじめに

このチュートリアルは、Adobe Experience Platform の次のコンポーネントを実際に利用および理解しているユーザーを対象としています。

* [[!DNL Experience Data Model (XDM)] システム](../../../../../xdm/home.md):顧客体験データを [!DNL Experience Platform] 編成する際に使用される標準化されたフレームワーク。
   * [スキーマ構成の基本](../../../../../xdm/schema/composition.md)：スキーマ構成の主要な原則やベストプラクティスなど、XDM スキーマの基本的な構成要素について学びます。
   * [スキーマエディタのチュートリアル](../../../../../xdm/tutorials/create-schema-ui.md):スキーマエディターのUIを使用してカスタムスキーマを作成する方法を説明します。
* [[!DNL Real-time Customer Profile]](../../../../../profile/home.md):複数のソースからの集計データに基づいて、統合されたリアルタイムの消費者プロファイルを提供します。

さらに、このチュートリアルでは、クラウドストレージアカウントを確立している必要があります。 UIで異なるクラウドストレージアカウントを作成するためのチュートリアルのリストは、[source connectors overview](../../../../home.md)にあります。

### サポートされているファイル形式

[!DNL Experience Platform] は、外部ストレージから取り込む次のファイル形式をサポートしています。

* 区切り文字区切り値(DSV):DSV形式のデータ・ファイルの区切り文字としては、任意の1文字の値を使用できます。
* [!DNL JavaScript Object Notation] (JSON):JSON形式のデータファイルは、XDMに準拠している必要があります。
* [!DNL Apache Parquet]:パーケット形式のデータファイルは、XDMに準拠している必要があります。

## データの選択

クラウドストレージアカウントを作成すると、**[!UICONTROL データを選択]**&#x200B;の手順が表示され、クラウドストレージファイル階層を調べるためのインターフェイスが提供されます。

* インターフェイスの左側はディレクトリブラウザーで、クラウドストレージのファイルとディレクトリが表示されます。
* インターフェイスの右側には、互換性のあるファイルから最大100行のデータをプレビューできます。

![インターフェイス](../../../../images/tutorials/dataflow/cloud-storage/batch/interface.png)

リストに表示されているフォルダーを選択すると、フォルダー階層を深いフォルダーに移動できます。 単一のフォルダを選択すると、そのフォルダ内のすべてのファイルを再帰的に取り込むことができます。 フォルダー全体を取り込む場合は、フォルダー内のすべてのファイルが同じスキーマーを共有していることを確認する必要があります。

互換性のあるファイルまたはフォルダーを選択したら、「[!UICONTROL データ形式を選択]」ドロップダウンメニューから、対応するデータ形式を選択します。

次の表に、サポートされるファイルタイプに適したデータ形式を示します。

| ファイルタイプ | データフォーマット |
| --- | --- |
| CSV | [!UICONTROL 区切り] |
| JSON | [!UICONTROL JSON] |
| パーケ | [!UICONTROL XDMパーケ] |

「**[!UICONTROL JSON]**」を選択し、プレビューインターフェイスが設定されるまで数秒待ちます。

![select-data](../../../../images/tutorials/dataflow/cloud-storage/batch/select-data.png)

>[!NOTE]
>
>区切り文字やJSONファイルタイプとは異なり、Parket形式のファイルはプレビューできません。

プレビューインターフェイスを使用すると、ファイルの内容と構造を検査できます。 デフォルトでは、プレビューインターフェイスには、選択したフォルダ内の最初のファイルが表示されます。

別のファイルをプレビューするには、検査するファイル名の横にあるプレビューアイコンを選択します。

![default-プレビュー](../../../../images/tutorials/dataflow/cloud-storage/batch/default-preview.png)

フォルダー内のファイルの内容と構造を調べたら、「**[!UICONTROL 次へ]**」を選択して、フォルダー内のすべてのファイルを再帰的に取り込みます。

![select-folder](../../../../images/tutorials/dataflow/cloud-storage/batch/select-folder.png)

特定のファイルを選択する場合は、取り込むファイルを選択し、**[!UICONTROL 次へ]**&#x200B;を選択します。

![select-file](../../../../images/tutorials/dataflow/cloud-storage/batch/select-file.png)

### 区切り文字ファイルのカスタム区切り文字の設定

区切りファイルを取り込む際に、カスタムの区切り文字を設定できます。 「**[!UICONTROL 区切り文字]**」オプションを選択し、ドロップダウンメニューから区切り文字を選択します。 このメニューには、カンマ(`,`)、タブ(`\t`)、パイプ(`|`)など、区切り文字に最も頻繁に使用されるオプションが表示されます。 カスタムの区切り文字を使用する場合は、「**[!UICONTROL カスタム]**」を選択し、ポップアップ入力バーに任意の1文字の区切り文字を入力します。

データ形式を選択し、区切り文字を設定したら、「**[!UICONTROL 次へ]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/delimiter.png)

## データフィールドのXDMスキーマへのマッピング

**[!UICONTROL マッピング]**&#x200B;の手順が表示され、ソースデータを[!DNL Platform]データセットにマッピングするためのインタラクティブなインターフェイスが提供されます。 Parketで書式設定されるソースファイルはXDMに準拠しており、手動でマッピングを設定する必要はありません。一方、CSVファイルでは、マッピングを明示的に設定する必要はありますが、マッピングするソースデータフィールドを選択できます。 JSONファイルは、XDM準拠としてマークされている場合、手動設定は必要ありません。 ただし、XDM準拠とマークされていない場合は、マッピングを明示的に設定する必要があります。

取り込む受信データのデータセットを選択します。 既存のデータセットを使用することも、新しいデータセットを作成することもできます。

**既存のデータセットを使用する**

既存のデータセットにデータを取り込むには、**[!UICONTROL 既存のデータセット]**&#x200B;を選択し、データセットアイコンを選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/use-existing-data.png)

**[!UICONTROL データセットを選択]**&#x200B;ダイアログが表示されます。 使用するデータセットを見つけて選択し、**[!UICONTROL 続行]**&#x200B;をクリックします。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/select-existing-dataset.png)

**新しいデータセットの使用**

データを新しいデータセットに取り込むには、**[!UICONTROL 新しいデータセット]**&#x200B;を選択し、提供されたフィールドにデータセットの名前と説明を入力します。 スキーマを追加するには、**[!UICONTROL スキーマを選択]**&#x200B;ダイアログボックスで既存のスキーマ名を入力します。 または、**[!UICONTROL スキーマのアドバンス検索]**&#x200B;を選択して、適切なスキーマを検索することもできます。

この手順では、[!DNL Real-time Customer Profile]のデータセットを有効にし、エンティティの属性と動作の全体的な表示を作成できます。 すべての有効なデータセットのデータは[!DNL Profile]に含まれ、変更はデータフローの保存時に適用されます。

**[!UICONTROL プロファイルデータセット]**&#x200B;ボタンを切り替えて、[!DNL Profile]のターゲットデータセットを有効にします。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/new-dataset.png)

**[!UICONTROL スキーマを選択]**&#x200B;ダイアログが表示されます。 新しいデータセットに適用するスキーマを選択し、**[!UICONTROL 完了]**&#x200B;を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/select-schema.png)

必要に応じて、フィールドを直接マップするか、マッパー関数を使用してソースデータを変換し、計算値や計算値を抽出することができます。 データマッピングとマッパー関数の詳細については、[CSVデータのXDMスキーマフィールドへのマッピング](../../../../../ingestion/tutorials/map-a-csv-file.md)のチュートリアルを参照してください。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/mapping.png)

JSONファイルの場合は、フィールドを他のフィールドに直接マッピングするだけでなく、オブジェクトを他のオブジェクトや配列に直接他の配列にマッピングすることもできます。また、クラウドストレージソースコネクタを使用して、JSONファイル内の配列などの複雑なデータ型をプレビューおよびマッピングできます。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/source-field-json.png)

![](../../../../images/tutorials/dataflow/cloud-storage/batch/target-field-json.png)

異なるタイプ間でマップすることはできません。 例えば、オブジェクトを配列にマップしたり、フィールドをオブジェクトにマップしたりすることはできません。

>[!TIP]
>
>[!DNL Platform] 選択したターゲットスキーマまたはデータセットに基づいて、自動マップされたフィールドに高度な推奨機能を提供します。使用事例に合わせて手動でマッピングルールを調整できます。

**[!UICONTROL プレビューデータ]**&#x200B;を選択すると、選択したデータセットから最大100行のサンプルデータのマッピング結果を確認できます。

マッピング結果を検証する際に必要な重要な情報なので、プレビュー時に、ID列が最初のフィールドとして優先付けされます。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/mapping-preview.png)

ソースデータがマッピングされたら、「**[!UICONTROL 閉じる]**」を選択します。

## インジェストのスケジュール設定

**[!UICONTROL スケジュール]**&#x200B;の手順が表示され、設定されたマッピングを使用して選択したソースデータを自動的に取り込むように取り込みスケジュールを設定できます。 次の表に、スケジュール設定用の様々な設定可能フィールドの概要を示します。

| フィールド | 説明 |
| --- | --- |
| 頻度 | 選択可能な周波数には、`Once`、`Minute`、`Hour`、`Day`、`Week`があります。 |
| 間隔 | 選択した頻度の間隔を設定する整数。 |
| 開始時間 | 最初の取り込みがいつ行われるかを示すUTCタイムスタンプ。 |
| 埋め戻し | 最初に取り込まれるデータを決定するboolean値です。 **[!UICONTROL バックフィル]**&#x200B;が有効な場合、指定されたパス内の現在のファイルは、最初にスケジュールされた取り込み中にすべて取り込まれます。 **[!UICONTROL バックフィル]**&#x200B;が無効な場合は、最初のインジェスト実行から開始時間の間にロードされたファイルのみが取り込まれます。 開始時間より前に読み込まれたファイルは取り込まれません。 |

データフローは、スケジュールに基づいてデータを自動的に取り込むように設計されています。 開始するには、取り込み頻度を選択します。 次に、2つのフローの実行間隔を指定する間隔を設定します。 間隔の値は、0以外の整数で、15以上に設定する必要があります。

取り込みの開始時間を設定するには、開始時間ボックスに表示される日時を調整します。 または、カレンダーアイコンを選択して、開始時間の値を編集することもできます。 開始時刻は、現在の時刻(UTC)以上である必要があります。

スケジュールの値を指定し、「**[!UICONTROL 次へ]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/scheduling-interval-on.png)

### 1回のみの取り込みデータフローの設定

1回のみのインジェストを設定するには、頻度ドロップダウン矢印を選択し、「**[!UICONTROL 1回]**」を選択します。 1回限りの頻度で取り込むためのデータフローセットに対する編集は、開始時間が将来的に残る限り継続して行うことができます。 開始時間が経過すると、1回限りの頻度の値は編集できなくなります。 **[!UICONTROL 1回限り]** の取り込みデータフローを設定すると、Intervaland  **** Backfillが表示されない。

>[!IMPORTANT]
>
>[FTPコネクタ](../../../../connectors/cloud-storage/ftp.md)を使用する場合は、1回の取り込みでデータフローをスケジュールすることを強くお勧めします。

スケジュールに適切な値を指定したら、「**[!UICONTROL 次へ]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/scheduling-once.png)

## データフローの詳細の指定

**[!UICONTROL Dataflow detail]**&#x200B;ステップが表示され、新しいデータフローに名前を付け、簡単な説明を入力できます。

このプロセス中に、**[!UICONTROL 部分的な取り込み]**&#x200B;と&#x200B;**[!UICONTROL エラー診断]**&#x200B;を有効にすることもできます。 **[!UICONTROL 部分的な取り込み]**&#x200B;を有効にすると、エラーを含むデータを取り込むことができ、設定可能なしきい値まで保持できます。 **[!UICONTROL エラー診断]**&#x200B;を有効にすると、個別にバッチ処理される誤ったデータの詳細が表示されます。 詳しくは、[部分的なバッチインジェストの概要](../../../../../ingestion/batch-ingestion/partial.md)を参照してください。

データフローの値を指定し、「**[!UICONTROL 次へ]**」を選択します。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/dataflow-detail.png)

## データフローの確認

「**[!UICONTROL レビュー]**」ステップが表示され、新しいデータフローを作成前に確認できます。 詳細は次のカテゴリに分類されます。

* **[!UICONTROL 接続]**:ソースの種類、選択したソースファイルの関連パス、およびそのソースファイル内の列数が表示されます。
* **[!UICONTROL データセットとマップのフィールドの割り当て]**:ソースデータが取り込まれるデータセット(データセットに従うスキーマなど)を示します。
* **[!UICONTROL スケジュール]**:取り込みスケジュールの有効期間、頻度、間隔を表示します。

データフローを確認したら、**[!UICONTROL 「Finish]**」をクリックし、データフローの作成に時間を割り当てます。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/review.png)

## データフローの監視

データフローを作成したら、データフローを介して取り込まれるデータを監視し、取り込み率、成功、エラーに関する情報を確認できます。 データフローの監視方法の詳細については、UI](../../monitor.md)の[監視アカウントとデータフローのチュートリアルを参照してください。

## データフローの削除

不要になった、または不適切に作成されたデータフローは、**[!UICONTROL Dataflows]**&#x200B;ワークスペースにある&#x200B;**[!UICONTROL Delete]**&#x200B;関数を使用して削除できます。 データフローの削除方法の詳細については、UI](../../delete.md)での[データフローの削除に関するチュートリアルを参照してください。

## 次の手順

このチュートリアルに従うと、外部のクラウドストレージからデータを取り込むためのデータフローが正しく作成され、データセットの監視に関する洞察が得られます。 データフローの作成について詳しくは、以下のビデオを参照して学習を補うことができます。 さらに、受信データは、[!DNL Real-time Customer Profile]や[!DNL Data Science Workspace]などの下流の[!DNL Platform]サービスで使用できるようになりました。 詳しくは、次のドキュメントを参照してください。

* [[!DNL Real-time Customer Profile] 概要](../../../../../profile/home.md)
* [[!DNL Data Science Workspace] 概要](../../../../../data-science-workspace/home.md)

>[!WARNING]
>
> 次のビデオに示す[!DNL Platform] UIは古いです。 最新のUIのスクリーンショットと機能については、上記のドキュメントを参照してください。

>[!VIDEO](https://video.tv.adobe.com/v/29695?quality=12&learn=on)

## 付録

以下の節では、ソースコネクタを使用する場合の追加情報について説明します。

### データフローの無効化

データフローが作成されると、そのデータはすぐにアクティブになり、指定されたスケジュールに従ってデータを取り込みます。 アクティブなデータフローは、次の手順に従っていつでも無効にできます。

**[!UICONTROL ソース]**&#x200B;ワークスペース内で、**[!UICONTROL 「参照]**」タブをクリックします。 次に、無効にするアクティブなデータフローに関連付けられているアカウントの名前をクリックします。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/browse.png)

**[!UICONTROL ソースアクティビティ]**&#x200B;ページが表示されます。 リストからアクティブなデータフローを選択し、画面の右側に&#x200B;**[!UICONTROL Properties]**&#x200B;列を開きます。この列には&#x200B;**[!UICONTROL Enabled]**&#x200B;トグルボタンが含まれています。 切り替えボタンをクリックして、データフローを無効にします。 同じ切り替えを使用して、データフローを無効にした後で再び有効にできます。

![](../../../../images/tutorials/dataflow/cloud-storage/batch/disable-source.png)

### [!DNL Profile]母集団の受信データをアクティブ化

ソースコネクタからの受信データは、[!DNL Real-time Customer Profile]データを豊かにし、埋め込むために使用できます。 [!DNL Real-time Customer Profile]データの入力について詳しくは、[プロファイルの母集団](../../profile.md)のチュートリアルを参照してください。
