---
title: 名前空間の優先度
description: ID サービスでの名前空間の優先度について説明します。
exl-id: bb04f02e-3826-45af-b935-752ea7e6ed7c
source-git-commit: bb90bbddf33bc4b0557026a0f34965ac37475c65
workflow-type: tm+mt
source-wordcount: '2119'
ht-degree: 3%

---

# 名前空間の優先度 {#namespace-priority}

>[!CONTEXTUALHELP]
>id="platform_identities_namespacepriority"
>title="名前空間の優先度"
>abstract="名前空間の優先度によって、ID グラフからリンクを削除する方法が決定します。"

顧客の実装はすべて、特定の組織の目標を満たすようにカスタマイズされて一意です。そのため、特定の名前空間の重要性は、顧客によって異なります。 実際の例を次に示します。

* 会社では、各メールアドレスを 1 人のエンティティを表すものと見なして、メール名前空間を一意として設定するために [ID 設定 ](./identity-settings-ui.md) を使用する場合があります。 ただし、別の会社が、1 人のエンティティを複数のメールアドレスを持つものとして表し、メール名前空間を一意ではないように設定する場合があります。 これらの会社では、CRMID 名前空間などの一意な別の ID 名前空間を使用して、複数のメールアドレスにリンクされた単一のユーザー ID を使用できるようにする必要があります。
* 「ログイン ID」名前空間を使用して、オンライン動作を収集できます。 このログイン ID は、CRMID と 1:1 の関係がある可能性があります。CRMID は、CRM システムから属性を保存し、最も重要な名前空間と見なされることがあります。 この場合、CRMID 名前空間は人物をより正確に表すものであり、ログイン ID 名前空間は 2 番目に重要なものであると判断します。

名前空間の重要性を反映した設定を ID サービスで行う必要があります。これは、プロファイルとそれに関連する ID グラフの形成および分割方法に影響を与えます。

## 優先度の決定

名前空間の優先度の決定は、次の要因に基づいて行います。

### ID グラフ構造

組織のグラフ構造がレイヤー化されている場合、グラフが折りたたまれた場合に正しいリンクが削除されるように、名前空間の優先度にこの特性を反映する必要があります。

>[!TIP]
>
>* 「グラフの折りたたみ」とは、複数の異なるプロファイルが誤って 1 つの ID グラフに結合されるシナリオを指します。
>
>* レイヤー化されたグラフとは、複数レベルのリンクを持つ ID グラフを指します。 3 つのレイヤーを持つグラフの例については、以下の画像を参照してください。

![ グラフレイヤーの図 ](../images/namespace-priority/graph-layers.png " グラフレイヤーの図 "){zoomable="yes"}

### 名前空間の意味論的意味

ID は、実際のオブジェクトを表します。 ID グラフには 3 つのオブジェクトが表示されます。 次に、重要度の高い順に示します。

* 人物（クロスデバイス、メール、電話番号）
* ハードウェア デバイス
* Web ブラウザー（Cookie）

人物名前空間は、ハードウェアデバイス（IDFA、GAID など）に比べて比較的不変で、web ブラウザーに比べて比較的不変です。 基本的に、ユーザーは常に 1 人のエンティティであり、複数のハードウェアデバイス（スマートフォン、ノートパソコン、タブレットなど）を持ち、複数のブラウザー（Google Chrome、Safari、FireFox など）を使用できます。

このトピックにアプローチするもう 1 つの方法は、カーディナリティを使用することです。 特定のユーザーエンティティに対して、いくつの ID が作成されますか？ ほとんどの場合、ユーザーは 1 つの CRMID、いくつかのハードウェアデバイス識別子（IDFA/GAID のリセットは頻繁には発生しません）、さらにはさらに Cookie （個人が複数のデバイスを閲覧したり、匿名モードを使用したり、いつでも Cookie をリセットしたりする可能性があります）を持ちます。 一般に、**カーディナリティが低い方が、優先度が高い名前空間を示します**。

## 名前空間の優先度設定の検証

名前空間にどのように優先順位を付けるかを把握したら、UI のグラフシミュレーションツールを使用して、様々なグラフ折りたたみシナリオをテストし、優先設定が期待どおりのグラフ結果を返していることを確認します。 詳しくは、[ グラフシミュレーションツール ](./graph-simulation.md) の使用に関するガイドを参照してください。

## 名前空間の優先度の設定

名前空間の優先度は、[ID 設定 UI](./identity-settings-ui.md) を使用して設定できます。 ID 設定インターフェイスでは、名前空間をドラッグ&amp;ドロップして、その相対的な重要度を決定できます。

>[!IMPORTANT]
>
>デバイス/cookie 名前空間をユーザー名前空間よりも優先することはできません。 この制限により、設定ミスが発生しないことが保証されます。

## 名前空間の優先度の使用

現在、名前空間の優先度は、リアルタイム顧客プロファイルのシステム動作に影響を与えています。 次の図は、この概念を示しています。 詳細については、[Adobe Experience Platformおよびアプリケーション アーキテクチャ図 ](https://experienceleague.adobe.com/en/docs/blueprints-learn/architecture/architecture-overview/platform-applications) に関するガイドを参照してください。

![ 名前空間の優先度のアプリケーションスコープを示す図。](../images/namespace-priority/application-scope.png " 名前空間優先アプリケーション スコープの図。"){zoomable="yes"}

## ID サービス：ID 最適化アルゴリズム

比較的複雑なグラフ構造の場合、グラフの折りたたみシナリオが発生したときに正しいリンクが削除されるようにするために、名前空間の優先度は重要な役割を果たします。 詳しくは、[ID 最適化アルゴリズムの概要 ](../identity-graph-linking-rules/identity-optimization-algorithm.md) を参照してください。

## リアルタイム顧客プロファイル：エクスペリエンスイベントのプライマリ ID 決定

* 特定のサンドボックスの ID 設定を指定したら、エクスペリエンスイベントのプライマリ ID は、設定で最も高い名前空間の優先度によって決定されます。
   * これは、エクスペリエンスイベントが本質的に動的であるためです。 ID マップには 3 つ以上の ID を含めることができ、名前空間の優先度により、最も重要な名前空間がエクスペリエンスイベントに関連付けられます。
* その結果、次の設定 **リアルタイム顧客プロファイルでは使用されなくなります**。
   * Web SDK、Mobile SDK、Edge Network API を使用して `primary=true` で ID を送信する場合のプライマリ ID 設定（`identityMap`）（ID 名前空間と ID 値は、引き続きプロファイルで使用されます）。 **メモ**：データレイクストレージやAdobe Targetなど、リアルタイム顧客プロファイル以外のサービスでは、引き続きプライマリ ID 設定（`primary=true`）を使用します。
   * XDM エクスペリエンスイベントクラススキーマでプライマリ ID としてマークされたすべてのフィールド。
   * Adobe Analytics ソースコネクタのデフォルトのプライマリ ID 設定（ECID または AAID）。
* 一方、**名前空間の優先度は、プロファイルレコードのプライマリ ID を決定しません**。
   * プロファイルレコードの場合、プライマリ ID を含め、スキーマの ID フィールドを引き続き定義する必要があります。 詳しくは、[UI での ID フィールドの定義 ](/help/xdm/ui/fields/identity.md) に関するガイドを参照してください。

>[!TIP]
>
>* 名前空間の優先度は **名前空間のプロパティ** です。 これは、名前空間の相対的な重要度を示すために名前空間に割り当てられた数値です。
>
>* プライマリ ID は、プロファイルフラグメントが保存される ID です。 プロファイルフラグメントは、属性（CRM レコードなど）やイベント（web サイトの閲覧など）などの、特定のユーザーに関する情報を格納するデータのレコードです。

### サンプルシナリオ

この節では、優先度設定がデータに与える影響の例を示します。

特定のサンドボックスに対して、次の設定が確立されているとします。

| 名前空間 | 名前空間の実際のアプリケーション | 優先度 |
| --- | --- | --- |
| CRMID | ユーザー | 1 |
| IDFA | Apple ハードウェアデバイス（iPhone、IPadなど） | 2 |
| GAID | Google ハードウェアデバイス（Google Pixel、Pixelbook など） | 3 |
| ECID | Web ブラウザー（Firefox、Safari、Google Chromeなど） | 4 |
| AAID | Web ブラウザー | 5 |

{style="table-layout:auto"}

上記の設定に基づいて、ユーザーのアクションとプライマリ ID の決定は、次のように解決されます。

| ユーザーアクション（エクスペリエンスイベント） | 認証状態 | データソース | イベントの名前空間 | プライマリ ID の名前空間 |
| --- | --- | --- | --- | --- |
| クレジット カード オファーページの表示 | 未認証（匿名） | Web SDK | `{ECID}` | ECID |
| ヘルプページを表示 | 認証されていません | Mobile SDK | `{ECID, IDFA}` | IDFA |
| 当座預金口座残高の表示 | Authenticated | Web SDK | `{CRMID, ECID}` | CRMID |
| 住宅ローンにサインアップ | Authenticated | Analytics ソースコネクタ | `{CRMID, ECID, AAID}` | CRMID |
| 小切手から貯蓄に$1,000 を振り替える | Authenticated | Mobile SDK | `{CRMID, GAID, ECID}` | CRMID |

{style="table-layout:auto"}

## セグメント化サービス：セグメントメンバーシップのメタデータストレージ

![ セグメントメンバーシップストレージの図。](../images/namespace-priority/segment-membership-storage.png " セグメントメンバーシップストレージの図。"){zoomable="yes"}

特定の結合プロファイルについて、セグメントメンバーシップは、名前空間の優先度が最も高い ID に対して保存されます。

例えば、次の 2 つのプロファイルがあるとします。

* プロファイル 1 は John を表します。
   * John のプロファイルは S1 （セグメントメンバーシップ 1）に適合します。 例えば、S1 は、男性として識別される顧客のセグメントを参照できます。
   * John のプロファイルは S2 （セグメントメンバーシップ 2）の対象でもあります。 これは、ロイヤルティステータスがゴールドの顧客のセグメントを参照できます。
* プロファイル 2 は Jane を表します。
   * Jane のプロファイルは S3 （セグメントメンバーシップ 3）に適合します。 これは、女性として識別される顧客のセグメントを指す可能性があります。
   * Jane のプロファイルは S4 （セグメントメンバーシップ 4）にも適合します。 これは、ロイヤルティステータスが platinum の顧客のセグメントを参照できます。

John と Jane がデバイスを共有する場合、ECID （web ブラウザー）はあるユーザーから別のユーザーに転送されます。 ただし、このことは、John と Jane に対して保存されたセグメントメンバーシップ情報には影響しません。

セグメントの選定条件が ECID に対して保存された匿名イベントのみに基づいている場合、Jane はそのセグメントに適格となります。

## 他のExperience Platform サービスへの影響 {#implications}

この節では、名前空間の優先度が他のExperience Platform サービスに与える影響について説明します。

### 詳細なデータライフサイクル管理

データハイジーンレコードの削除リクエストは、特定の ID に対して次のような方法で機能します。

* リアルタイム顧客プロファイル：指定された ID をプライマリ ID とするプロファイルフラグメントを削除します。 **プロファイルのプライマリ ID は、名前空間の優先度に基づいて決定されるようになりました。**
* データレイク：指定された ID をプライマリ ID とするレコードを削除します。 リアルタイム顧客プロファイルとは異なり、データレイクのプライマリ ID は、WebSDK （`primary=true`）で指定されたプライマリ ID、またはプライマリ ID としてマークされたフィールドに基づきます

詳しくは、[ 高度なライフサイクル管理の概要 ](/help/hygiene/home.md) を参照してください。

### 計算属性

ID 設定が有効な場合、計算済み属性は、名前空間の優先度を使用して計算済み属性値を保存します。 特定のイベントについて、名前空間の優先順位が最も高い ID には、計算属性の値が書き込まれます。 詳しくは、[ 計算属性 UI ガイド ](/help/profile/computed-attributes/ui.md) を参照してください。

### データレイク

データレイクへのデータ取り込みは、引き続き [Web SDK](/help/tags/extensions/client/web-sdk/data-element-types.md#identity-map) およびスキーマで設定されたプライマリ ID 設定に従います。

データレイクは、名前空間の優先度に基づいてプライマリ ID を決定しません。 例えば、Adobe Customer Journey Analyticsは、名前空間の優先順位が有効になった後でも（例えば、新しい接続にデータセットを追加した場合など）、ID マップで値を引き続き使用します。これは、Customer Journey Analyticsがデータレイクのデータを使用するからです。

### エクスペリエンスデータモデル（XDM）スキーマ

XDM 個人プロファイルなど、XDM エクスペリエンスイベントではないスキーマは、引き続き、[ID としてマークするフィールド ](/help/xdm/ui/fields/identity.md) に従います。

XDM スキーマについて詳しくは、[ スキーマの概要 ](/help/xdm/home.md) を参照してください。

### インテリジェントサービス

データを選択する際に、名前空間を指定する必要があります。この名前空間は、スコアを計算するイベントと、計算されたスコアを保存するイベントを決定するために使用されます。 人物を表す名前空間を選択することをお勧めします。

* WebSDk を使用して web 動作データを収集する場合は、ID マップ内で CRMID 名前空間を選択することをお勧めします。
* Analytics ソースコネクタを使用して web 動作データを収集する場合は、ID 記述子（CRMID）を選択する必要があります。

この設定の結果、スコアは認証済みイベントを使用してのみ計算されます。

詳しくは、[ アトリビューション AI](/help/intelligent-services/attribution-ai/overview.md) および [ 顧客 AI](/help/intelligent-services/customer-ai/overview.md) に関するドキュメントを参照してください。

### パートナーが作成した宛先

共有デバイスに関連付けられたプロファイルの更新されたオーディエンスの不適格が、ダウンストリーム宛先に送信されない場合があります。 これは、次のような稀な状況で発生する場合があります。

* オーディエンスの選定は、匿名アクティビティにのみ基づきます。
* 複数のプロファイルをまたいだログインは短期間で発生します。

パートナーが作成した宛先について詳しくは、[ 宛先の概要 ](/help/destinations/home.md#adobe-built-and-partner-built-destinations) を参照してください。

### Privacy Service

[Privacy Service削除リクエスト ](../privacy.md) は、特定の id に対して次のように機能します。

* リアルタイム顧客プロファイル：指定された ID 値をプライマリ ID として持つ、プロファイルフラグメントを削除します。 **プロファイルのプライマリ ID は、名前空間の優先度に基づいて決定されるようになりました。**
* データレイク：指定した ID をプライマリまたはセカンダリ ID として持つレコードを削除します。

詳しくは、[Privacy Service の概要 ](/help/privacy-service/home.md) を参照してください。

### Edgeのセグメント化とEdge Network アプリケーション

[!DNL Identity Graph Linking Rules] のコンテキストでは、Edgeのセグメント化とEdge Network アプリケーションに関する 2 つの主な行動変化に注意する必要があります。

1. `identityMap` には、一意としてマークされた人物名前空間が含まれている必要があります。 ID としてマークされたフィールド（ID 記述子）はサポートされていません。
2. 認証中にエンドユーザーが閲覧する場合、ユーザー名前空間には `primary = true` の設定が必要です。

#### エッジセグメント化

特定のイベントで、人物エンティティを表すすべての名前空間が `identityMap` に含まれていることを確認してください。これは、[XDM フィールドとして送信された ID](/help/xdm/ui/fields/identity.md) は無視され、セグメントメンバーシップのメタデータストレージには使用されないからです。

* **イベントの適用性**：この動作は、Edge Networkに直接送信されるイベント（WebSDK や Mobile SDKなど）にのみ適用されます。 HTTP API ソース、その他のストリーミングソース、バッチソースで取り込まれたイベントなど [0}Experience Platform ハブ } から取り込まれたイベントは、この制限の対象になりません。](/help/landing/edge-and-hub-comparison.md)
* **Edgeのセグメント化特異性**：この動作は、エッジセグメント化に固有です。 バッチとストリーミングのセグメント化は、ハブ上で評価される個別のサービスで、同じプロセスには従いません。 詳しくは、[ エッジセグメント化ガイド ](/help/segmentation/methods/edge-segmentation.md) を参照してください。
* 詳しくは、[Adobe Experience Platformとアプリケーションのアーキテクチャ図 ](https://experienceleague.adobe.com/en/docs/blueprints-learn/architecture/architecture-overview/platform-applications#detailed-architecture-diagram)、[Edge Networkとハブの比較 ](/help/landing/edge-and-hub-comparison.md) のページを参照してください。

#### Edge Network アプリケーション

Edge Network上のアプリケーションが遅滞なくEdge プロファイルにアクセスできるようにするには、イベントに CRMID 上の `primary=true` が含まれていることを確認してください。 これにより、hub からの ID グラフの更新を待たずに、即座に可用性を確保できます。

* Edge Network上のアプリケーション（Adobe Target、Offer Decisioning、カスタム Personalization宛先など）は、Edge プロファイルからプロファイルにアクセスする際に、イベント内のプライマリ ID に引き続き依存します。
* Edge Networkの動作について詳しくは、[Experience Platform Web SDKとEdge Networkのアーキテクチャ図 ](https://experienceleague.adobe.com/en/docs/blueprints-learn/architecture/architecture-overview/deployment/websdk#experience-platform-webmobile-sdk-or-edge-network-server-api-deployment) を参照してください。
* Web SDKでプライマリ ID を設定する方法について詳しくは、[Data element types](/help/tags/extensions/client/web-sdk/data-element-types.md) および [Web SDKの ID データ ](/help/collection/use-cases/identity/id-overview.md) に関するドキュメントを参照してください。
* ECID がエクスペリエンスイベントに含まれていることを確認します。 ECID がない場合は、`primary=true` でイベントペイロードに追加されるので、予期しない結果が生じる可能性があります。