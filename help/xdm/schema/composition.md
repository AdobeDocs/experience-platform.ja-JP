---
keywords: Experience Platform；ホーム；人気のトピック；スキーマ；enum;mixin；フィールドグループ；mixin；フィールドグループ；mixin；データタイプ；データタイプ；データタイプ；データタイプ；データタイプ；プライマリ ID;XDM 個人プロファイル；XDM フィールド；enum データタイプ；エクスペリエンスイベント；エクスペリエンスイベント；XDM エクスペリエンスイベント；スキーマデザイン；クラス；クラス；データタイプ；データタイプ；データタイプ；データタイプ；スキーマ スキーマ；identityMap;ID マップ；ID マップ；スキーマデザイン；マップ；結合スキーマ；和集合
solution: Experience Platform
title: スキーマ構成の基本
description: エクスペリエンスデータモデル（XDM）スキーマと、Adobe Experience Platformでスキーマを構成するための構成要素、原則およびベストプラクティスについて説明します。
exl-id: d449eb01-bc60-4f5e-8d6f-ab4617878f7e
source-git-commit: dcb6770d739d0da5cfa339584a769f5311a8c7e1
workflow-type: tm+mt
source-wordcount: '4350'
ht-degree: 25%

---

# スキーマ構成の基本

エクスペリエンスデータモデル（XDM）スキーマと、Adobe Experience Platformでスキーマを構成するための構成要素、原則およびベストプラクティスについて説明します。 XDM の一般的な情報と [!DNL Experience Platform] 内での使用方法については、[XDM システムの概要 &#x200B;](../home.md) を参照してください。

## スキーマ {#understanding-schemas}

スキーマは、データの構造と形式を表し、検証する一連のルールです。スキーマは、高いレベルで、実世界のオブジェクト（人など）の抽象的な定義を提供し、そのオブジェクトの各インスタンスに含めるデータ（名、姓、誕生日など）の概要を示します。

スキーマは、データの構造を説明するだけでなく、制約や期待をデータに適用し、システム間の移動時に検証できるようにします。これらの標準的な定義により、接触チャネルに関係なくデータを一貫して解釈でき、アプリケーション間での翻訳の必要性を排除できます。

Experience Platformでは、このセマンティック正規化をスキーマを使用して維持管理します。 スキーマは Experience Platform での標準的なデータ記述方法で、スキーマに適合するすべてのデータを組織間で競合なく再利用可能にし、さらに複数の組織間で共有できるようになります。

XDM スキーマは、膨大な量の複雑なデータを自己完結型の形式で保存するのに最適です。 XDM がこれを実現する方法について詳しくは、このドキュメントの付録にある [&#x200B; 埋め込みオブジェクト &#x200B;](#embedded) および [&#x200B; ビッグデータ &#x200B;](#big-data) の節を参照してください。

### Experience Platform でのスキーマベースのワークフロー {#schema-based-workflows}

標準化は、Experience Platform の背後にある主要な概念です。アドビが推進する XDM は、顧客エクスペリエンスデータを標準化し、顧客エクスペリエンス管理の標準スキーマを定義する取り組みです。

Experience Platformの基盤となるインフラストラクチャ（[!DNL XDM System]）は、スキーマベースのワークフローを容易にし、[!DNL Schema Registry]、[!DNL Schema Editor]、スキーマメタデータおよびサービス使用パターンを含みます。 詳しくは、「[XDM システムの概要](../home.md)」を参照してください。

Experience Platformでスキーマを使用する主なメリットはいくつかあります。 1 つ目は、スキーマを使用すると、データガバナンスの改善とデータの最小化を可能にすることです。これは、プライバシー規制で特に重要になります。 次に、Adobeの標準コンポーネントを使用してスキーマを構築すると、最小限のカスタマイズで、すぐに使用できるインサイトを提供し、AI/ML サービスを使用できます。 最後に、スキーマは、データ共有のインサイトと効率的なオーケストレーションのためのインフラストラクチャを提供します。

## スキーマの計画 {#planning}

スキーマを構築する最初の手順は、スキーマ内で捕捉しようとする概念、すなわち現実世界のオブジェクトを決定することです。記述しようとしている概念を特定したら、データのタイプ、潜在的な ID フィールド、将来のスキーマの進化方法などを考えることで、スキーマの計画を開始します。

### Experience Platform でのデータ動作 {#data-behaviors}

Experience Platform での使用を意図したデータの動作タイプは、次の 2 つに分類されます。

* **レコードデータ**：主体の属性に関する情報を提供します。主体は、組織または個人にすることができます。
* **時系列データ**：レコードの主体によって直接または間接的にアクションが実行された時点のシステムのスナップショットを提供します。

すべての XDM スキーマは、レコードまたは時系列として分類できるデータを記述します。スキーマのデータ動作は、スキーマのクラスによって定義され、スキーマの作成時に割り当てられます。XDM クラスについては、このドキュメントで後述します。

レコードと時系列の両方のスキーマには、ID のマップ（`xdm:identityMap`）が含まれます。このフィールドには、次の節で説明する「ID」とマークされたフィールドから作成された、主体の ID 表現が含まれます。

### [!UICONTROL ID] {#identity}

>[!CONTEXTUALHELP]
>id="platform_schemas_identities"
>title="スキーマの ID"
>abstract="ID は、主体 (メールアドレスやマーケティング ID など) を識別するために使用できる、スキーマ内のキーフィールドです。これらのフィールドは、個々の ID グラフを構築したり、顧客プロファイルを作成したりするために使用されます。スキーマの ID について詳しくは、ドキュメントを参照してください。"

スキーマは、Experience Platformに取り込むデータの構造を定義します。 このデータにより、Platform 内の複数のサービスが強化され、各個人に対する単一の統一されたビューの作成に役立ちます。 したがって、スキーマを設計する際には、ID としてマークするフィールドについて慎重に考えます。これらは、データセット間でのプロファイルのステッチ方法を制御します。

このプロセスに役立つように、スキーマ内のキーフィールドを ID としてマークできます。 データの取り込み時に、これらのフィールドのデータは、その個人の「[!UICONTROL ID グラフ &#x200B;]」に挿入されます。 その後、[[!DNL Real-Time Customer Profile]](../../profile/home.md) やその他のExperience Platform サービスからグラフデータにアクセスし、個々の顧客の関連付けられたビューを提供できます。

一般的に「[!UICONTROL ID]」とマークされるフィールドには、メールアドレス、電話番号、[[!DNL Experience Cloud ID (ECID)]](https://experienceleague.adobe.com/docs/id-service/using/home.html?lang=ja)、CRM ID、その他の一意の ID フィールドなどがあります。 組織に固有の一意の ID も考慮してください。これらは「[!UICONTROL ID]」フィールドとしても使用できる可能性があるからです。

ID 情報が顧客にデジタルエクスペリエンスを提供するのにどのように役立つかについては、[ID サービスの概要 &#x200B;](../../identity-service/home.md) を参照してください。 [&#x200B; スキーマ作成時の ID の使用に関するヒント &#x200B;](./best-practices.md#data-validation-fields) については、データモデリングのベストプラクティスのドキュメントを参照してください。

Experience Platformに ID データを送信する方法は 2 つあります。

1. [&#x200B; スキーマエディター UI](../ui/fields/identity.md) または [&#x200B; スキーマレジストリ API](../api/descriptors.md#create) を使用して、ID 記述子を個々のフィールドに追加する
2. [`identityMap` フィールドの使用 &#x200B;](#identityMap)

#### `identityMap` {#identityMap}

`identityMap` は、個人の様々な id 値を、関連する名前空間と共に記述するマップタイプフィールドです。 このフィールドは、スキーマ自体の構造の中で ID 値を定義する代わりに、スキーマの ID 情報を提供するために使用できます。

`identityMap` を使用することの主な欠点は、ID 値がネストされることであり、セグメントビルダーや一部のサードパーティ統合などの最上位の ID フィールドを想定するツールでは、ID 値を操作するのが難しい場合があることです。

>[!NOTE]
>
>`identityMap` を使用するスキーマは、関係のソーススキーマとして使用できますが、参照スキーマとして使用することはできません。 これは、すべての参照スキーマに、ソーススキーマ内の参照フィールドにマッピングできる表示可能な ID が必要だからです。 ソーススキーマと参照スキーマの要件について詳しくは、[&#x200B; 関係 &#x200B;](../tutorials/relationship-ui.md) の UI ガイドを参照してください。

ただし、ID マップは、1 つのスキーマに対して ID の数が可変な場合や、ID を保存するソース（[!DNL Airship] やAdobe Audience Managerなど）からデータを取り込む場合に役立ちます。 さらに、[Adobe Experience Platform モバイルSDK](https://developer.adobe.com/client-sdks/home/) を使用する場合は、ID マップが必要です。

単純な ID マップの例は、次のようになります。

```json
"identityMap": {
  "email": [
    {
      "id": "jsmith@example.com",
      "primary": true
    }
  ],
  "ECID": [
    {
      "id": "87098882279810196101440938110216748923",
      "primary": false
    },
    {
      "id": "55019962992006103186215643814973128178",
      "primary": false
    }
  ],
  "CRMID": [
    {
      "id": "2e33192000007456-0365c00000000000",
      "primary": false
    }
  ]
}
```

上記の例が示すように、`identityMap` オブジェクト内の各キーは、ID 名前空間を表します。 各キーの値は、オブジェクトの配列で、各名前空間の ID 値（`id`）を表します。 Adobe アプリケーションで認識できる [&#x200B; 標準 ID 名前空間のリスト &#x200B;](../../identity-service/troubleshooting-guide.md#standard-namespaces) については、[!DNL Identity Service] のドキュメントを参照してください。

>[!NOTE]
>
>値がプライマリ ID （`primary`）かどうかを示すブール値を各 ID 値に指定することもできます。 [!DNL Real-Time Customer Profile] で使用するスキーマのプライマリ ID を設定するだけで済みます。 詳しくは、[&#x200B; 和集合スキーマ &#x200B;](#union) の節を参照してください。

### スキーマ進化の原則 {#evolution}

デジタルエクスペリエンスの本質が進化し続けるにつれ、デジタルエクスペリエンスを表すスキーマが必要になります。したがって、適切に設計されたスキーマは、必要に応じて適応し、進化し、以前のバージョンのスキーマに破壊的な変更を加えることなく使用できます。

下位互換性の維持はスキーマ進化にとって重要なので、Experience Platformでは純粋に追加のバージョン管理原則を適用します。 この原則により、スキーマへのすべての変更が、非破壊的な更新および変更のみを生み出すことを保証します。 つまり、**後方互換性を壊すような変更**&#x200B;はサポートされません。

>[!NOTE]
>
>スキーマに重大な変更を加えることができるのは、スキーマがExperience Platformへのデータの取り込みにまだ使用されておらず、リアルタイム顧客プロファイルでの使用が有効になっていない場合のみです。 ただし、スキーマを [!DNL Experience Platform] で使用した後は、追加バージョン管理ポリシーに従う必要があります。

次の表に、スキーマ、フィールドグループおよびデータタイプを編集する際にサポートされる変更を示します。

| サポートされる変更 | 後方互換性のない変更（サポートなし） |
| --- | --- |
| <ul><li>リソースへの新しいフィールドの追加</li><li>必須フィールドをオプションにする</li><li>新しい必須フィールドの導入*</li><li>リソースの表示名と説明の変更</li><li>プロファイルに参加するためのスキーマの有効化</li></ul> | <ul><li>以前に定義したフィールドの削除</li><li>既存のフィールドの名前の変更または再定義</li><li>以前にサポートされていたフィールド値の削除または制限</li><li>既存のフィールドをツリー内の別の場所に移動する</li><li>スキーマの削除</li><li>プロファイルへのスキーマの参加の無効化</li><li>プロファイルが有効になっており、データを取り込んだスキーマのプライマリ ID フィールドの変更</li></ul> |

\**次のセクションを参照して、[&#x200B; 新しい必須フィールドの設定 &#x200B;](#post-ingestion-required-fields) に関する重要な考慮事項を確認してください*。

### 必須フィールド

個々のスキーマフィールドは [&#x200B; 必須としてマーク &#x200B;](../ui/fields/required.md) できます。つまり、取り込まれたレコードには、検証に合格するためにこれらのフィールドにデータが含まれている必要があります。 例えば、スキーマのプライマリ ID フィールドを必要に応じて設定すると、取り込まれたすべてのレコードがリアルタイム顧客プロファイルに確実に関与するようにできます。 同様に、タイムスタンプフィールドを必要に応じて設定すると、すべての時系列イベントが時系列で保持されます。

>[!IMPORTANT]
>
>スキーマフィールドが必須であるかどうかに関係なく、Experience Platformは、取り込まれたフィールドの `null` 値または空の値を受け入れません。 レコードまたはイベント内の特定のフィールドに値がない場合、そのフィールドのキーは取り込みペイロードから除外する必要があります。

#### 取り込み後に必要に応じてフィールドを設定 {#post-ingestion-required-fields}

データの取り込みに使用されているフィールドが、元々は必須として設定されていなかった場合、そのフィールドには、一部のレコードで null 値が含まれている場合があります。 このフィールドを取り込み後に必須として設定した場合、履歴レコードが null の場合でも、今後のすべてのレコードにこのフィールドの値が含まれる必要があります。

以前のオプションフィールドを必須として設定する場合は、次の点に注意してください。

1. 履歴データをクエリして新しいデータセットに結果を書き込む場合、必須フィールドの null 値が含まれているので、一部の行は失敗します。
1. フィールドが [&#x200B; リアルタイム顧客プロファイル &#x200B;](../../profile/home.md) に参加しており、必要に応じて設定する前にデータを書き出した場合、一部のプロファイルでは null になる場合があります。
1. Schema Registry API を使用して、Experience Platformのすべての XDM リソースのタイムスタンプ付きの変更ログを（新しい必須フィールドを含めて）表示することができます。 詳しくは、[&#x200B; 監査ログエンドポイント &#x200B;](../api/audit-log.md) に関するガイドを参照してください。

### スキーマとデータの取得

データを Experience Platform で取得するには、まずデータセットを作成する必要があります。データセットは、データの変換とトラッキングを行うための構築ブロックで、通常は、取り込んだ [[!DNL Catalog Service]](../../catalog/home.md) ータを含むテーブルまたはファイルを表します。 すべてのデータセットは既存の XDM スキーマに基づいており、取得するデータの内容と構造の制約を提供します。詳しくは、「[Adobe Experience Platform でのデータ取得の概要](../../ingestion/home.md)」を参照してください。

## スキーマの構成要素 {#schema-building-blocks}

Experience Platform では、標準の構築要素を組み合わせてスキーマを作成する構成アプローチを使用します。このアプローチは、既存のコンポーネントの再利用性を促進し、業界全体で標準化を推進して、[!DNL Experience Platform] のベンダースキーマとコンポーネントをサポートします。

スキーマは、次の式を使用して構成されます。

**クラス + スキーマフィールドグループ&ast; = XDM スキーマ**

&amp;ast；スキーマは、クラスと 0 個以上のスキーマフィールドグループで構成されます。 つまり、フィールドグループをまったく使用せずに、データセットスキーマを作成できます。

### クラス {#class}

>[!CONTEXTUALHELP]
>id="platform_schemas_class"
>title="クラス"
>abstract="各スキーマは、単一のクラスに基づいています。クラスは、スキーマの動作と、そのクラスに基づくすべてのスキーマに含める必要がある共通プロパティを定義します。クラスがスキーマ構成にどのように関わっているかについて詳しくは、ドキュメントを参照してください。"

>[!CONTEXTUALHELP]
>id="platform_schemas_class_industries"
>title="業界タイプ"
>abstract="ビジネスに関連する業界を選択すると、機械学習モデルは、業界標準に準拠した標準フィールドグループにソースフィールドをより正確にマッピングすることで、より適切なデータ組織を提供できます。これにより、データ統合が業界固有のニーズに合わせて調整され、より正確で関連性の高いデータインサイトが得られます。"

クラスを割り当てることで、スキーマの構成が開始されます。クラスは、スキーマに含まれるデータ（レコードまたは時系列）の行動の側面を定義します。 これに加えて、クラスは、そのクラスに基づくすべてのスキーマに含める必要のある共通のプロパティの最小数を記述し、複数の互換性のあるデータセットを結合する方法を提供します。

スキーマのクラスは、そのスキーマで使用できるフィールドグループを決定します。 これについて詳しくは、[&#x200B; 次の節 &#x200B;](#field-group) で説明します。

Adobeには、複数の標準（「コア」） XDM クラスがあります。 これらの 2 つのクラス（[!DNL XDM Individual Profile] と [!DNL XDM ExperienceEvent]）は、ほぼすべてのダウンストリーム Experience Platform プロセスで必要です。 これらのコアクラスに加えて、独自のカスタムクラスを作成して、組織のより具体的な使用例を記述することもできます。 カスタムクラスは、一意のユースケースを記述するために使用できるAdobe定義のコアクラスがない場合に、組織が定義します。

次のスクリーンショットは、Experience Platform UI でクラスがどのように表されるかを示しています。 表示されるサンプルスキーマにはフィールドグループが含まれていないので、表示されるすべてのフィールドはスキーマのクラス（[!UICONTROL XDM 個人プロファイル &#x200B;]）によって提供されます。

スキーマエディター内の ![[!UICONTROL XDM 個人プロファイル &#x200B;]。](../images/schema-composition/class.png)

使用可能な標準 XDM クラスの最新のリストについては、[&#x200B; 公式 XDM リポジトリ &#x200B;](https://github.com/adobe/xdm/tree/master/components/classes) を参照してください。 または、UI でリソースを表示したい場合は、[XDM コンポーネントの調査 &#x200B;](../ui/explore.md) に関するガイドを参照してください。

### フィールドグループ {#field-group}

>[!CONTEXTUALHELP]
>id="platform_schemas_fieldgroup"
>title="フィールドグループ"
>abstract="フィールドグループは、追加属性でスキーマを拡張できる、再利用可能なコンポーネントです。ほとんどのフィールドグループは、特定のクラスにしか対応していません。アドビが定義した標準フィールドグループを使用したり、独自のカスタムフィールドグループを手動で定義したりできます。フィールドグループがスキーマ構成にどのように関わっているかについて詳しくは、ドキュメントを参照してください。"

>[!CONTEXTUALHELP]
>id="platform_schemas_fieldgroup_requiredFieldgroup"
>title="必須のフィールドグループ"
>abstract="このフィールドグループは、使用しているソースに必須です。そのため、スキーマから削除することはできません。"

フィールドグループは、個人の詳細情報、ホテルの環境設定、住所などの特定の機能を実装する 1 つ以上のフィールドを定義する再利用可能なコンポーネントです。 フィールドグループは、互換性のあるクラスを実装するスキーマの一部として含めることを目的としています。

フィールドグループは、表現するデータの動作（レコードまたは時系列）に基づいて、互換性のあるクラスを定義します。 つまり、すべてのフィールドグループをすべてのクラスで使用できるわけではありません。

Experience Platformには、Adobeの標準フィールドグループが多数含まれています。また、ベンダーはユーザーのフィールドグループを定義でき、個々のユーザーは独自の具体的なコンセプトのフィールドグループを定義できます。

例えば、「[!UICONTROL &#x200B; ロイヤルティメンバー &#x200B;]」スキーマの「[!UICONTROL &#x200B; 名 &#x200B;]」や「[!UICONTROL &#x200B; 自宅の住所 &#x200B;]」などの詳細を取り込むには、これらの一般的な概念を定義する標準のフィールドグループを使用できます。 ただし、標準のフィールドグループではカバーされない可能性のある、組織に固有の概念（カスタムロイヤルティプログラムの詳細や製品属性など）です。 この場合、この情報を取得するには、独自のフィールドグループを定義する必要があります。

>[!NOTE]
>
>可能な限り、スキーマで標準フィールドグループを使用することを強くお勧めします。これらのフィールドはExperience Platform サービスによって暗黙的に理解され、[!DNL Experience Platform] コンポーネント間で使用される場合に一貫性が高まるからです。
>
>標準コンポーネント（「名」や「メールアドレス」など）で提供されるフィールドには、基本的なスカラーフィールドタイプ以外の注釈が含まれています。 [!DNL Experience Platform] は、同じデータタイプを共有するフィールドは同じように動作します。 この動作は、データの取得元やデータが使用されているサービスに関係なく、一貫性 [!DNL Experience Platform] 持つように信頼できます。

スキーマは「0 個以上」のフィールドグループで構成されているので、フィールドグループをまったく使用せずに有効なスキーマを作成できます。

次のスクリーンショットは、Experience Platform UI でフィールドグループがどのように表現されるかを示しています。 この例では、単一のフィールドグループ（[!UICONTROL &#x200B; デモグラフィックの詳細 &#x200B;]）がスキーマに追加され、スキーマの構造に対するフィールドのグループ化が可能になります。

![&#x200B; スキーマの例で [!UICONTROL &#x200B; デモグラフィックの詳細 &#x200B;] フィールドグループがハイライト表示されたスキーマエディター &#x200B;](../images/schema-composition/field-group.png)

使用可能な標準 XDM フィールドグループの最新のリストについては、[&#x200B; 公式 XDM リポジトリ &#x200B;](https://github.com/adobe/xdm/tree/master/components/fieldgroups) を参照してください。 または、UI でリソースを表示したい場合は、[XDM コンポーネントの調査 &#x200B;](../ui/explore.md) に関するガイドを参照してください。

>[!NOTE]
>
> 標準 XDM フィールドグループは常に進化しており、一部のフィールドグループは非推奨（廃止予定）になっています。 非推奨フィールドグループの最新のリストについては、公式の XDM リポジトリの [&#x200B; 非推奨フィールドグループの節 &#x200B;](https://github.com/adobe/xdm/tree/master/components/fieldgroups/deprecated) を参照してください。

### データタイプ {#data-type}

データタイプは、基本リテラルフィールドと同様に、クラスやスキーマの参照フィールド型として使用されます。主な違いは、データタイプがフィールドグループと同じ方法で複数のサブフィールドを定義できることです。 これらの主な違いは、データタイプをフィールドの「データタイプ」として追加することで、スキーマ内の任意の場所に含めることができるということです。 フィールドグループは特定のクラスにのみ適合しますが、データタイプは任意の親クラスまたはフィールドグループに含めることができます。

>[!NOTE]
>
>フィールドが特定のデータタイプとして定義されている場合、同じフィールドを別のスキーマの異なるデータタイプで作成することはできません。 この制約は、組織のテナントに適用されます。

Experience Platformは、共通のデータ構造を記述するための標準パターンの使用をサポートする [!DNL Schema Registry] ールの一部として、共通のデータタイプを多数提供しています。 これについては、[&#x200B; スキーマレジストリのチュートリアル &#x200B;](../tutorials/create-schema-api.md) で詳しく説明し、データタイプを定義する手順を実行する際に、より明確になります。

次のスクリーンショットは、Experience Platform UI でデータタイプがどのように表されるかを示しています。 [!UICONTROL &#x200B; デモグラフィックの詳細 &#x200B;] フィールドグループが提供するフィールドの 1 つは、「[!UICONTROL &#x200B; オブジェクト &#x200B;]」データタイプを使用します。これは、フィールド名の横にあるパイプ文字（`|`）に続くテキストで示されます。 この特定のデータタイプは、個々のユーザーの名前に関連する複数のサブフィールドを提供します。これは、ユーザーの名前を取り込む必要がある他のフィールドで再利用できる構造です。

![&#x200B; フルネームのオブジェクトと属性がハイライト表示された個々のユーザーのスキーマエディターの図。](../images/schema-composition/data-type.png)

使用可能な標準 XDM データタイプの最新のリストについては、[&#x200B; 公式 XDM リポジトリ &#x200B;](https://github.com/adobe/xdm/tree/master/components/datatypes) を参照してください。 または、UI でリソースを表示したい場合は、[XDM コンポーネントの調査 &#x200B;](../ui/explore.md) に関するガイドを参照してください。

>[!NOTE]
>
> 標準 XDM データタイプは常に進化しており、一部のデータタイプは非推奨（廃止予定）になっています。 非推奨データタイプの最新のリストについては、公式の XDM リポジトリの [&#x200B; 非推奨データタイプ &#x200B;](https://github.com/adobe/xdm/tree/master/components/datatypes/deprecated) の節を参照してください。

### フィールド {#field}

フィールドは、スキーマの最も基本的な構成要素です。フィールドは、特定のデータタイプを定義することによって、フィールドに含めることができるデータのタイプに関する制約を提供します。 これらの基本的なデータタイプは単一のフィールドを定義します。前述の [&#x200B; データタイプ &#x200B;](#data-type) を使用すると、複数のサブフィールドを定義し、様々なスキーマで同じ複数フィールド構造を再利用できます。 したがって、フィールドの「データタイプ」をレジストリで定義されたデータタイプの 1 つとして定義する以外に、Experience Platform は、次のような基本的なスカラー型をサポートしています。

* 文字列
* 整数
* Double
* Boolean
* 配列
* オブジェクト

>[!TIP]
>
>オブジェクトタイプのフィールドよりも自由形式のフィールドを使用するメリットとデメリットについては、[&#x200B; 付録 &#x200B;](#objects-v-freeform) を参照してください。

これらのスカラー型の有効な範囲は、特定のパターン、形式、最小値や最大値、事前定義値にさらに制限できます。これらの制約を使用すると、以下のような、より詳細なフィールドタイプを幅広く表すことができます。

* Enum
* Long
* Short
* Byte
* Date
* Date-time
* Map

>[!NOTE]
>
>「マップ」フィールドタイプを使用すると、キーと値のペアのデータを、1 つのキーに対して複数の値を含めることができます。 マップは標準の XDM クラスとフィールドグループにありますが、カスタムマップを定義することもできます。 詳しくは、[&#x200B; カスタムマップフィールドの定義 &#x200B;](../tutorials/custom-fields-api.md#custom-maps) に関する API チュートリアルまたは [UI でのマップフィールドの定義 &#x200B;](../ui/fields/map.md) に関するガイドを参照してください。

## 構成の例 {#composition-example}

スキーマは、コンポジションモデルを使用して作成され、[!DNL Experience Platform] に取り込むデータの形式と構造を表します。 前述のように、これらのスキーマは、1 つのクラスと、そのクラスと互換性のある 0 個以上のフィールドグループで構成されます。

例えば、小売店での購入を記述するスキーマは「ストアトランザクション [!UICONTROL &#x200B; と呼ばれる場合があり &#x200B;] す。 スキーマは、標準の [!UICONTROL Commerce] フィールドグループとユーザー定義の [!UICONTROL Product Info] フィールドグループを組み合わせた [!DNL XDM ExperienceEvent] クラスを実装します。

Web サイトのトラフィックを追跡する別のスキーマは、「[!UICONTROL Web 訪問 &#x200B;]」と呼ばれる場合があります。 また、[!DNL XDM ExperienceEvent] クラスも実装しますが、今回は、標準の [!UICONTROL Web] フィールドグループを組み合わせたものです。

次の図に、これらのスキーマと、各フィールドグループによって提供されるフィールドを示します。 また、このガイドで前述した「[!UICONTROL &#x200B; ロイヤルティメンバー &#x200B;]」スキーマなど、[!DNL XDM Individual Profile] クラスに基づく 2 つのスキーマも含まれています。

![4 つのスキーマとそれらに寄与するフィールドグループのフロー図。](../images/schema-composition/composition.png)

### 和集合 {#union}

Experience Platform では特定の使用事例のスキーマを作成できますが、特定のクラスタイプのスキーマの「和集合」を確認することもできます。前の図は、XDM ExperienceEvent クラスに基づく 2 つのスキーマと、クラスに基づく 2 つのスキーマ [!DNL XDM Individual Profile] 示しています。 以下に示す和集合は、同じクラス （それぞれ [!DNL XDM ExperienceEvent] および [!DNL XDM Individual Profile]）を共有するすべてのスキーマのフィールドを集計します。

![&#x200B; それらを構成するフィールドを表した結合スキーマフロー図。](../images/schema-composition/union.png)

スキーマを [!DNL Real-Time Customer Profile] で使用できるようにすると、そのクラスタイプの結合に含められます。 [!DNL Profile] は、顧客属性の堅牢な一元化されたプロファイルと、[!DNL Experience Platform] と統合されたあらゆるシステムで顧客が行ってきたすべてのイベントのタイムスタンプ付きアカウントを提供します。 [!DNL Profile] は、和集合ビューを使用してこのデータを表し、各顧客の全体像を提供します。

[!DNL Profile] の操作について詳しくは、[&#x200B; リアルタイム顧客プロファイルの概要 &#x200B;](../../profile/home.md) を参照してください。

## XDM スキーマへのデータファイルのマッピング {#mapping-datafiles}

Experience Platform に取得されるすべてのデータファイルは、XDM スキーマの構造に従う必要があります。XDM 階層（サンプルファイルを含む）に準拠するようにデータファイルをフォーマットする方法の詳細は、[ETL 変換のサンプル](../../etl/transformations.md)に関するドキュメントを参照してください。データファイルの Experience Platform への取得に関する一般的な情報については、「[バッチ取得の概要](../../ingestion/batch-ingestion/overview.md)」を参照してください。

## 外部オーディエンスのスキーマ

外部システムからExperience Platformにオーディエンスを取り込む場合は、次のコンポーネントを使用してスキーマで取り込む必要があります。

* [[!UICONTROL &#x200B; セグメント定義 &#x200B;] クラス &#x200B;](../classes/segment-definition.md)：この標準クラスを使用して、外部セグメント定義のキー属性を取り込みます。
* [[!UICONTROL &#x200B; セグメントメンバーシップの詳細 &#x200B;] フィールドグループ &#x200B;](../field-groups/profile/segmentation.md)：このフィールドグループを [!UICONTROL XDM 個人プロファイル &#x200B;] スキーマに追加して、顧客プロファイルを特定のオーディエンスに関連付けます。

## 次の手順

これでスキーマ構成の基本を理解したので、次は [!DNL Schema Registry] を使用したスキーマの調査と構築を開始します。

2 つのコア XDM クラスの構造と、それらの一般的に使用される互換性のあるフィールドグループを確認するには、次のリファレンスドキュメントを参照してください。

* [[!DNL XDM Individual Profile]](../classes/individual-profile.md)
* [[!DNL XDM ExperienceEvent]](../classes/experienceevent.md)

[!DNL Schema Registry] は、Adobe Experience Platform内の [!DNL Schema Library] にアクセスするために使用され、ユーザーインターフェイスと RESTful API を提供します。ここから、使用可能なすべてのライブラリリソースにアクセスできます。 [!DNL Schema Library] には、Adobeで定義された業界リソース、Experience Platform パートナーで定義されたベンダーリソース、組織のメンバーによって作成されたクラス、フィールドグループ、データタイプ、スキーマが含まれています。

UI を使用してスキーマの構成を開始するには、[スキーマエディターのチュートリアル](../tutorials/create-schema-ui.md)を参照しながら、このドキュメントで取り上げる「ロイヤルティメンバー」スキーマを作成します。

[!DNL Schema Registry] API の使用を開始するには、まず [&#x200B; スキーマレジストリ API 開発者ガイド &#x200B;](../api/getting-started.md) を参照してください。 開発者ガイドを読んだ後、[スキーマレジストリ API を使用したスキーマの作成](../tutorials/create-schema-api.md)に関するチュートリアルで説明されている手順に従います。

## 付録

以下の節では、スキーマ構成の原則に関する追加情報を示します。

### リレーショナルテーブルと埋め込みオブジェクト {#embedded}

リレーショナルデータベースを使用する場合のベストプラクティスには、データの正規化、またはエンティティを取得してそれを個別のピースに分割し、複数のテーブルに表示することが含まれます。データ全体を読み取ったり、エンティティを更新したりするには、JOIN を使用して、多数の個別のテーブルに対して読み取りおよび書き込み操作を行う必要があります。

埋め込みオブジェクトを使用することで、XDM スキーマは複雑なデータを直接表し、階層構造を持つ自己完結型のドキュメントに保存できます。 この構造の主な利点の 1 つは、複数の非正規化テーブルへの高価な結合によってエンティティを再構築することなく、データをクエリできることです。 スキーマ階層のレベル数に関する厳しい制限はありません。

### スキーマとビッグデータ {#big-data}

現代のデジタルシステムは、大量の行動信号（トランザクションデータ、Web ログ、物のインターネット、ディスプレイなど）を生成します。このビッグデータは、エクスペリエンスを最適化する非常に大きな機会を生み出しますが、データの規模と多様性が原因で、使用が困難です。データから価値を得るには、その構造、形式、定義を標準化して、一貫して効率的に処理できるようにする必要があります。

スキーマは、複数のソースからのデータの統合、共通の構造や定義による標準化、複数のソリューション間での共有を可能にすることで、この問題を解決します。これにより、後続のプロセスやサービスは、データに関するあらゆる種類の質問に答えることができます。 従来のデータモデリングのアプローチから移行します。従来のデータモデリングでは、データに関する質問はすべて事前に把握され、その期待に応えるためにデータがモデル化されます。

### オブジェクトとフリーフォームフィールド {#objects-v-freeform}

スキーマをデザインする際に自由形式フィールドよりもオブジェクトを選択する場合は、いくつかの重要な要因を考慮する必要があります。

| オブジェクト | 自由形式フィールド |
| --- | --- |
| ネストを増やす | ネストを減らす、またはネストしない |
| 論理フィールドグループを作成します | フィールドはアドホックな場所に配置されます |

{style="table-layout:auto"}

#### オブジェクト

フリーフォームフィールドでオブジェクトを使用する場合のメリットとデメリットを以下に示します。

**長所**:

* オブジェクトは、特定のフィールドの論理グループを作成する場合に最適です。
* オブジェクトを使用すると、スキーマをより構造化された方法で整理できます。
* オブジェクトは、セグメントビルダー UI で適切なメニュー構造を作成するのに間接的に役立ちます。 スキーマ内のグループ化されたフィールドは、セグメントビルダー UI で提供されるフォルダー構造に直接反映されます。

**短所**:

* フィールドがネストされます。
* [Adobe Experience Platform クエリサービス &#x200B;](../../query-service/home.md) を使用する場合は、オブジェクトにネストされたフィールドをクエリするために、より長い参照文字列を指定する必要があります。

#### 自由形式フィールド

オブジェクト上でフリーフォームフィールドを使用するメリットとデメリットを以下に示します。

**長所**:

* フリーフォームフィールドは、スキーマのルートオブジェクト（`_tenantId`）の直下に作成されるので、可視性が向上します。
* フリーフォームフィールドの参照文字列は、クエリサービスを使用する場合は短くなる傾向があります。

**短所**:

* スキーマ内の自由形式フィールドの場所はアドホックです。つまり、スキーマエディター内ではアルファベット順に表示されます。 これにより、スキーマの構造が悪くなり、類似した自由形式フィールドが名前に応じて大きく区切られる可能性があります。
