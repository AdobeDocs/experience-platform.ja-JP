---
keywords: Experience Platform；プロファイル；リアルタイム顧客プロファイル；トラブルシューティング；API；同意；同意；環境設定；Preferences;privacyOptOuts;marketingPreferences;optOutType;basisOfProcessing；同意；同意
title: 同意と環境設定のデータタイプ
description: プライバシー、パーソナライゼーション、マーケティングの環境設定のデータ型は、お客様の権限や環境設定を、お客様のデータ操作からの同意管理プラットフォーム (CMP) やその他のソースによって生成される収集をサポートすることを目的としています。
topic-legacy: guide
exl-id: cdcc7b04-eeb9-40d3-b0b5-f736a5472621
source-git-commit: 12c3f440319046491054b3ef3ec404798bb61f06
workflow-type: tm+mt
source-wordcount: '1905'
ht-degree: 3%

---

# [!UICONTROL 同意と環境設定] データ型

[!UICONTROL  プライバシー、パーソナライゼーション、マーケティングの環境設定に対する同意 ] データ型（以下「[!UICONTROL  同意と環境設定 ] データ型」と呼ばれます）は、顧客の権限や設定の収集をサポートする [!DNL Experience Data Model](XDM) データ型ですデータ操作を実行する場合。

このドキュメントでは、[!UICONTROL  同意と環境設定 ] データ型で提供されるフィールドの構造と使用方法について説明します。

## 前提条件 {#prerequisites}

このドキュメントでは、XDM と [!DNL Experience Platform] でのスキーマの使用に関する十分な知識が必要です。 続行する前に、次のドキュメントを確認してください。

* [XDM システムの概要](http://www.adobe.com/go/xdm-home-en)
* [スキーマ構成の基本](http://www.adobe.com/go/xdm-schema-best-practices-en)

## データタイプの構造 {#structure}

>[!IMPORTANT]
>
>[!UICONTROL  同意と環境設定 ] データ型は、同意と環境設定の管理に関する様々な使用例を対象とするように設計されています。 そのため、このドキュメントでは、データ型のフィールドの一般的な使用方法を説明し、これらのフィールドの使用方法を解釈する方法についての提案のみを行います。 データ型の構造を、組織がこれらの同意や優先度の選択をどのように解釈し、顧客に提示するかに合わせるには、プライバシー法務チームにご相談ください。

[!UICONTROL  同意と環境設定 ] データ型は、**同意** および **環境設定** の情報を取り込むためのフィールドを提供します。

同意とは、お客様がデータの使用方法を指定できるオプションです。 ほとんどの同意は法的側面を持ち、特定の方法でデータを使用する前に権限を取得する必要がある場合や、肯定的な同意が不要な場合は、その使用を停止（オプトアウト）するオプションが顧客に必要な場合です。

環境設定とは、顧客がブランドに関するエクスペリエンスの様々な側面を処理する方法を指定できるオプションです。 これらは次の 2 つのカテゴリに分類されます。

* **パーソナライゼーションの環境設定**:ブランドが顧客に提供するエクスペリエンスをパーソナライズする方法に関する環境設定。
* **マーケティング環境設定**:様々なチャネルを通じてブランドから顧客への連絡を許可するかどうかに関する環境設定。

次のスクリーンショットは、データ型の構造が Platform UI でどのように表されるかを示しています。

![](../images/data-types/consents.png)

>[!TIP]
>
>XDM リソースを検索し、Platform UI で構造を調べる手順については、 [XDM リソース ](../ui/explore.md) ののを参照してください。

次の JSON は、[!UICONTROL  同意と環境設定 ] データ型で処理できるデータのタイプの例を示しています。 これらの各フィールドの具体的な使用方法に関する情報は、以降の節で説明します。

```json
{
  "consents": {
    "collect": {
      "val": "y",
    },
    "adID": {
      "val": "VI"
    },
    "share": {
      "val": "y",
    },
    "personalize": {
      "content": {
        "val": "y"
      }
    },
    "marketing": {
      "preferred": "email",
      "any": {
        "val": "u"
      },
      "push": {
        "val": "n",
        "reason": "Too Frequent",
        "time": "2019-01-01T15:52:25+00:00"
      }
    },
    "metadata": {
      "time": "2019-01-01T15:52:25+00:00"
    }
  }
}
```

>[!TIP]
>
>顧客の同意と環境設定データのマッピング方法を視覚化できるよう、Experience Platformで定義した任意の XDM スキーマのサンプル JSON データを生成できます。 詳しくは、次のドキュメントを参照してください。
>
>* [UI でのサンプルデータの生成](../ui/sample.md)
>* [API でのサンプルデータの生成](../api/sample-data.md)


## `consents` {#choices}

`consents` には、顧客の同意と環境設定を説明するフィールドがいくつか含まれています。これらのフィールドについて詳しくは、以下のサブセクションで説明します。

```json
"consents": {
  "collect": {
    "val": "y",
  },
  "adID": {
    "val": "VI"
  },
  "share": {
    "val": "y",
  },
  "personalize": {
    "content": {
      "val": "y"
    }
  },
  "marketing": {
    "preferred": "email",
    "any": {
      "val": "u"
    },
    "email": {
      "val": "n",
      "reason": "Too Frequent",
      "time": "2019-01-01T15:52:25+00:00"
    }
  }
}
```

### `collect`

`collect` は、データを収集することに対する顧客の同意を表します。

```json
"collect" : {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | この使用例に対するお客様提供の同意の選択。 指定できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |

{style=&quot;table-layout:auto&quot;}

### `adID`

`adID` は、広告主 ID（IDFA または GAID）を使用して、このデバイスのアプリをまたいで顧客をリンクできるかどうかに関する顧客の同意を表します。

```json
"adID" : {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | この使用例に対するお客様提供の同意の選択。 指定できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |

{style=&quot;table-layout:auto&quot;}

### `share`

`share` は、データをセカンドパーティまたはサードパーティと共有（またはセカンドパーティに販売）できるかどうかに関する顧客の同意を表します。

```json
"share" : {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | この使用例に対するお客様提供の同意の選択。 指定できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |

{style=&quot;table-layout:auto&quot;}

### `personalize` {#personalize}

`personalize` では、顧客のデータをパーソナライゼーションに使用する方法に関する顧客の環境設定を取り込みます。お客様は、特定のパーソナライゼーションの使用例からオプトアウトしたり、パーソナライゼーション全体をオプトアウトしたりできます。

>[!IMPORTANT]
>
>`personalize` はマーケティングの使用例をカバーしていません。例えば、すべてのチャネルのパーソナライゼーションをオプトアウトした顧客は、これらのチャネルを介したコミュニケーションの受信を停止しないでください。 代わりに、受信するメッセージは、プロファイルに基づくものではなく、汎用的なものである必要があります。
>
>同じ例で、顧客が（[ 次の節 ](#marketing) で説明する `marketing` を通じて）すべてのチャネルのダイレクトマーケティングをオプトアウトした場合、パーソナライゼーションが許可されていても、その顧客はメッセージを受け取れません。

```json
"personalize": {
  "content": {
    "val": "y",
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `content` | Web サイトやアプリケーション上でパーソナライズされたコンテンツに対する顧客の好みを表します。 |
| `val` | 指定したユースケースに対する、顧客が提供するパーソナライゼーションの環境設定。 お客様が同意を得るように求められない場合は、このフィールドの値に、パーソナライゼーションをおこなう基準を示す必要があります。 指定できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |

{style=&quot;table-layout:auto&quot;}

### `marketing` {#marketing}

`marketing` は、データが使用できるマーケティング目的に関する顧客の環境設定を取り込みます。お客様は、特定のマーケティングの使用例をオプトアウトしたり、ダイレクトマーケティング全体をオプトアウトしたりできます。

```json
"marketing": {
  "preferred": "email",
  "any": {
    "val": "u"
  },
  "email": {
    "val": "n",
    "reason": "Too Frequent"
  },
  "push": {
    "val": "y"
  },
  "sms": {
    "val": "y"
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `preferred` | 顧客がコミュニケーションを受け取るための優先チャネルを示します。 指定できる値については、[ 付録 ](#preferred-values) を参照してください。 |
| `any` | ダイレクトマーケティングに関する顧客の好みを表します。 `marketing` で指定された追加のサブフィールドで上書きされない限り、このフィールドで指定された同意設定は、マーケティングチャネルの「デフォルト」設定と見なされます。 より詳細な同意オプションを使用する予定がある場合は、このフィールドを除外することをお勧めします。<br><br>値をに設定した場合、より具体的な `n`パーソナライゼーション設定はすべて無視する必要があります。この値を `y` に設定した場合は、`n` に明示的に設定しない限り、すべての詳細なパーソナライゼーションオプションも `y` として扱う必要があります。 値が設定されていない場合、各パーソナライゼーションオプションの値は、指定されたとおりに扱われます。 |
| `email` | 顧客が E メールメッセージの受信に同意するかどうかを示します。 |
| `push` | 顧客がプッシュ通知の受信を許可するかどうかを示します。 |
| `sms` | 顧客がテキストメッセージの受信に同意するかどうかを示します。 |
| `val` | 指定したユースケースに対する顧客提供の環境設定。 顧客が同意を求める必要がない場合は、このフィールドの値にマーケティングの使用例を実行する基準を示す必要があります。 指定できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |
| `time` | マーケティング環境設定が変更された場合の ISO 8601 のタイムスタンプ（該当する場合）。 個々の環境設定のタイムスタンプが `metadata` で指定したタイムスタンプと同じ場合、このフィールドはその環境設定には設定されません。 |
| `reason` | 顧客がマーケティングの使用例をオプトアウトした場合、この文字列フィールドは顧客がオプトアウトした理由を表します。 |

{style=&quot;table-layout:auto&quot;}

### `metadata`

`metadata` は、顧客の同意と環境設定に関する一般的なメタデータを最後に更新されたたびにキャプチャします。

```json
"metadata": {
  "time": "2019-01-01T15:52:25+00:00",
}
```

| プロパティ | 説明 |
| --- | --- |
| `time` | 顧客の同意と環境設定が最後に更新された時点の ISO 8601 タイムスタンプ。 このフィールドは、負荷と複雑さを減らすために、個々の環境設定にタイムスタンプを適用する代わりに使用できます。 個々の環境設定で `time` 値を指定すると、その環境設定の `metadata` タイムスタンプが上書きされます。 |

{style=&quot;table-layout:auto&quot;}

## データ型を使用したデータの取り込み {#ingest}

[!UICONTROL  同意と環境設定 ] データ型を使用して顧客から同意データを取り込むには、そのデータ型を含むスキーマに基づいてデータセットを作成する必要があります。

フィールドにデータ型を割り当てる手順については、[UI でのスキーマの作成 ](http://www.adobe.com/go/xdm-schema-editor-tutorial-en) に関するチュートリアルを参照してください。 [!UICONTROL  同意と環境設定 ] データ型を持つフィールドを含むスキーマを作成したら、データセットユーザーガイドの [ データセットの作成 ](../../catalog/datasets/user-guide.md#create) の節を参照し、既存のスキーマを持つデータセットを作成します。

>[!IMPORTANT]
>
>同意データを [!DNL Real-time Customer Profile] に送信する場合は、[!UICONTROL  同意と環境設定 ] データ型を含む [!DNL XDM Individual Profile] クラスに基づいて [!DNL Profile] 対応のスキーマを作成する必要があります。 そのスキーマに基づいて作成するデータセットも、[!DNL Profile] に対して有効にする必要があります。 スキーマとデータセットの [!DNL Real-time Customer Profile] 要件に関する具体的な手順については、上記にリンクされたチュートリアルを参照してください。
>
>また、顧客プロファイルを正しく更新するには、最新の同意データと環境設定データを含むデータセットに優先順位を付けるように結合ポリシーが設定されていることを確認する必要があります。 詳しくは、[ 結合ポリシー ](../../rtcdp/profile/merge-policies.md) の概要を参照してください。

## 同意と環境設定の変更の処理

お客様が Web サイトでの同意や環境設定を変更した場合は、[Adobe Experience Platform Web SDK](../../edge/consent/supporting-consent.md) を使用して、変更内容を収集し、即座に適用する必要があります。 顧客がデータ収集をオプトアウトした場合、すべてのデータ収集は直ちに停止する必要があります。 顧客がパーソナライゼーションをオプトアウトした場合、訪問する次のページにパーソナライゼーションが存在しないはずです。

## 付録 {#appendix}

以下の節では、[!UICONTROL  同意と環境設定 ] データ型に関する追加の参照情報を示します。

### `val` に指定できる値 {#choice-values}

次の表に、`val` で使用できる値の概要を示します。

| 値 | タイトル | 説明 |
| --- | --- | --- |
| `y` | ○ | お客様が同意または優先事項をオプトインしました。 つまり、**** は、該当する同意または好みで示されるように、データの使用に同意します。 |
| `n` | × | お客様が同意または優先事項をオプトアウトしました。 つまり、**データの使用に対して、該当する同意や好みで示される同意は** ありません。 |
| `p` | 検証待ち | システムは、最終的な同意値または優先値をまだ受け取っていません。 これは、2 段階の検証が必要な同意の一部として最もよく使用されます。 例えば、顧客が E メールの受信をオプトインした場合、E メール内のリンクを選択して正しい E メールアドレスを指定したことを確認するまで、その同意は `p` に設定され、その時点で同意が `y` に更新されます。<br><br>この同意または環境設定で 2 つの検証プロセスが使用されない場合 `p` は、代わりに、お客様がまだ同意プロンプトに応答していないことを示す選択肢を使用できます。例えば、顧客が同意プロンプトに応答する前に、Web サイトの最初のページで値を `p` に自動的に設定できます。 明示的な同意を必要としない管轄区域では、それを使用して、顧客が明示的にオプトアウトしていない（つまり、同意が想定される）ことを示すこともできます。 |
| `u` | Unknown | お客様の同意情報または環境設定情報が不明です。 |
| `LI` | 正当な利益 | 特定の目的でこのデータを収集して処理する正当なビジネス上の利益は、個人に与える潜在的な害を上回ります。 |
| `CT` | 契約 | 特定の目的のデータを収集するには、個人との契約上の義務を果たす必要があります。 |
| `CP` | 法的義務の遵守 | 特定の目的のデータを収集するには、ビジネスの法的義務を満たす必要があります。 |
| `VI` | 個人の生き生きとした関心 | 特定の目的のためのデータの収集は、個人の重要な利益を保護するために必要です。 |
| `PI` | 公益 | 特定の目的のためのデータの収集は、公共の利益のためまたは公的な権限の行使のために、タスクを実行する必要があります。 |

{style=&quot;table-layout:auto&quot;}

### `preferred` に指定できる値 {#preferred-values}

次の表に、`preferred` で使用できる値の概要を示します。

| 値 | 説明 |
| --- | --- |
| `email` | 電子メール メッセージ。 |
| `push` | プッシュ通知. |
| `inApp` | アプリ内メッセージ. |
| `sms` | SMS メッセージ. |
| `phone` | 電話の操作。 |
| `phyMail` | 物理的なメール。 |
| `inVehicle` | 車載メッセージ。 |
| `inHome` | ホームメッセージ。 |
| `iot` | IoT メッセージのインターネット。 |
| `social` | ソーシャルメディアコンテンツ |
| `other` | 標準カテゴリに収まらないチャネル。 |
| `none` | 優先チャネルはありません。 |
| `unknown` | 優先チャネルが不明です。 |

{style=&quot;table-layout:auto&quot;}

### 完全な [!UICONTROL  同意と環境設定 ] スキーマ {#full-schema}

[!UICONTROL  同意と環境設定 ] データ型の完全なスキーマを表示するには、[ 公式の XDM リポジトリ ](https://github.com/adobe/xdm/blob/master/components/datatypes/consent/consent-preferences.schema.json) を参照してください。
