---
keywords: Experience Platform；プロファイル；リアルタイム顧客プロファイル；トラブルシューティング；API；同意；同意；環境設定；privacyOptOuts;marketingPreferences;optOutType;basisOfProcessing；同意；同意
title: 同意および環境設定のデータタイプ
description: プライバシー、パーソナライゼーション、マーケティング環境設定に関する同意のデータ型は、お客様のデータ操作から、CMP（同意管理プラットフォーム）およびその他のソースで生成される顧客の権限と設定を収集できるようにするものです。
topic-legacy: guide
exl-id: cdcc7b04-eeb9-40d3-b0b5-f736a5472621
source-git-commit: 65ad76bb4a5318b03d79d68d3c7e030d7878cf30
workflow-type: tm+mt
source-wordcount: '2058'
ht-degree: 2%

---

# [!UICONTROL 同意および環境設定] データタイプ

この [!UICONTROL プライバシー、パーソナライゼーションおよびマーケティング環境設定に対する同意] データタイプ ( 以下、「[!UICONTROL 同意および環境設定] data type&quot;) は [!DNL Experience Data Model] (XDM) データ型。顧客の権限と設定の収集をサポートすることを目的としています。このデータ型は、同意管理プラットフォーム (CMP) および他のデータ操作元によって生成されます。

このドキュメントでは、 [!UICONTROL 同意および環境設定] データタイプ。

## 前提条件 {#prerequisites}

このドキュメントでは、XDM と、 [!DNL Experience Platform]. 続行する前に、次のドキュメントを確認してください。

* [XDM システムの概要](https://www.adobe.com/go/xdm-home-en)
* [スキーマ構成の基本](https://www.adobe.com/go/xdm-schema-best-practices-en)

## データタイプの構造 {#structure}

>[!IMPORTANT]
>
>この [!UICONTROL 同意および環境設定] データタイプは、同意および環境設定管理の幅広い使用例に対応するように設計されています。 その結果、このドキュメントでは、データ型のフィールドの一般的な使用方法について説明し、これらのフィールドの使用方法を解釈する方法についての提案のみを行います。 データタイプの構造を、組織がこれらの同意や好みの選択をどのように解釈し、顧客に提示するかに合わせるには、プライバシー法務チームに相談してください。

この [!UICONTROL 同意および環境設定] データタイプは、キャプチャするために使用するいくつかのフィールドを提供します **同意** および **設定** 情報。

同意とは、顧客がデータの使用方法を指定できるオプションです。 ほとんどの同意は法的側面を持ち、特定の方法でデータを使用するには、一部の地域で許可を得る必要があります。また、肯定的な同意が不要な場合は、お客様にその使用を停止する（オプトアウトする）オプションが必要です。

環境設定とは、顧客がブランドに関するエクスペリエンスの様々な側面を処理する方法を指定できるオプションです。 これらは、次の 2 つのカテゴリに分類されます。

* **パーソナライゼーション環境設定**:顧客に提供されるエクスペリエンスをブランドがパーソナライズする方法に関する環境設定。
* **マーケティング環境設定**:ブランドが様々なチャネルを通じて顧客との連絡を許可されるかどうかに関する環境設定。

次のスクリーンショットは、データタイプの構造が Platform UI でどのように表されるかを示しています。

![](../images/data-types/consents.png)

>[!TIP]
>
>詳しくは、 [XDM リソースの調査](../ui/explore.md) を参照して、XDM リソースを検索し、Platform UI でその構造を調べる手順を確認してください。

次の JSON は、 [!UICONTROL 同意および環境設定] データタイプを処理できます。 これらの各フィールドの具体的な使用方法に関する情報は、以降の節で説明します。

```json
{
  "consents": {
    "collect": {
      "val": "VI",
    },
    "adID": {
      "idType": "IDFA",
      "val": "y"
    },
    "share": {
      "val": "y",
    },
    "personalize": {
      "content": {
        "val": "y"
      }
    },
    "marketing": {
      "preferred": "email",
      "any": {
        "val": "u"
      },
      "push": {
        "val": "n",
        "reason": "Too Frequent",
        "time": "2019-01-01T15:52:25+00:00"
      }
    },
    "metadata": {
      "time": "2019-01-01T15:52:25+00:00"
    }
  }
}
```

>[!TIP]
>
>顧客の同意と環境設定データのマッピング方法を視覚化するのに役立つ、Experience Platformで定義した任意の XDM スキーマのサンプル JSON データを生成できます。 詳しくは、次のドキュメントを参照してください。
>
>* [UI でのサンプルデータの生成](../ui/sample.md)
>* [API でサンプルデータを生成する](../api/sample-data.md)


## `consents` {#choices}

`consents` には、顧客の同意および環境設定を説明する複数のフィールドが含まれています。 これらのフィールドについて、以下のサブセクションで詳しく説明します。

```json
"consents": {
  "collect": {
    "val": "VI",
  },
  "adID": {
    "idType": "IDFA",
    "val": "y"
  },
  "share": {
    "val": "y",
  },
  "personalize": {
    "content": {
      "val": "y"
    }
  },
  "marketing": {
    "preferred": "email",
    "any": {
      "val": "u"
    },
    "email": {
      "val": "n",
      "reason": "Too Frequent",
      "time": "2019-01-01T15:52:25+00:00"
    }
  }
}
```

### `collect`

`collect` は、データを収集することに対する顧客の同意を表します。

```json
"collect": {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | この使用例に対する、お客様が指定した同意の選択。 詳しくは、 [付録](#choice-values) を参照してください。 |

{style=&quot;table-layout:auto&quot;}

### `adID`

`adID` は、広告主 ID を使用してこのデバイス上のアプリをまたいで顧客をリンクできるかどうかに関する顧客の同意を表します。

```json
"adID": {
  "idType": "IDFA",
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `idType` | 広告 ID タイプ。 `IDFA` (Apple広告主 ID または `GAID` (Google広告主 ID の場合 )。Android 広告主 ID(AAID) とも呼ばれます。 |
| `val` | この使用例に対する、お客様が指定した同意の選択。 詳しくは、 [付録](#choice-values) を参照してください。 |

{style=&quot;table-layout:auto&quot;}

### `share`

`share` は、データをセカンドパーティと共有（またはセカンドパーティに販売）できるかどうかに関する顧客の同意を表します。

```json
"share": {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | この使用例に対する、お客様が指定した同意の選択。 詳しくは、 [付録](#choice-values) を参照してください。 |

{style=&quot;table-layout:auto&quot;}

### `personalize` {#personalize}

`personalize` では、顧客のデータをパーソナライゼーションに使用できる方法に関する顧客の環境設定をキャプチャします。 顧客は、特定のパーソナライゼーションの使用例からオプトアウトしたり、完全にパーソナライゼーションをオプトアウトしたりできます。

>[!IMPORTANT]
>
>`personalize` では、マーケティングの使用例は扱っていません。 例えば、すべてのチャネルのパーソナライゼーションをオプトアウトした顧客は、これらのチャネルを介したコミュニケーションの受信を停止しないでください。 代わりに、受信するメッセージは、プロファイルに基づくものではなく、汎用的なものにする必要があります。
>
>同じ例で、顧客が（を通じて）すべてのチャネルのダイレクトマーケティングからオプトアウトした場合 `marketing`( [次のセクション](#marketing)) の場合、パーソナライゼーションが許可されていても、顧客はメッセージを受け取らないはずです。

```json
"personalize": {
  "content": {
    "val": "y",
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `content` | Web サイトまたはアプリケーション上で、パーソナライズされたコンテンツに対する顧客の環境設定を表します。 |
| `val` | 指定した使用例に対する、お客様が指定したパーソナライゼーションの環境設定。 お客様が同意を求められる必要がない場合は、このフィールドの値に、パーソナライゼーションをおこなう基準を示す必要があります。 詳しくは、 [付録](#choice-values) を参照してください。 |

{style=&quot;table-layout:auto&quot;}

### `marketing` {#marketing}

`marketing` は、データが使用できるマーケティング目的に関する顧客の環境設定をキャプチャします。 顧客は、特定のマーケティングの使用例をオプトアウトしたり、ダイレクトマーケティング全体をオプトアウトしたりできます。

```json
"marketing": {
  "preferred": "email",
  "any": {
    "val": "u"
  },
  "email": {
    "val": "n",
    "reason": "Too Frequent"
  },
  "push": {
    "val": "y"
  },
  "sms": {
    "val": "y"
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `preferred` | 顧客が通信を受信する際に優先するチャネルを示します。 詳しくは、 [付録](#preferred-values) を参照してください。 |
| `any` | ダイレクトマーケティング全体に関する顧客の環境設定を表します。 このフィールドで指定される同意の環境設定は、以下で提供される追加のサブフィールドによって上書きされない限り、あらゆるマーケティングチャネルに対する「デフォルト」の設定と見なされます。 `marketing`. より詳細な同意オプションを使用する予定がある場合は、このフィールドを除外することをお勧めします。<br><br>値が `n`を指定しない場合は、それ以上具体的なパーソナライゼーション設定はすべて無視する必要があります。 値が `y`の場合は、より詳細なパーソナライゼーションオプションもすべて、 `y`( 明示的にが `n`. 値が設定されていない場合、各パーソナライゼーションオプションの値は、指定されたとおりに扱われます。 |
| `email` | 顧客が電子メールメッセージの受信に同意するかどうかを示します。 |
| `push` | 顧客がプッシュ通知の受信を許可しているかどうかを示します。 |
| `sms` | 顧客がテキストメッセージの受信に同意するかどうかを示します。 |
| `val` | 指定した使用例に対する、お客様が指定した環境設定。 顧客が同意を求めるプロンプトを表示しない場合、このフィールドの値は、マーケティング使用例を実行する基準を示す必要があります。 詳しくは、 [付録](#choice-values) を参照してください。 |
| `time` | マーケティング環境設定が変更されたときの ISO 8601 タイムスタンプ（該当する場合）。 個々の環境設定のタイムスタンプが、以下で指定したタイムスタンプと同じ場合に注意してください。 `metadata`の場合、このフィールドはその環境設定では設定されません。 |
| `reason` | 顧客がマーケティングの使用例からオプトアウトした場合、この文字列フィールドは、顧客がオプトアウトした理由を表します。 |

{style=&quot;table-layout:auto&quot;}

### `metadata`

`metadata` は、顧客の同意と環境設定に関する一般的なメタデータを最後に更新されたたびにキャプチャします。

```json
"metadata": {
  "time": "2019-01-01T15:52:25+00:00",
}
```

| プロパティ | 説明 |
| --- | --- |
| `time` | 顧客の同意および環境設定が最後に更新された時点の ISO 8601 タイムスタンプ。 このフィールドは、負荷と複雑さを軽減するために、個々の環境設定にタイムスタンプを適用する代わりに使用できます。 の指定 `time` 個々の環境設定の値が `metadata` 特定の環境設定のタイムスタンプ。 |

{style=&quot;table-layout:auto&quot;}

## データタイプを使用したデータの取り込み {#ingest}

を使用するには、 [!UICONTROL 同意および環境設定] データタイプを使用して顧客から同意データを取り込むには、そのデータタイプを含むスキーマに基づいてデータセットを作成する必要があります。

に関するチュートリアルを参照してください。 [UI でのスキーマの作成](https://www.adobe.com/go/xdm-schema-editor-tutorial-en) を参照してください。 以下の手順で、 [!UICONTROL 同意および環境設定] データタイプについては、 [データセットの作成](../../catalog/datasets/user-guide.md#create) データセットユーザーガイドの手順に従って、既存のスキーマを使用してデータセットを作成します。

>[!IMPORTANT]
>
>に同意データを送信する場合 [!DNL Real-time Customer Profile]の場合、 [!DNL Profile]に基づいて有効化されるスキーマ [!DNL XDM Individual Profile] を含むクラス [!UICONTROL 同意および環境設定] データタイプ。 そのスキーマに基づいて作成するデータセットも有効にする必要があります [!DNL Profile]. 以下に関連する具体的な手順については、上記にリンクされているチュートリアルを参照してください。 [!DNL Real-time Customer Profile] スキーマとデータセットの要件。
>
>また、顧客プロファイルを正しく更新するために、最新の同意データと環境設定データを含むデータセットを優先するように結合ポリシーが設定されていることを確認する必要があります。 概要については、 [結合ポリシー](../../rtcdp/profile/merge-policies.md) を参照してください。

## 同意と環境設定の変更の処理

顧客が Web サイトでの同意や環境設定を変更した場合、その変更は [Adobe Experience Platform Web SDK](../../edge/consent/supporting-consent.md). 顧客がデータ収集をオプトアウトした場合、すべてのデータ収集は直ちに停止する必要があります。 顧客がパーソナライゼーションをオプトアウトした場合、訪問する次のページにパーソナライゼーションが存在しないはずです。

## 付録 {#appendix}

以下の節では、 [!UICONTROL 同意および環境設定] データタイプ。

### 指定できる値： `val` {#choice-values}

次の表に、 `val`:

| 値 | タイトル | 説明 |
| --- | --- | --- |
| `y` | はい（オプトイン） | お客様が同意または優先事項をオプトインしました。 つまり、 **do** 本件の同意または好みで示されたデータの使用に対する同意 |
| `n` | いいえ（オプトアウト） | お客様が同意または好みをオプトアウトしました。 つまり、 **しない** 本件の同意または好みで示されたデータの使用に対する同意 |
| `p` | 保留中の検証 | システムは、最終的な同意または設定値をまだ受け取っていません。 これは、2 段階の検証が必要な同意の一環として最も多く使用されます。 例えば、顧客が E メールの受信をオプトインした場合、その同意は `p` は、電子メール内のリンクを選択して、正しい電子メールアドレスが指定されていることを確認するまでです。その時点で、同意が次のように更新されます。 `y`.<br><br>この同意または環境設定で 2 つの検証プロセスが使用されない場合、 `p` 代わりに、お客様が同意プロンプトにまだ応答していないことを示すために、を使用できます。 例えば、 `p` 顧客が同意プロンプトに応答する前に、Web サイトの最初のページで 明示的な同意を必要としない管轄地域では、顧客が明示的にオプトアウトしていないことを示すためにも使用できます（つまり、同意が想定されます）。 |
| `u` | Unknown | お客様の同意または環境設定情報が不明です。 |
| `dy` | デフォルトはい（オプトイン） | 顧客がそれ自体に同意値を提供しておらず、デフォルトではオプトイン（「はい」）として扱われます。 つまり、同意は、お客様が別途指示するまで想定されます。<br><br>会社のプライバシーポリシーに関する法律や変更により、一部またはすべてのユーザーのデフォルトが変更された場合は、デフォルト値を含むすべてのプロファイルを手動で更新する必要があります。 |
| `dn` | デフォルトの「いいえ」（オプトアウト） | 顧客がそれ自体に同意値を提供しておらず、デフォルトでオプトアウト（「いいえ」）として扱われます。 つまり、お客様は別途指定するまで同意を拒否したものと見なされます。<br><br>会社のプライバシーポリシーに関する法律や変更により、一部またはすべてのユーザーのデフォルトが変更された場合は、デフォルト値を含むすべてのプロファイルを手動で更新する必要があります。 |
| `LI` | 正当な利益 | 特定の目的に合わせてこのデータを収集して処理する正当なビジネス上の関心は、個人に与える潜在的な害を上回ります。 |
| `CT` | 契約 | 個人との契約上の義務を果たすには、指定した目的のデータの収集が必要です。 |
| `CP` | 法的義務の遵守 | 特定の目的のデータを収集するには、ビジネスの法的義務を満たす必要があります。 |
| `VI` | 個人の生命の関心 | 特定の目的のためのデータの収集は、個人の重要な利益を保護するために必要です。 |
| `PI` | 公益 | 特定の目的のためのデータの収集は、公益上のタスクを実行するか、公的な権限の行使に必要です。 |

{style=&quot;table-layout:auto&quot;}

### 指定できる値： `preferred` {#preferred-values}

次の表に、 `preferred`:

| 値 | 説明 |
| --- | --- |
| `email` | 電子メール メッセージ。 |
| `push` | プッシュ通知. |
| `inApp` | アプリ内メッセージ. |
| `sms` | SMS メッセージ. |
| `phone` | 電話インタラクション。 |
| `phyMail` | 物理的な郵便。 |
| `inVehicle` | 車内メッセージ。 |
| `inHome` | 家庭内メッセージ |
| `iot` | 物のインターネット (IoT) メッセージ。 |
| `social` | ソーシャルメディアコンテンツ。 |
| `other` | 標準カテゴリに適合しないチャネル。 |
| `none` | 優先チャネルがありません。 |
| `unknown` | 優先チャネルが不明です。 |

{style=&quot;table-layout:auto&quot;}

### 完全 [!UICONTROL 同意および環境設定] スキーマ {#full-schema}

の完全なスキーマを表示するには、以下を実行します。 [!UICONTROL 同意および環境設定] データタイプ ( [公式 XDM リポジトリ](https://github.com/adobe/xdm/blob/master/components/datatypes/consent/consent-preferences.schema.json).
