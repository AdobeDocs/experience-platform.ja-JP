---
keywords: Experience Platform；プロファイル；リアルタイム顧客プロファイル；トラブルシューティング；API；同意；同意；環境設定；環境設定；privacyOptOuts;marketingPreferences;optOutType;basisOfProcessing；同意；同意
title: 同意および環境設定データタイプ
description: プライバシー、Personalization、マーケティング環境設定に対する同意データタイプは、Consent Management Platform （CMP）やその他のソースによってデータ操作から生成された顧客の権限と環境設定の収集をサポートするためのものです。
exl-id: cdcc7b04-eeb9-40d3-b0b5-f736a5472621
source-git-commit: fded2f25f76e396cd49702431fa40e8e4521ebf8
workflow-type: tm+mt
source-wordcount: '2334'
ht-degree: 1%

---

# [!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプ

[!UICONTROL &#x200B; プライバシー、Personalization、マーケティング環境設定に対する同意 &#x200B;] データタイプ（以下「同意と環境設定  データタイプ  と呼ばれます）は、Consent Management Platform （CMP）やその他のソースがデータ操作から生成した顧客権限および環境設定の収集をサポートすることを目的とした [!DNL Experience Data Model] （XDM）データタイプです。

このドキュメントでは、[!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプで提供されるフィールドの構造と使用目的について説明します。

## 前提条件 {#prerequisites}

このドキュメントでは、XDM と [!DNL Experience Platform] でのスキーマの使用について、十分に理解している必要があります。 続行する前に、次のドキュメントを確認してください。

* [XDM システムの概要](https://experienceleague.adobe.com/docs/experience-platform/xdm/home.html?lang=ja)
* [スキーマ構成の基本](https://www.adobe.com/go/xdm-schema-best-practices-en)

## データタイプ構造 {#structure}

>[!IMPORTANT]
>
>[!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプは、同意および環境設定管理の様々なユースケースに対応するように設計されています。 そのため、このドキュメントでは、データタイプのフィールドの一般的な使用方法を説明し、これらのフィールドの使用方法をどのように解釈するかについての提案のみを行います。 プライバシー法務チームに問い合わせて、データタイプの構造を組織の解釈方法と整合させ、これらの同意と好みの選択を顧客に提示してください。

[!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプには、**同意** および **環境設定** 情報を取り込むために使用される複数のフィールドが用意されています。

同意とは、顧客がデータの使用方法を指定できるオプションです。 同意の多くには法的側面があり、一部の管轄区域では、特定の方法でデータを使用する前に許可を得る必要があります。または、肯定的な同意が必要ない場合は、顧客がその使用（オプトアウト）を停止するオプションを用意する必要があります。

環境設定とは、ブランドでのエクスペリエンスの様々な側面をどのように処理するべきかを顧客が指定できるオプションです。 これらは次の 2 つのカテゴリに分類されます。

* **Personalizationの環境設定**：お客様に提供するエクスペリエンスをブランドによってどのようにパーソナライズすべきかに関する環境設定。
* **マーケティング環境設定**：ブランドが様々なチャネルを通じて顧客に連絡できるようにするかどうかに関する環境設定。

次のスクリーンショットは、Experience Platform UI でデータタイプの構造がどのように表現されるかを示しています。

![](../images/data-types/consents.png)

>[!TIP]
>
>XDM リソースを検索し、Experience Platform UI でその構造を調べる手順については、[XDM リソースの調査 ](../ui/explore.md) に関するガイドを参照してください。

次の JSON は、[!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプが処理できるデータのタイプの例を示しています。 これらの各フィールドの具体的な使用方法については、以降の節で説明します。

```json
{
  "consents": {
    "collect": {
      "val": "VI",
    },
    "adID": {
      "idType": "IDFA",
      "val": "y"
    },
    "share": {
      "val": "y",
    },
    "personalize": {
      "content": {
        "val": "y"
      }
    },
    "marketing": {
      "preferred": "email",
      "any": {
        "val": "u"
      },
      "push": {
        "val": "n",
        "reason": "Too Frequent",
        "time": "2019-01-01T15:52:25+00:00"
      }
    },
    "metadata": {
      "time": "2019-01-01T15:52:25+00:00"
    }
  }
}
```

>[!TIP]
>
>顧客の同意データと環境設定データのマッピング方法を視覚化するために、Experience Platformで定義する XDM スキーマのサンプル JSON データを生成できます。 詳しくは、次のドキュメントを参照してください。
>
>* [UI でのサンプルデータの生成 ](../ui/sample.md)
>* [API でのサンプルデータの生成 ](../api/sample-data.md)

## `consents` {#choices}

顧客 `consents` 同意および環境設定を説明する複数のフィールドが含まれています。 これらのフィールドについては、以下のサブセクションで詳しく説明します。

```json
"consents": {
  "collect": {
    "val": "VI",
  },
  "adID": {
    "idType": "IDFA",
    "val": "y"
  },
  "share": {
    "val": "y",
  },
  "personalize": {
    "content": {
      "val": "y"
    }
  },
  "marketing": {
    "preferred": "email",
    "any": {
      "val": "u"
    },
    "email": {
      "val": "n",
      "reason": "Too Frequent",
      "time": "2019-01-01T15:52:25+00:00"
    }
  }
}
```

### `collect`

`collect` は、顧客のデータ収集に対する同意を表します。

```json
"collect": {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | このユースケースでは、お客様から提供された同意の選択肢。 使用できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |

{style="table-layout:auto"}

### `adID`

`adID` は、広告主 ID を使用してこのデバイス上のアプリ間で顧客をリンクできるかどうかに対する顧客の同意を表します。

```json
"adID": {
  "idType": "IDFA",
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `idType` | 広告 ID タイプは、Appleの広告主 ID の場合は `IDFA`、Googleの広告主 ID の場合は `GAID` です。Android広告主 ID （AAID）とも呼ばれます。 |
| `val` | このユースケースでは、お客様から提供された同意の選択肢。 使用できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |

{style="table-layout:auto"}

### `share`

`share` は、自社のデータをセカンドパーティまたはサードパーティと共有（またはセカンドパーティに販売）できるかどうかに対する顧客の同意を表します。

```json
"share": {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | このユースケースでは、お客様から提供された同意の選択肢。 使用できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |

{style="table-layout:auto"}

### `personalize` {#personalize}

`personalize` は、データをパーソナライゼーションに使用する方法に関するお客様の好みをキャプチャします。 顧客は、特定のパーソナライゼーションのユースケースをオプトアウトすることも、パーソナライゼーションを完全にオプトアウトすることもできます。

>[!IMPORTANT]
>
>`personalize` では、マーケティングのユースケースについては説明しません。 例えば、顧客がすべてのチャネルのパーソナライゼーションをオプトアウトしている場合、それらのチャネルを通じた通信の受信を停止しないでください。 むしろ、受信するメッセージは一般的で、プロファイルに基づくものであってはなりません。
>
>同じ例で、顧客がすべてのチャネルのダイレクトマーケティングを（`marketing` を通じて [ 次の節 ](#marketing) で説明するように）オプトアウトした場合、パーソナライゼーションが許可されていても、その顧客はメッセージを受け取るべきではありません。

```json
"personalize": {
  "content": {
    "val": "y",
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `content` | Web サイトまたはアプリケーション上のパーソナライズされたコンテンツに対する顧客の好みを表します。 |
| `val` | 指定したユースケースに対して顧客が指定したパーソナライゼーション環境設定。 顧客に同意を求めるプロンプトを表示する必要がない場合、このフィールドの値は、パーソナライゼーションを行う基準を示す必要があります。 使用できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |

{style="table-layout:auto"}

### `marketing` {#marketing}

データ `marketing` 使用できるマーケティング目的に関するお客様の環境設定をキャプチャします。 顧客は、特定のマーケティングのユースケースをオプトアウトすることも、ダイレクトマーケティングを完全にオプトアウトすることもできます。

```json
"marketing": {
  "preferred": "email",
  "any": {
    "val": "u"
  },
  "email": {
    "val": "n",
    "reason": "Too Frequent"
  },
  "push": {
    "val": "y"
  },
  "sms": {
    "val": "y"
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `preferred` | 通信を受信するための顧客の優先チャネルを示します。 使用可能な値については、[ 付録 ](#preferred-values) を参照してください。 |
| `any` | ダイレクトマーケティング全体に対する顧客の好みを表します。 このフィールドで指定された同意環境設定は、`marketing` で提供される追加のサブフィールドによって上書きされない限り、マーケティングチャネルの「デフォルト」環境設定と見なされます。 より詳細な同意オプションを使用する予定がある場合は、このフィールドを除外することをお勧めします。<br><br> 値が `n` に設定されている場合、より具体的なパーソナライゼーション設定はすべて無視する必要があります。 値が `y` に設定されている場合、明示的に `n` に設定されていない限り、より詳細なパーソナライゼーションオプションもすべて `y` として扱う必要があります。 値を設定していない場合、各パーソナライゼーションオプションの値が指定されたとおりに適用されます。 |
| `email` | 顧客が電子メールメッセージの受信に同意するかどうかを示します。 |
| `push` | 顧客がプッシュ通知の受信を許可しているかどうかを示します。 |
| `sms` | 顧客がテキストメッセージの受信に同意するかどうかを示します。 |
| `val` | 指定したユースケースに対してお客様が指定した環境設定。 顧客に同意の入力を促すプロンプトを表示する必要がない場合、このフィールドの値は、マーケティングユースケースを実行する基準を示す必要があります。 使用できる値と定義については、[ 付録 ](#choice-values) を参照してください。 |
| `time` | マーケティング環境設定が変更された際の ISO 8601 タイムスタンプ（該当する場合）。 個々の環境設定のタイムスタンプが `metadata` で指定したタイムスタンプと同じ場合、このフィールドはその環境設定に対しては設定されません。 |
| `reason` | 顧客がマーケティングユースケースをオプトアウトする場合、この文字列フィールドは、顧客がオプトアウトした理由を表します。 |

{style="table-layout:auto"}

### `metadata`

`metadata` は、顧客の同意および環境設定に関する一般的なメタデータを、最後に更新されるたびにキャプチャします。

```json
"metadata": {
  "time": "2019-01-01T15:52:25+00:00",
}
```

| プロパティ | 説明 |
| --- | --- |
| `time` | お客様の同意および環境設定が最後に更新されたときの ISO 8601 タイムスタンプ。 負荷と複雑さを軽減するために、個々の環境設定にタイムスタンプを適用する代わりに、このフィールドを使用できます。 個々の環境設定で `time` 値を指定すると、その特定の環境設定の `metadata` タイムスタンプが上書きされます。 |

{style="table-layout:auto"}

## データタイプを使用したデータの取り込み {#ingest}

[!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプを使用して顧客から同意データを取り込むには、そのデータタイプを含むスキーマに基づいてデータセットを作成する必要があります。

フィールドにデータタイプを割り当てる手順については、[UI でのスキーマの作成 ](https://www.adobe.com/go/xdm-schema-editor-tutorial-en_jp) に関するチュートリアルを参照してください。 [!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプを持つフィールドを含むスキーマを作成したら、既存のスキーマを使用してデータセットを作成する手順に従って、データセットユーザーガイドの [ データセットの作成 ](../../catalog/datasets/user-guide.md#create) の節を参照してください。

>[!IMPORTANT]
>
>同意データを [!DNL Real-Time Customer Profile] に送信する場合は、[!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプを含む [!DNL XDM Individual Profile] クラスに基づいて [!DNL Profile] 対応スキーマを作成する必要があります。 そのスキーマに基づいて作成したデータセットも、[!DNL Profile] 用に有効にする必要があります。 スキーマとデータセットの要件に関連する特定の手順については [!DNL Real-Time Customer Profile] 上記にリンクされたチュートリアルを参照してください。
>
>また、顧客プロファイルを正しく更新するには、最新の同意データと環境設定データを含むデータセットに優先順位を付けるように結合ポリシーが設定されていることを確認する必要があります。 詳しくは、[ 結合ポリシー ](../../rtcdp/profile/merge-policies.md) の概要を参照してください。

## 同意および環境設定の変更の処理

お客様が web サイトに対する同意や環境設定を変更した場合は、変更内容を収集し、[Adobe Experience Platform web SDK](../../web-sdk/commands/setconsent.md) を使用して直ちに適用する必要があります。 お客様がデータ収集をオプトアウトした場合、すべてのデータ収集は直ちに停止する必要があります。 顧客がパーソナライゼーションをオプトアウトする場合、訪問する次のページにはパーソナライゼーションが存在しないはずです。

## 付録 {#appendix}

以下の節では、[!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプに関する追加の参照情報を提供します。

### `val` の許容値 {#choice-values}

次の表に、`val` の許容値の概要を示します。

| 値 | タイトル | 説明 |
| --- | --- | --- |
| `y` | はい（オプトイン） | 顧客が同意または好みに対してオプトインした。 つまり、当該の同意または好みによって示されたデータの使用に同意する **行う** ということです。 |
| `n` | いいえ（オプトアウト） | お客様が同意または好みをオプトアウトしている。 つまり、当該の同意または好みによって示されたデータの使用に同意する **同意しない** ということです。 |
| `p` | 確認待ち | システムはまだ最終的な同意または優先順位値を受け取っていません。 これは、2 段階認証を必要とする同意の一部として最もよく使用されます。 例えば、顧客がメールの受信をオプトインした場合、メール内のリンクを選択して正しいメールアドレスを指定したことを確認するまで、同意は `p` に設定され、その時点で同意は `y` に更新されます。<br><br> この同意または環境設定で 2 段階の検証プロセスが使用されない場合は、代わりに、お客様が同意プロンプトにまだ応答していないことを示すために、`p` の選択を使用できます。 例えば、顧客が同意プロンプトに応答する前に、web サイトの最初のページで値を自動的に `p` に設定できます。 明示的な同意を必要としない法域では、顧客が明示的にオプトアウトしていない（つまり、同意が想定されている）ことを示すために使用する場合もあります。<br><br> この値は、ストリーミング取得などの他のメカニズムを使用して [!DNL Profile] で取得することもできますが、[!DNL Edge Network] でのデータ収集や同意収集では **サポートされていません**。 `p` の値を明示的に送信することはできませんが、イベントキューは引き続き [[!DNL Web SDK]](../../landing/governance-privacy-security/consent/sdk.md) で処理され、エンドユーザーの同意が明示的に `in` 定されると、イベントは [!DNL Edge Network] にディスパッチされます。 |
| `u` | 不明 | 顧客の同意または好みの情報が不明です。 |
| `dy` | デフォルトは「はい」（オプトイン） | 顧客が自身で同意値を指定しておらず、デフォルトではオプトイン（「はい」）として扱われます。 つまり、顧客が別の指定をしない限り、同意が想定されます。<br><br> 法律や会社のプライバシーポリシーの変更により、一部またはすべてのユーザーのデフォルトが変更される場合は、デフォルト値を含むすべてのプロファイルを手動で更新する必要があります。 |
| `dn` | デフォルトの「いいえ」（オプトアウト） | 顧客が自身で同意値を指定しておらず、デフォルトではオプトアウトとして扱われます（「いいえ」）。 つまり、お客様が同意を拒否した場合は、その旨を明示するまでは、同意を拒否したものと見なされます。<br><br> 法律や会社のプライバシーポリシーの変更により、一部またはすべてのユーザーのデフォルトが変更される場合は、デフォルト値を含むすべてのプロファイルを手動で更新する必要があります。 |
| `LI` | 正当な利益 | 特定目的のためにこのデータを収集して処理する正当なビジネス上の利益は、個人に与える潜在的な害を上回ります。 |
| `CT` | 契約 | 特定の目的のためのデータの収集は、個人との契約上の義務を満たすために必要です。 |
| `CP` | 法的義務の遵守 | 特定目的のためのデータの収集は、ビジネスの法的義務を満たすために必要です。 |
| `VI` | 個人の極めて重要な関心 | 特定目的のデータ収集は、個人の重要な利益を保護するために必要です。 |
| `PI` | 公共の利益 | 特定の目的のためのデータの収集は、公共の利益または公権力の行使のタスクを実行するために必要です。 |

{style="table-layout:auto"}

### `preferred` の許容値 {#preferred-values}

次の表に、`preferred` の許容値の概要を示します。 `preferred` の値は、データ収集、プライバシーポリシー、パーソナライゼーションオプションに関する情報を顧客に提供する、顧客の通信受信用の優先チャネルを示します。

| 値 | 説明 |
| --- | --- |
| `email` | この環境設定は、メールでメッセージを受信することに対する顧客の同意を示します。 |
| `push` | この環境設定は、プッシュ通知を受信する顧客の同意を示します。 これらは、デバイス（多くの場合、モバイルアプリケーション）に直接送信されるメッセージまたはアラートです。 |
| `inApp` | この環境設定は、アプリ内メッセージを受信することに対する顧客の同意を示します。 これらのメッセージは、モバイルまたは web アプリケーション内で配信され、ユーザーがアプリに積極的に関与している間に情報を提供します。 |
| `sms` | この環境設定は、SMS （ショートメッセージサービス）を介してメッセージを受信することに対する顧客の同意を示します。 これらは、携帯電話に送信されるテキストメッセージです。 |
| `phone` | この環境設定は、電話でのインタラクションを通じて通信を受信することに対する顧客の同意を示します。 |
| `phyMail` | この環境設定は、物理的な郵便で資料を受け取ることに対するお客様の同意を示します。 |
| `inVehicle` | この環境設定は、車内で通知を受け取ることに対する顧客の同意を示します。 これらのメッセージは、車両インフォテインメントシステムやその他の車載通信チャネルを通じて配信される場合があります。 |
| `inHome` | この環境設定は、顧客が自宅でメッセージを受信することに同意していることを示します。 これらのメッセージは、スマートホームデバイスやその他のホームベースの通信チャネルを介して配信される場合があります。 |
| `iot` | この環境設定は、モノのインターネット（IoT）に関連するメッセージを受信することへの顧客の同意を表します。 これらのメッセージは、環境内の接続されたデバイスやシステムを介して配信される場合があります。 |
| `social` | この環境設定は、ソーシャルメディアプラットフォームを通じて通信を受信することに対する顧客の同意を示します。 |
| `other` | この環境設定には、標準カテゴリに当てはまらないチャネルが含まれます。 特定のビジネスや業界に固有の代替または特殊なコミュニケーションチャネルを表します。 |
| `none` | この環境設定は、顧客が優先通信チャネルを持っていないことを示しています。 |
| `unknown` | この環境設定は、顧客の優先通信チャネルが不明であるか、指定されていないことを示します。 これは、顧客が明示的な同意や好みの情報を提供していない場合に発生する可能性があります。 |

{style="table-layout:auto"}

### フル [!UICONTROL &#x200B; 同意および環境設定 &#x200B;] スキーマ {#full-schema}

[!UICONTROL &#x200B; 同意および環境設定 &#x200B;] データタイプの完全なスキーマを表示するには、[ 公式 XDM リポジトリ ](https://github.com/adobe/xdm/blob/master/components/datatypes/consent/consent-preferences.schema.json) を参照してください。
