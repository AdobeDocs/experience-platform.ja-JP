---
keywords: Experience Platform;プロファイル；リアルタイム顧客プロファイル；トラブルシューティング；API；同意；環境設定；Preferences;privacyOptOuts;marketingPreferences;optOutType;basisOfProcessing;consent;Consent
title: 同意と環境設定のデータタイプ
description: 「プライバシー/マーケティングの環境設定（同意）」データ型は、データ操作から、Consent Management Platforms(CMP)や他のソースによって生成される顧客の権限や好みの収集をサポートすることを目的としています。
topic: guide
translation-type: tm+mt
source-git-commit: 10ccccf72ff7a2fd726066332b9771dff1929af6
workflow-type: tm+mt
source-wordcount: '2040'
ht-degree: 1%

---


# [!DNL Consents & Preferences] データ型

[!DNL Privacy/Marketing Preferences (Consent)]データ型（以下「[!DNL Consents & Preferences]データ型」と呼びます）は、データ操作からConsent Management Platforms(CMP)や他のソースで生成される顧客の権限や好みの収集をサポートする[!DNL Experience Data Model](XDM)データ型です。

このドキュメントでは、[!DNL Consents & Preferences]データ型が提供するフィールドの構造と使用目的について説明します。

## 前提条件 {#prerequisites}

このドキュメントでは、XDMと[!DNL Experience Platform]でのスキーマの使用に関する十分な理解が必要です。 先に進む前に、次のドキュメントを確認してください。

* [XDM システムの概要](http://www.adobe.com/go/xdm-home-en)
* [スキーマ構成の基本](http://www.adobe.com/go/xdm-schema-best-practices-en)

## データタイプ構造{#structure}

>[!IMPORTANT]
>
>[!DNL Consents & Preferences]データ型は、同意および優先管理の用途を網羅するように設計されています。 その結果、このドキュメントでは、データ型のフィールドの一般的な使用方法について説明し、これらのフィールドの使用をどのように解釈すべきかについての提案のみを行います。 データタイプの構造と、組織がこれらの同意や好みの選択をどのように解釈し、顧客に提示するかを調整するには、プライバシー法務チームにお問い合わせください。

[!DNL Consents & Preferences]データ型は、**同意**&#x200B;と&#x200B;**環境設定**&#x200B;の情報を取り込むために使用するいくつかのフィールドを提供します。

同意とは、顧客が自分のデータの使用方法を指定できるオプションです。 ほとんどの同意は法的側面を持ちます。管轄区域によっては、特定の方法でデータを使用する前に許可を取得する必要がある場合や、肯定的な同意が必要でない場合は、その使用を停止するオプション(オプトアウト)を持つ必要がある場合があります。

プリファレンスとは、ブランドに関するエクスペリエンスの様々な側面を顧客がどのように扱うべきかを指定できるオプションです。 これらは2つのカテゴリ内にあります。

* **個人設定の環境設定**:ブランドが顧客に提供するエクスペリエンスをパーソナライズする方法に関する環境設定。
* **マーケティングの環境設定**:様々なチャネルを通じてブランドが顧客との接触を許可されるかどうかに関するプレファレンス。

次のJSONは、[!DNL Consents & Preferences]データ型で処理できるデータのタイプの例を示しています。 各フィールドの具体的な使用方法については、以降の節で説明します。

```json
{
  "xdm:consents": {
    "xdm:collect": {
      "xdm:val": "y",
    },
    "xdm:adID": {
      "xdm:val": "VI"
    },
    "xdm:share": {
      "xdm:val": "y",
    },
    "xdm:personalize": {
      "xdm:content": {
        "xdm:val": "y"
      }
    },
    "xdm:marketing": {
      "xdm:preferred": "email",
      "xdm:any": {
        "xdm:val": "u"
      },
      "xdm:push": {
        "xdm:val": "n",
        "xdm:reason": "Too Frequent",
        "xdm:time": "2019-01-01T15:52:25+00:00"
      }
    },
    "xdm:idSpecific": {
      "email": {
        "jdoe@example.com": {
          "xdm:marketing": {
            "xdm:email": {
              "xdm:val": "n"
            }
          }
        }
      }
    }
  },
  "xdm:metadata": {
    "xdm:time": "2019-01-01T15:52:25+00:00"
  }
}
```

>[!NOTE]
>
>上記の例は、[!DNL Consents & Preferences]データ型を介して[!DNL Platform]に送信されるデータの構造を示すためのもので、データ型が提供する主なフィールドを説明するこのドキュメントの残りの部分にコンテキストを与えるためのものです。 データ型の構造体の完全なスキーマは、参照用に[付録](#full-schema)にあります。

## xdm:consents {#choices}

`xdm:consents` には、顧客の同意と環境設定を説明する複数のフィールドが含まれています。これらのフィールドについて詳しくは、以下のサブセクションを参照してください。

```json
"xdm:consents": {
  "xdm:collect": {
    "xdm:val": "y",
  },
  "xdm:adID": {
    "xdm:val": "VI"
  },
  "xdm:share": {
    "xdm:val": "y",
  },
  "xdm:personalize": {
    "xdm:content": {
      "xdm:val": "y"
    }
  },
  "xdm:marketing": {
    "xdm:preferred": "email",
    "xdm:any": {
      "xdm:val": "u"
    },
    "xdm:email": {
      "xdm:val": "n",
      "xdm:reason": "Too Frequent",
      "xdm:time": "2019-01-01T15:52:25+00:00"
    }
  }
}
```

### xdm:collect

`xdm:collect` は、顧客がデータを収集することに同意したことを表します。

```json
"xdm:collect" : {
  "xdm:val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `xdm:val` | この使用事例に対するお客様提供の同意の選択。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |

### xdm:adID

`xdm:adID` は、広告主ID（IDFAまたはGAID）を使用して、このデバイス上のアプリ間で顧客をリンクできるかどうかに関する顧客の同意を表します。

```json
"xdm:adID" : {
  "xdm:val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `xdm:val` | この使用事例に対するお客様提供の同意の選択。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |

### xdm:share

`xdm:share` は、自社のデータを第2のパーティと共有（または第3のパーティと共有）できるか（または販売できるか）に関する顧客の同意を表します。

```json
"xdm:share" : {
  "xdm:val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `xdm:val` | この使用事例に対するお客様提供の同意の選択。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |

### xdm:personalize {#personalize}

`xdm:personalize` データをどのようにパーソナライズに使用できるかに関する顧客の環境設定を取得します。お客様は、特定オプトアウトのパーソナライゼーションの使用例を使用することも、パーソナライゼーションを完全オプトアウトに使用することもできます。

>[!IMPORTANT]
>
>`xdm:personalize` マーケティングの使用例は説明していません。例えば、すべてのチャネルに対してパーソナライゼーションをオプトアウトした場合、それらのチャネルを通じた通信の受信を停止しないでください。 その代わりに、メッセージの受信はプロファイルに基づくのではなく、汎用的なものにする必要があります。
>
>同じ例で、すべてのチャネル（`xdm:marketing`次のセクション](#marketing)で説明する[を通じて）のダイレクトマーケティングをオプトアウトする場合、パーソナライゼーションが許可されていても、顧客はメッセージを受け取らないでください。

```json
"xdm:personalize": {
  "xdm:content": {
    "xdm:val": "y",
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `xdm:content` | Webサイトやアプリケーション上でパーソナライズされたコンテンツを提供する、ユーザーの環境設定を表します。 |
| `xdm:val` | 指定した使用例に対する顧客が提供するパーソナライゼーション設定です。 顧客が同意を求められない場合は、このフィールドの値は、パーソナライゼーションを実行する基準を示す必要があります。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |

### xdm:marketing {#marketing}

`xdm:marketing` データを使用できるマーケティング目的に関する顧客の判断基準を取り込みます。特定オプトアウトのマーケティングの使用例や、完全なダイレクトマーケティングオプトアウトのお客様が考えられます。

```json
"xdm:marketing": {
  "xdm:preferred": "email",
  "xdm:any": {
    "xdm:val": "u"
  },
  "xdm:email": {
    "xdm:val": "n",
    "xdm:reason": "Too Frequent"
  },
  "xdm:push": {
    "xdm:val": "y"
  },
  "xdm:sms": {
    "xdm:val": "y"
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `xdm:preferred` | 顧客が好む通信チャネルを示します。 使用できる値については、[付録](#preferred-values)を参照してください。 |
| `xdm:any` | ダイレクトマーケティング全体に対する顧客の好みを表します。 `xdm:marketing`で提供される追加のサブフィールドによって上書きされない限り、このフィールドに指定される同意の優先順位は、すべてのマーケティングチャネルに対する「デフォルト」の優先順位と見なされます。 より詳細な同意オプションを使用する場合は、このフィールドを除外することをお勧めします。<br><br>この値をに設定した場合 `n`、それ以上の個別設定は無視する必要があります。値を`y`に設定した場合、`n`に明示的に設定しない限り、詳細なパーソナライゼーションオプションもすべて`y`として扱う必要があります。 値が設定されていない場合は、個々のパーソナライゼーションオプションの値を指定どおりに扱う必要があります。 |
| `xdm:email` | 顧客が電子メールメッセージの受信に同意するかどうかを示します。 |
| `xdm:push` | ユーザーがプッシュ通知の受信を許可しているかどうかを示します。 |
| `xdm:sms` | ユーザーがテキストメッセージの受信に同意するかどうかを示します。 |
| `xdm:val` | 指定した使用例に対する顧客が指定した基本設定です。 顧客が同意を促すように促す必要がない場合は、このフィールドの値はマーケティング使用事例の発生基準を示す必要があります。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |
| `xdm:time` | マーケティング環境設定が変更された時のISO 8601タイムスタンプ（該当する場合）。 個々の優先順位のタイムスタンプが`xdm:metadata`の下で提供されるタイムスタンプと同じ場合、その優先順位に対してこのフィールドは設定されません。 |
| `xdm:reason` | 顧客がマーケティングの使用事例からオプトアウトした場合、この文字列フィールドは、顧客がオプトアウトした理由を表します。 |

### xdm:idSpecific

`xdm:idSpecific` は、特定の同意または優先度が顧客に広く適用されるわけではなく、単一のデバイスまたはIDに限定される場合に使用できます。例えば、顧客はあるアドレス宛てオプトアウトの電子メールを受信できる一方、別のアドレス宛ての電子メールを受信できる可能性があります。

>[!IMPORTANT]
>
>チャネルレベルの同意と環境設定（`xdm:idSpecific`の外側に`xdm:consents`が提供する同意と環境設定）は、そのチャネル内のIDに適用されます。 したがって、チャネルレベルの同意事項や環境設定は、同等のIDやデバイス固有の設定が適用されるかどうかに関わらず、直接影響を受けます。
>
>* お客様がチャネルレベルでオプトアウトした場合、`xdm:idSpecific`の同等の同意または環境設定は無視されます。
>* チャネルレベルの同意または優先度が設定されていない場合、またはお客様がオプトインを選択した場合は、`xdm:idSpecific`の同等の同意または好みが使用されます。


`xdm:idSpecific`オブジェクトの各キーは、Adobe Experience PlatformIDサービスで認識される特定のID名前空間を表します。 様々なIDを分類する独自のカスタム名前空間を定義できますが、リアルタイム顧客プロファイルのストレージサイズを小さくするために、Identity Serviceが提供する標準名前空間の1つを使用することをお勧めします。 ID名前空間の詳細については、Identity Serviceドキュメントの[ID名前空間の概要](../../identity-service/namespaces.md)を参照してください。

各名前空間オブジェクトのキーは、ユーザーが環境設定を行った一意のID値を表します。 各ID値には、`xdm:consents`と同じ形式の完全な同意と環境設定を含めることができます。

```json
"xdm:idSpecific": {
  "email": {
    "jdoe@example.com": {
      "xdm:marketing": {
        "xdm:email": {
          "xdm:val": "n"
        }
      }
    }
  }
}
```

## xdm:metadata

`xdm:metadata` 顧客の同意と環境設定が最後に更新されたときに、その同意に関する一般的なメタデータを取り込みます。

```json
"xdm:metadata": {
  "xdm:time": "2019-01-01T15:52:25+00:00",
}
```

| プロパティ | 説明 |
| --- | --- |
| `xdm:time` | 顧客の同意および環境設定が最後に更新された時のタイムスタンプ。 読み込みと複雑さを軽減するために、個々の環境設定にタイムスタンプを適用する代わりに、このフィールドを使用できます。 個々の環境設定で`xdm:time`値を指定すると、その環境設定の`xdm:metadata`タイムスタンプよりも優先されます。 |

## データ型{#ingest}を使用したデータの取り込み

[!DNL Consents & Preferences]データ型を使用して顧客の同意データを取り込むには、そのデータ型を含むスキーマに基づいてデータセットを作成する必要があります。

フィールドにデータ型を割り当てる手順については、UI](http://www.adobe.com/go/xdm-schema-editor-tutorial-en)でのスキーマの作成に関するチュートリアルを参照してください。 [データタイプが[!DNL Consents & Preferences]のフィールドを含むスキーマーを作成したら、既存のスキーマーでデータセットを作成する手順に従って、『データセットユーザーガイド』の「[データセット](../../catalog/datasets/user-guide.md#create)の作成」の節を参照してください。

>[!IMPORTANT]
>
>[!DNL Real-time Customer Profile]に同意データを送信する場合は、[!DNL Consents & Preferences]データ型を含む[!DNL XDM Individual Profile]クラスに基づいて[!DNL Profile]対応スキーマを作成する必要があります。 そのスキーマに基づいて作成するデータセットも[!DNL Profile]に対して有効にする必要があります。 スキーマとデータセットの[!DNL Real-time Customer Profile]要件に関する具体的な手順については、上記のリンクを含むチュートリアルを参照してください。
>
>また、顧客プロファイルを正しく更新するために、最新の同意データと優先データを含むデータセットに優先順位を付けるようにマージポリシーを設定する必要もあります。 詳しくは、[マージポリシー](../../rtcdp/profile/merge-policies.md)の概要を参照してください。

## 同意と優先順位の変更の処理

お客様がWebサイトでの同意や環境設定を変更した場合は、[Adobe Experience PlatformWeb SDK](../../edge/consent/supporting-consent.md)を使用して、変更を収集し直ちに適用する必要があります。 顧客がデータ収集をオプトアウトした場合、すべてのデータ収集は直ちに停止する必要があります。 顧客がパーソナライゼーションをオプトアウトした場合、訪問者が次のページにパーソナライゼーションを表示しないでください。

## 付録 {#appendix}

以下の節では、[!DNL Consents & Preferences]データ型に関する追加情報を示します。

### xdm:val {#choice-values}に指定できる値

次の表に、`xdm:val`に使用できる値の概要を示します。

| 値 | タイトル | 説明 |
| --- | --- | --- |
| `y` | ○ | 顧客が同意または優先を選択しました。 つまり、****&#x200B;は、対象となる同意または好みで示されるデータの使用に同意します。 |
| `n` | × | 顧客が同意または好みをオプトアウトしました。 つまり、**は、対象となる同意や嗜好で示されるデータの使用に**&#x200B;同意しません。 |
| `p` | 検証待ち | システムは、最終同意または優先度の値をまだ受け取っていません。 これは、2段階の検証が必要な同意の一部として最もよく使用されます。 例えば、顧客が電子メールの受信を希望する場合、電子メール内のリンクを選択して正しい電子メールアドレスを入力したことを確認するまで、同意は`p`に設定され、その時点で`y`に更新されます。<br><br>この同意または優先順位で2つのセットによる検証プロセスを使用しない場合は、代わりに `p` 選択肢を使用して、顧客がまだ同意プロンプトに応答していないことを示すことができます。例えば、顧客が同意プロンプトに応答する前に、Webサイトの最初のページで値を自動的に`p`に設定できます。 明示的な同意を必要としない管轄区域では、顧客が明示的にオプトアウトしないことを示す（つまり、同意が前提となる）場合にも使用できます。 |
| `u` | Unknown | 顧客の同意または嗜好情報が不明です。 |
| `LI` | 正当な利益 | 特定の目的でこのデータを収集して処理する正当なビジネス上の関心事は、個人に与える潜在的な損害を上回ります。 |
| `CT` | 契約 | 特定の目的に応じたデータの収集は、個人との契約上の義務を満たすために必要です。 |
| `CP` | 法的義務の遵守 | 特定の目的に対するデータの収集は、ビジネスの法的義務を満たすために必要です。 |
| `VI` | 個人の極めて重要な関心 | 特定の目的に合わせたデータの収集は、個人の重要な利益を保護するために必要です。 |
| `PI` | 公益 | 特定の目的に係るデータの収集は、公益上のタスク又は職権の行使上の行為に必要とされる。 |

### xdm:preferred {#preferred-values}に指定できる値

次の表に、`xdm:preferred`に使用できる値の概要を示します。

| 値 | 説明 |
| --- | --- |
| `email` | 電子メールメッセージ。 |
| `push` | プッシュ通知. |
| `inApp` | アプリ内メッセージ. |
| `sms` | SMSメッセージ。 |
| `phone` | 電話のインタラクション数。 |
| `phyMail` | 物理的なメール。 |
| `inVehicle` | 車内メッセージ。 |
| `inHome` | ホームメッセージ。 |
| `iot` | インターネット(IoT)メッセージ。 |
| `social` | ソーシャルメディアコンテンツ。 |
| `other` | 標準のカテゴリに適合しないチャネルです。 |
| `none` | 優先するチャネルはありません。 |
| `unknown` | 優先チャネルが不明です。 |

### 完全な[!DNL Consents & Preferences]スキーマ{#full-schema}

[!DNL Consents & Preferences]データ型の完全なスキーマを表示するには、[正式なXDMリポジトリ](https://github.com/adobe/xdm/blob/master/components/datatypes/consent-preferences.schema.json)を参照してください。
