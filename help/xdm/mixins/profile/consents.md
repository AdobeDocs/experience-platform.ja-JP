---
solution: Experience Platform
title: プライバシー/パーソナライゼーション/マーケティングの環境設定（同意） Mixin
topic: overview
description: このドキュメントでは、プライバシー/パーソナライゼーション/マーケティングの環境設定（同意）ミックスインの概要を説明します。
translation-type: tm+mt
source-git-commit: 8c5ab298bad69305358ae961ebaf7836a90a0eaa
workflow-type: tm+mt
source-wordcount: '2256'
ht-degree: 1%

---


# [!UICONTROL プライバシー/パーソナライゼーション/マーケティングの環境設定（同意）] mixin

[!UICONTROL 「プライバシー/パーソナライゼーション/マーケティングの環境設定（同意）」] (以下「 [!DNL Privacy & Consents] ミックスイン」と呼ばれる)は、ク [[!DNL XDM Individual Profile] ](../../classes/individual-profile.md)ラスの標準ミックスインで、顧客の同意と嗜好情報を取り込むために使用されます。

>[!NOTE]
>
>このミックスインは[!DNL XDM Individual Profile]とのみ互換性があるので、[!DNL XDM ExperienceEvent]スキーマには使用できません。 エクスペリエンスイベントスキーマに同意と好みのデータを含める場合は、代わりに[カスタムmixin](../../ui/resources/mixins.md#create)を使用して、スキーマに[[!UICONTROL プライバシー、パーソナライゼーション、マーケティングの環境設定の同意]データ型](../../data-types/consents.md)を追加します。

## ミックスイン構造{#structure}

>[!IMPORTANT]
>
>[!DNL Consents & Preferences]ミックスインは、同意と優先管理の用途の幅広い範囲をカバーするように設計されています。 その結果、このドキュメントでは一般的な用語でのmixinのフィールドの使用について説明し、これらのフィールドの使用をどう解釈すべきかについての提案のみを行います。 お客様のプライバシー法人チームにお問い合わせの上、mixinの構造を、お客様の組織がこれらの同意と好みの選択をどのように解釈し、提示するかを調べてください。

[!DNL Consents & Preferences]ミックスインは、**同意**&#x200B;と&#x200B;**環境設定**&#x200B;の情報を取り込むために使用するいくつかのフィールドを提供します。

同意とは、顧客が自分のデータの使用方法を指定できるオプションです。 ほとんどの同意は法的側面を持ちます。管轄区域によっては、特定の方法でデータを使用する前に許可を取得する必要がある場合や、肯定的な同意が必要でない場合は、その使用を停止するオプション(オプトアウト)を持つ必要がある場合があります。

プリファレンスとは、ブランドに関するエクスペリエンスの様々な側面を顧客がどのように扱うべきかを指定できるオプションです。 これらは2つのカテゴリ内にあります。

* **個人設定の環境設定**:ブランドが顧客に提供するエクスペリエンスをパーソナライズする方法に関する環境設定。
* **マーケティングの環境設定**:様々なチャネルを通じてブランドが顧客との接触を許可されるかどうかに関するプレファレンス。

次のスクリーンショットは、Platform UIでmixinの構造がどのように表されるかを示しています。

![](../../images/mixins/consent.png)

>[!TIP]
>
>XDMリソースを調べ、プラットフォームUIでその構造を調べる手順については、[XDMリソース](../../ui/explore.md)のガイドを参照してください。

次のJSONは、[!DNL Consents & Preferences]ミックスインで処理できるデータのタイプの例を示しています。 各フィールドの具体的な使用方法については、以降の節で説明します。

```json
{
  "consents": {
    "collect": {
      "val": "VI"
    },
    "share": {
      "val": "y"
    },
    "personalize": {
      "content": {
        "val": "y"
      }
    },
    "marketing": {
      "preferred": "email",
      "any": {
        "val": "y"
      },
      "email": {
        "val": "y"
      }
    },
    "idSpecific": {
      "ECID": {
        "37784337855396895622558625508046772577": {
          "adID": {
            "val": "n",
          },
          "share": {
            "val": "n"
          },
          "marketing": {
            "push": {
              "val": "n",
              "time": "2020-09-30T01:02:33+00:00",
              "reason": "not relevant"
            }
          }
        }
      },
      "email": {
        "john@xyz.com": {
          "marketing": {
            "email": {
              "val": "y"
            }
          }
        }
      }
    },
    "metadata": {
      "time": "2019-01-01T15:52:25+00:00"
    }
  }
}
```

>[!TIP]
>
>Experience Platformで定義した任意のXDMスキーマ用のサンプルJSONデータを生成して、顧客の同意と環境設定データのマッピング方法を視覚化できます。 詳しくは、次のドキュメントを参照してください。
>
>* [UIでのサンプルデータの生成](../../ui/sample.md)
>* [APIでのサンプルデータの生成](../../api/sample-data.md)


## フィールドの使用例

これらの各フィールドの使用例については、以下の節で説明します。

### `collect`

`collect` は、顧客がデータを収集することに同意したことを表します。

```json
"collect" : {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | この使用事例に対するお客様提供の同意の選択。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |

### `share`

`share` は、自社のデータを第2のパーティと共有（または第3のパーティと共有）できるか（または販売できるか）に関する顧客の同意を表します。

```json
"share" : {
  "val": "y"
}
```

| プロパティ | 説明 |
| --- | --- |
| `val` | この使用事例に対するお客様提供の同意の選択。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |

### `personalize` {#personalize}

`personalize` データをどのようにパーソナライズに使用できるかに関する顧客の環境設定を取得します。お客様は、特定オプトアウトのパーソナライゼーションの使用例を使用することも、パーソナライゼーションを完全オプトアウトに使用することもできます。

>[!IMPORTANT]
>
>`personalize` マーケティングの使用例は説明していません。例えば、すべてのチャネルに対してパーソナライゼーションをオプトアウトした場合、それらのチャネルを通じた通信の受信を停止しないでください。 その代わりに、メッセージの受信はプロファイルに基づくのではなく、汎用的なものにする必要があります。
>
>同じ例で、すべてのチャネル（`marketing`次のセクション](#marketing)で説明する[を通じて）のダイレクトマーケティングをオプトアウトする場合、パーソナライゼーションが許可されていても、顧客はメッセージを受け取らないでください。

```json
"personalize": {
  "content": {
    "val": "y",
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `content` | Webサイトやアプリケーション上でパーソナライズされたコンテンツを提供する、ユーザーの環境設定を表します。 |
| `val` | 指定した使用例に対する顧客が提供するパーソナライゼーション設定です。 顧客が同意を求められない場合は、このフィールドの値は、パーソナライゼーションを実行する基準を示す必要があります。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |

### `marketing` {#marketing}

`marketing` データを使用できるマーケティング目的に関する顧客の判断基準を取り込みます。特定オプトアウトのマーケティングの使用例や、完全なダイレクトマーケティングオプトアウトのお客様が考えられます。

```json
"marketing": {
  "preferred": "email",
  "any": {
    "val": "u"
  },
  "email": {
    "val": "n",
    "reason": "Too Frequent"
  },
  "push": {
    "val": "y"
  },
  "sms": {
    "val": "y"
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `preferred` | 顧客が好む通信チャネルを示します。 使用できる値については、[付録](#preferred-values)を参照してください。 |
| `any` | ダイレクトマーケティング全体に対する顧客の好みを表します。 `marketing`で提供される追加のサブフィールドによって上書きされない限り、このフィールドに指定される同意の優先順位は、すべてのマーケティングチャネルに対する「デフォルト」の優先順位と見なされます。 より詳細な同意オプションを使用する場合は、このフィールドを除外することをお勧めします。<br><br>この値をに設定した場合 `n`、それ以上の個別設定は無視する必要があります。値を`y`に設定した場合、`n`に明示的に設定しない限り、詳細なパーソナライゼーションオプションもすべて`y`として扱う必要があります。 値が設定されていない場合は、個々のパーソナライゼーションオプションの値を指定どおりに扱う必要があります。 |
| `email` | 顧客が電子メールメッセージの受信に同意するかどうかを示します。 また、このチャネル内の個々の購読に対して、ユーザーの環境設定を行うこともできます。 詳しくは、[購読](#subscriptions)の節を参照してください。 |
| `push` | ユーザーがプッシュ通知の受信を許可しているかどうかを示します。 また、このチャネル内の個々の購読に対して、ユーザーの環境設定を行うこともできます。 詳しくは、[購読](#subscriptions)の節を参照してください。 |
| `sms` | ユーザーがテキストメッセージの受信に同意するかどうかを示します。 また、このチャネル内の個々の購読に対して、ユーザーの環境設定を行うこともできます。 詳しくは、[購読](#subscriptions)の節を参照してください。 |
| `val` | 指定した使用例に対する顧客が指定した基本設定です。 顧客が同意を促すように促す必要がない場合は、このフィールドの値はマーケティング使用事例の発生基準を示す必要があります。 使用できる値と定義については、[付録](#choice-values)を参照してください。 |
| `time` | マーケティング環境設定が変更された時のISO 8601タイムスタンプ（該当する場合）。 個々の優先順位のタイムスタンプが`metadata`の下で提供されるタイムスタンプと同じ場合、その優先順位に対してこのフィールドは設定されません。 |
| `reason` | 顧客がマーケティングの使用事例からオプトアウトした場合、この文字列フィールドは、顧客がオプトアウトした理由を表します。 |

#### `subscriptions` {#subscriptions}

`marketing`オブジェクトの`email`、`push`および`sms`プロパティは、これらの個々のチャネルの顧客購読を表すことができます。 これは、対象となるマーケティングチャネルに`subscriptions`プロパティを追加することで実現されます。

```json
"marketing": {
  "email": {
    "val": "y",
    "subscriptions": {
      "daily-mail": {
        "val": "y",
        "type": "paid",
        "subscribers": {
          "john@xyz.com": {
            "time": "2019-01-01T15:52:25+00:00",
            "source": "website"
          }
        }
      },
      "shipped": {
        "val": "y",

        "subscribers": {
          "john@xyz.com": {
            "time": "2021-01-01T08:32:53+07:00",
            "source": "website"
          },
          "jane@xyz.com": {
            "time": "2020-02-03T07:54:21+07:00",
            "source": "call center",
          }
        }
      }
    }
  }
}
```

| プロパティ | 説明 |
| --- | --- |
| `type` | 購読タイプ。 15文字以下の場合は、任意の説明文字列を指定できます。 |
| `subscribers` | 特定の購読を購読している識別子（電子メールアドレスや電話番号など）のセットを表す、オプションのmap-typeフィールドです。 このオブジェクトの各キーは、問題の識別子を表し、2つのサブプロパティが含まれます。 <ul><li>`time`:IDがサブスクライブされた場合のISO 8601タイムスタンプ（該当する場合）。</li><li>`source`:サブスクライバの送信元です。15文字以下の場合は、任意の説明文字列を指定できます。</li></ul> |


### `metadata`

`metadata` 顧客の同意と環境設定が最後に更新されたときに、その同意に関する一般的なメタデータを取り込みます。

```json
"metadata": {
  "time": "2019-01-01T15:52:25+00:00",
}
```

| プロパティ | 説明 |
| --- | --- |
| `time` | 顧客の同意および環境設定が最後に更新された時点のISO 8601タイムスタンプ。 読み込みと複雑さを軽減するために、個々の環境設定にタイムスタンプを適用する代わりに、このフィールドを使用できます。 個々の環境設定で`time`値を指定すると、その環境設定の`metadata`タイムスタンプよりも優先されます。 |

### `idSpecific`

`idSpecific` は、特定の同意または優先度が顧客に広く適用されるわけではなく、単一のデバイスまたはIDに限定される場合に使用できます。例えば、顧客はあるアドレス宛てオプトアウトの電子メールを受信できる一方、別のアドレス宛ての電子メールを受信できる可能性があります。

>[!IMPORTANT]
>
>チャネルレベルの同意と環境設定（`idSpecific`の外側に`consents`が提供する同意と環境設定）は、そのチャネル内のIDに適用されます。 したがって、チャネルレベルの同意事項や環境設定は、同等のIDやデバイス固有の設定が適用されるかどうかに関わらず、直接影響を受けます。
>
>* お客様がチャネルレベルでオプトアウトした場合、`idSpecific`の同等の同意または環境設定は無視されます。
>* チャネルレベルの同意または優先度が設定されていない場合、またはお客様がオプトインを選択した場合は、`idSpecific`の同等の同意または好みが使用されます。


`idSpecific`オブジェクトの各キーは、Adobe Experience PlatformIDサービスで認識される特定のID名前空間を表します。 様々なIDを分類する独自のカスタム名前空間を定義できますが、リアルタイム顧客プロファイルのストレージサイズを小さくするために、Identity Serviceが提供する標準名前空間の1つを使用することをお勧めします。 ID名前空間の詳細については、Identity Serviceドキュメントの[ID名前空間の概要](../../../identity-service/namespaces.md)を参照してください。

各名前空間オブジェクトのキーは、ユーザーが環境設定を行った一意のID値を表します。 各ID値には、`consents`と同じ形式の完全な同意と環境設定を含めることができます。

```json
"idSpecific": {
  "email": {
    "jdoe@example.com": {
      "marketing": {
        "email": {
          "val": "n"
        }
      }
    }
  },
  "ECID" : {
    "37784337855396895622558625508046772577": {
      "collect": {
        "val": "y"
      },
      "adID": {
        "val": "n"
      },
      "marketing": {
        "push": {
          "val": "n"
        }
      }
    }
  }
}
```

`idSpecific`セクションに指定された`marketing`オブジェクト内では、`any`フィールドと`preferred`フィールドはサポートされません。 これらのフィールドは、ユーザーレベルでのみ設定できます。 また、`email`、`sms`および`push`の`idSpecific`マーケティング環境設定は`subscriptions`フィールドをサポートしません。

`idSpecific`セクションでのみ指定できる同意もあります。`adID`. このフィールドについては、以下のサブセクションで説明します。

#### `adID`

`adID`の同意は、広告主ID（IDFAまたはGAID）を使用して、このデバイス上のアプリ間で顧客をリンクできるかどうかに関する顧客の同意を表します。 この値は、`idSpecific`セクションの`ECID` identity名前空間の下でのみ設定でき、他の名前空間や、このミックスインのユーザーレベルでは設定できません。

```json
"idSpecific": {
  "ECID" : {
    "37784337855396895622558625508046772577": {
      "collect": {
        "val": "y"
      },
      "adID": {
        "val": "n"
      },
      "marketing": {
        "push": {
          "val": "n"
        }
      }
    }
  }
}
```

>[!NOTE]
>
>必要に応じて、Adobe Experience PlatformモバイルSDKが自動的に設定するので、この値を直接設定する必要はありません。

## mixin {#ingest}を使ってデータを取り込む

[!DNL Consents & Preferences]ミックスインを使用して顧客の同意データを取り込むには、そのミックスインを含むスキーマに基づいてデータセットを作成する必要があります。

フィールドにミックスインを割り当てる手順については、UI](http://www.adobe.com/go/xdm-schema-editor-tutorial-en)でのスキーマの作成に関するチュートリアルを参照してください。 [[!DNL Consents & Preferences]ミックスインを使用してフィールドを含むスキーマーを作成したら、既存のスキーマーでデータセットを作成する手順に従って、『データセットユーザーガイド』の[データセット](../../../catalog/datasets/user-guide.md#create)の作成に関する節を参照してください。

>[!IMPORTANT]
>
>[!DNL Real-time Customer Profile]に同意データを送信する場合は、[!DNL Consents & Preferences]ミックスインを含む[!DNL XDM Individual Profile]クラスに基づいて[!DNL Profile]対応スキーマを作成する必要があります。 そのスキーマに基づいて作成するデータセットも[!DNL Profile]に対して有効にする必要があります。 スキーマとデータセットの[!DNL Real-time Customer Profile]要件に関する具体的な手順については、上記のリンクを含むチュートリアルを参照してください。
>
>また、顧客プロファイルを正しく更新するために、最新の同意データと優先データを含むデータセットに優先順位を付けるようにマージポリシーを設定する必要もあります。 詳しくは、[マージポリシー](../../../rtcdp/profile/merge-policies.md)の概要を参照してください。

## 同意と優先順位の変更の処理

お客様がWebサイトでの同意や環境設定を変更した場合は、[Adobe Experience PlatformWeb SDK](../../../edge/consent/supporting-consent.md)を使用して、変更を収集し直ちに適用する必要があります。 顧客がデータ収集をオプトアウトした場合、すべてのデータ収集は直ちに停止する必要があります。 顧客がパーソナライゼーションをオプトアウトした場合、訪問者が次のページにパーソナライゼーションを表示しないでください。

## 付録 {#appendix}

以下の節では、[!DNL Consents & Preferences]ミックスインに関する追加の参照情報を示します。

### `val` {#choice-values}に指定できる値

次の表に、`val`に使用できる値の概要を示します。

| 値 | タイトル | 説明 |
| --- | --- | --- |
| `y` | ○ | 顧客が同意または優先を選択しました。 つまり、****&#x200B;は、対象となる同意または好みで示されるデータの使用に同意します。 |
| `n` | × | 顧客が同意または好みをオプトアウトしました。 つまり、**は、対象となる同意や嗜好で示されるデータの使用に**&#x200B;同意しません。 |
| `p` | 検証待ち | システムは、最終同意または優先度の値をまだ受け取っていません。 これは、2段階の検証が必要な同意の一部として最もよく使用されます。 例えば、顧客が電子メールの受信を希望する場合、電子メール内のリンクを選択して正しい電子メールアドレスを入力したことを確認するまで、同意は`p`に設定され、その時点で`y`に更新されます。<br><br>この同意または優先順位で2つのセットによる検証プロセスを使用しない場合は、代わりに `p` 選択肢を使用して、顧客がまだ同意プロンプトに応答していないことを示すことができます。例えば、顧客が同意プロンプトに応答する前に、Webサイトの最初のページで値を自動的に`p`に設定できます。 明示的な同意を必要としない管轄区域では、顧客が明示的にオプトアウトしないことを示す（つまり、同意が前提となる）場合にも使用できます。 |
| `u` | Unknown | 顧客の同意または嗜好情報が不明です。 |
| `LI` | 正当な利益 | 特定の目的でこのデータを収集して処理する正当なビジネス上の関心事は、個人に与える潜在的な損害を上回ります。 |
| `CT` | 契約 | 特定の目的に応じたデータの収集は、個人との契約上の義務を満たすために必要です。 |
| `CP` | 法的義務の遵守 | 特定の目的に対するデータの収集は、ビジネスの法的義務を満たすために必要です。 |
| `VI` | 個人の極めて重要な関心 | 特定の目的に合わせたデータの収集は、個人の重要な利益を保護するために必要です。 |
| `PI` | 公益 | 特定の目的に係るデータの収集は、公益上のタスク又は職権の行使上の行為に必要とされる。 |

### `preferred` {#preferred-values}に指定できる値

次の表に、`preferred`に使用できる値の概要を示します。

| 値 | 説明 |
| --- | --- |
| `email` | 電子メールメッセージ。 |
| `push` | プッシュ通知. |
| `inApp` | アプリ内メッセージ. |
| `sms` | SMSメッセージ。 |
| `phone` | 電話のインタラクション数。 |
| `phyMail` | 物理的なメール。 |
| `inVehicle` | 車内メッセージ。 |
| `inHome` | ホームメッセージ。 |
| `iot` | インターネット(IoT)メッセージ。 |
| `social` | ソーシャルメディアコンテンツ。 |
| `other` | 標準のカテゴリに適合しないチャネルです。 |
| `none` | 優先するチャネルはありません。 |
| `unknown` | 優先チャネルが不明です。 |

### 完全な[!DNL Consents & Preferences]スキーマ{#full-schema}

[!DNL Consents & Preferences]ミックスインの完全なスキーマを表示するには、[正式なXDMリポジトリ](https://github.com/adobe/xdm/blob/master/components/datatypes/consent-preferences.schema.json)を参照してください。
