---
keywords: Experience Platform；ホーム；人気のあるトピック；セグメント化サービス；セグメント化サービス；ユーザーガイド；ui ガイド；セグメント化 ui ガイド；セグメントビルダー；セグメントビルダー；
solution: Experience Platform
title: セグメントビルダー UI ガイド
topic-legacy: ui guide
description: Adobe Experience Platform UI のセグメントビルダーは、プロファイルデータ要素を操作できる豊富なワークスペースを提供します。 ワークスペースには、ルールを作成および編集するための直感的なコントロールがあります。例えば、データプロパティを表示する際に使用するドラッグ＆ドロップタイルなどです。
exl-id: b27516ea-8749-4b44-99d0-98d3dc2f4c65
source-git-commit: 11e8acc3da7f7540421b5c7f3d91658c571fdb6f
workflow-type: tm+mt
source-wordcount: '1996'
ht-degree: 42%

---

# [!DNL Segment Builder] UI ガイド

[!DNL Segment Builder] は、データ要素を操作できる豊富なワークスペ [!DNL Profile] ースを提供します。ワークスペースには、ルールを作成および編集するための直感的なコントロールがあります。例えば、データプロパティを表示する際に使用するドラッグ＆ドロップタイルなどです。

![](../images/ui/segment-builder/segment-builder.png)

## セグメント定義の構成要素

セグメント定義の基本的な構成要素は、属性とイベントです。 また、既存のオーディエンスに含まれる属性とイベントも、新しい定義のコンポーネントとして使用できます。

これらの構築要素は、[!DNL Segment Builder] ワークスペースの左側の **[!UICONTROL フィールド]** セクションに表示されます。 **** フィールドには、主要な構築要素のタブが含まれます。「[!UICONTROL 属性]」、「[!UICONTROL イベント]」および「[!UICONTROL オーディエンス]」の 3 つのフィールドがあります。

![](../images/ui/segment-builder/segment-fields.png)

### 属性

「**[!UICONTROL 属性]**」タブでは、[!DNL XDM Individual Profile] クラスに属する [!DNL Profile] 属性を参照できます。 各フォルダーを展開して、追加の属性を表示できます。各属性はタイルで表されており、ワークスペースの中央にあるルールビルダーキャンバスにドラッグすることができます。[ルールビルダーキャンバス](#rule-builder-canvas)の詳細については、このガイドで後述します。

![](../images/ui/segment-builder/attributes.png)

### イベント

「**[!UICONTROL イベント]**」タブでは、 のデータ要素を使用して実行されたイベントまたはアクションに基づいてオーディエンスを作成できます。[!DNL XDM ExperienceEvent]また、「**[!UICONTROL イベント]**」タブではイベントタイプを検索できます。イベントタイプは一般的に使用されるイベントの集まりで、これを使用するとセグメントをより迅速に作成することができます。

[!DNL ExperienceEvent] 要素を参照できるだけでなく、イベントタイプを検索することもできます。 イベントタイプは、[!DNL ExperienceEvents] と同じコーディングロジックを使用します。[!DNL XDM ExperienceEvent] クラスを検索して正しいイベントを探す必要はありません。 例えば、検索バーを使用して「cart」を検索すると、イベントタイプ「[!UICONTROL AddCart]」と「[!UICONTROL RemoveCart]」が返されます。これは、セグメント定義を作成する際によく使用される 2 つの買い物かごアクションです。

任意のタイプのコンポーネントを検索するには、[Lucene の検索構文](https://docs.microsoft.com/ja-JP/azure/search/query-lucene-syntax)を使用して、検索バーにその名前を入力します。単語を完全に入力すると、検索結果が表示され始めます。例えば、XDM フィールド `ExperienceEvent.commerce.productViews` に基づくルールを作成するには、検索フィールドに「product views」と入力します。「product」という単語の入力が終わると同時に、検索結果が表示され始めます。検索結果には、それが属するオブジェクト階層も表示されます。

>[!NOTE]
>
>組織で定義されたカスタムスキーマフィールドが表示され、ルールの作成に使用できるようになるまでに、最長で 24 時間かかる場合があります。

その後、[!DNL ExperienceEvents] と&quot;[!UICONTROL Event Types]&quot;をセグメント定義に簡単にドラッグ&amp;ドロップできます。

![](../images/ui/segment-builder/events-eventTypes.png)

デフォルトでは、データストアから入力されたスキーマフィールドのみが表示されます。これには、「[!UICONTROL  イベントタイプ ]」が含まれます。 「[!UICONTROL  イベントタイプ ]」リストが表示されない場合、または「[!UICONTROL  任意の ]」を「[!UICONTROL  イベントタイプ ]」として選択できる場合は、**「**[!UICONTROL  フィールド ]**」の横の  ギアアイコン** を選択し、**[!UICONTROL **[!UICONTROL  使用可能なフィールド ]**の下に完全な XDM スキーマ]** を表示します。 **歯車アイコン** を再度選択して「**[!UICONTROL フィールド]**」タブに戻り、データが含まれているかどうかに関係なく、複数の「[!UICONTROL  イベントタイプ ]」とスキーマフィールドを表示できます。

![](../images/ui/segment-builder/show-populated.png)

### オーディエンス

「**[!UICONTROL オーディエンス]**」タブには、Adobe Audience Managerなどの外部ソースからインポートされたすべてのオーディエンスと、[!DNL Experience Platform] 内で作成されたオーディエンスが一覧表示されます。

「**[!UICONTROL オーディエンス]**」タブでは、使用可能なすべてのソースをフォルダーのグループとして表示できます。 フォルダーを選択すると、使用可能なサブフォルダーとオーディエンスが表示されます。 また、フォルダー構造を表示する（チェックマークは現在存在するフォルダーを示す）ために（右端の画像に示すように）フォルダーアイコンを選択し、ツリー内のフォルダーの名前を選択してフォルダー間を簡単に戻すことができます。

オーディエンス横の ⓘ にカーソルを置くと、そのオーディエンスに関する情報が表示されます。例えば、ID、説明、そのオーディエンスが存在するフォルダーの階層などです。

![](../images/ui/segment-builder/audience-folder-structure.png)

また、検索バーを使用してオーディエンスを検索することもできます。その場合は、[Lucene の検索構文 ](https://docs.microsoft.com/en-us/azure/search/query-lucene-syntax) を使用します。 「**[!UICONTROL オーディエンス]**」タブで最上位のフォルダーを選択すると、検索バーが表示され、そのフォルダー内を検索することができます。検索結果は、単語の入力が終わると同時に表示され始めます。例えば、`Online Shoppers` という名前のオーディエンスを検索するには、検索バーに「Online」と入力します。 「Online」という単語を完全に入力すると、「Online」という単語を含む検索結果が表示されます。

## ルールビルダーキャンバス {#rule-builder-canvas}

セグメント定義は、ターゲットオーディエンスの重要な特徴やビヘイビアーの説明に使用される一連のルールです。これらのルールは、[!DNL Segment Builder] の中央にあるルールビルダーキャンバスを使用して作成します。

セグメント定義に新しいルールを追加するには、タイルを「**[!UICONTROL フィールド]**」タブからルールビルダーキャンバスにドラッグ＆ドロップします。追加するデータのタイプに応じて、コンテキスト固有のオプションが表示されます。使用できるデータタイプは次のとおりです。文字列、日付、[!DNL ExperienceEvents]、&quot;[!UICONTROL  イベントタイプ ]&quot;およびオーディエンス。

![](../images/ui/segment-builder/rule-builder-canvas.png)

>[!IMPORTANT]
>
>Adobe Experience Platformの最新の変更により、イベント間の `OR` 論理演算子と `AND` 論理演算子の使用が更新されました。 これらの更新は、既存のセグメントには影響しません。 ただし、既存のセグメントと新しいセグメント作成に対するそれ以降の更新はすべて、これらの変更の影響を受けます。 詳細は、[ 時間定数 update](./segment-refactoring.md) を参照してください。

### オーディエンスの追加

オーディエンスを「**[!UICONTROL オーディエンス]**」タブからルールビルダーキャンバスにドラッグ＆ドロップすることで、新しいセグメント定義でオーディエンスのメンバーシップを参照できます。これで、オーディエンスのメンバーシップを新しいセグメントルールの属性として含めたり除外したりできます。

[!DNL Segment Builder] を使用して作成された [!DNL Platform] オーディエンスの場合は、オーディエンスを、そのオーディエンスのセグメント定義で使用された一連のルールに変換するオプションが与えられます。 このように変換するとルールロジックのコピーが作成されます。このコピーを使用することで、元のセグメント定義に影響を与えることなくルールを変更できます。セグメント定義に対する最近の変更を保存してから、ルールロジックに変換してください。

>[!NOTE]
>
>外部ソースからオーディエンスを追加した場合、オーディエンスのメンバーシップのみが参照されます。このオーディエンスをルールに変換することはできません。このため、元のオーディエンスの作成に使用されたルールを新しいセグメント定義で変更することはできません。

![](../images/ui/segment-builder/add-audience-to-segment.png)

オーディエンスをルールに変換する際に競合が発生した場合は、[!DNL Segment Builder] は既存のオプションを最大限に保持しようとします。

### コードビュー

または、[!DNL Segment Builder] で作成したコードベースのルールを表示することもできます。 ルールビルダーキャンバス内でルールを作成したら、「**[!UICONTROL コードビュー]**」を選択して、セグメントを PQL として表示できます。

![](../images/ui/segment-builder/code-view.png)

コードビューには、API 呼び出しで使用するセグメントの値をコピーできるボタンが用意されています。 セグメントの最新バージョンを取得するには、セグメントに対する最新の変更を保存していることを確認します。

![](../images/ui/segment-builder/copy-code.png)

### 集計関数

[!DNL Segment Builder] の集計は、データ型が数値（倍精度または整数）の XDM 属性のグループに対する計算です。 セグメントビルダーでサポートされている 4 つの集計関数は、SUM、AVERAGE、MIN、MAXです。

集計機能を作成するには、左側のレールからイベントを選択し、「[!UICONTROL  イベント ]」コンテナに挿入します。

![](../images/ui/segment-builder/select-event.png)

イベントコンテナ内にイベントを配置した後、省略記号アイコン (...) を選択し、次に **[!UICONTROL 集計]** を選択します。

![](../images/ui/segment-builder/add-aggregation.png)

これで、集計が追加されます。 集計関数を選択し、集計する属性、等価関数、値を選択できるようになりました。 次の例では、このセグメントは、各購入が 100 ドル未満の場合でも、購入した値の合計が 100 ドルを超えるプロファイルを評価します。

![](../images/ui/segment-builder/filled-aggregation.png)

### カウント関数 {#count-functions}

セグメントビルダーの「カウント」関数は、指定したイベントを検索し、そのイベントが完了した回数をカウントするために使用されます。 セグメントビルダーでサポートされているカウント関数は、「At least」、「At most」、「Exactly」、「Between」および「All」です。

カウント関数を作成するには、左側のレールからイベントを選択し、[!UICONTROL  イベント ] コンテナに挿入します。

![](../images/ui/segment-builder/add-event.png)

イベントコンテナ内にイベントを配置した後、「 以上」ボタンを選択します。

![](../images/ui/segment-builder/add-count.png)

これで、count 関数が追加されました。 カウント関数と関数の値を選択できるようになりました。 次の例では、少なくとも 1 回のクリックを持つイベントを含めます。

![](../images/ui/segment-builder/select-count.png)

## コンテナ

セグメントルールは、リストでの表示順に従って評価されます。コンテナでは、ネストされたクエリを使用して、評価の順序を制御できます。

ルールビルダーキャンバスにタイルを 1 つ以上追加したら、コンテナの追加を開始できます。新しいコンテナを作成するには、タイルの右上隅にある省略記号 (...) を選択し、「**[!UICONTROL コンテナを追加]**」を選択します。

![](../images/ui/segment-builder/add-container.png)

新しいコンテナが最初のコンテナの子として表示されますが、コンテナをドラッグして移動することで、階層を調整することができます。コンテナのデフォルトの動作は、指定した属性、イベントまたはオーディエンスを「」に含めることです。 コンテナ条件に一致するプロファイルを「[!UICONTROL  除外 ]」に設定するには、タイルの左上隅の「**[!UICONTROL 含める]**」を選択し、「[!UICONTROL  除外する ]」を選択します。

子コンテナを抽出し、親コンテナにインラインで追加するには、子コンテナで「コンテナを展開」を選択します。 子コンテナの右上隅にある省略記号 (...) を選択して、このオプションにアクセスします。

![](../images/ui/segment-builder/include-exclude.png)

「**[!UICONTROL コンテナを展開]**」を選択すると、子コンテナが削除され、条件がインラインで表示されます。

>[!NOTE]
>
>コンテナを展開する場合には、ロジックが引き続き目的のセグメント定義を満たすようにしてください。

![](../images/ui/segment-builder/unwrapped-container-inline.png)

## 結合ポリシー

[!DNL Experience Platform] では、複数のソースのデータを統合して、個々の顧客の全体像を把握できます。このデータを統合する場合、結合ポリシーは、データの優先順位付け方法と、プロファイルを作成するために組み合わされるデータを決定するために [!DNL Platform] で使用されるルールです。

このオーディエンスのマーケティング目的に合った結合ポリシーを選択するか、[!DNL Platform] が提供するデフォルトの結合ポリシーを使用できます。 デフォルトの結合ポリシーを作成できるほか、組織に固有の複数の結合ポリシーを作成できます。組織の結合ポリシーを作成する手順については、まず [ 結合ポリシーの概要 ](../../profile/merge-policies/overview.md) をお読みください。

セグメント定義の結合ポリシーを選択するには、「**[!UICONTROL フィールド]**」タブの歯車アイコンを選択し、「**[!UICONTROL 結合ポリシー]**」ドロップダウンメニューを使用して、使用する結合ポリシーを選択します。

![](../images/ui/segment-builder/merge-policy-selector.png)

## セグメントのプロパティ

セグメント定義を作成する際には、作成されるセグメントの推定サイズがワークスペース右側の「**[!UICONTROL セグメントのプロパティ]**」セクションに表示されるので、オーディエンス自体を作成する前にセグメントの定義を必要に応じて調整できます。

「**[!UICONTROL セグメントのプロパティ]**」セクションでは、セグメント定義の名前や説明など、セグメント定義に関する重要な情報を指定することもできます。 セグメント定義名は、組織で定義されたものの中から目的のセグメントを識別する際に使用されます。このため、セグメント定義名は、内容がわかりやすく簡潔、かつ一意である必要があります。

セグメント定義の作成中、「**[!UICONTROL プロファイルを表示]**」を選択することで、オーディエンスのプレビューをページ別に表示できます。

![](../images/ui/segment-builder/segment-properties.png)

>[!NOTE]
>
>オーディエンスの予測値は、その日のサンプルデータのサンプルサイズを使用して生成されます。プロファイルストアのエンティティ数が 100 万個未満の場合は、データセット全体が使用されます。100 万個から 2,000 万個のエンティティがある場合は、100 万個のエンティティが使用されます。2,000 万個を超えるエンティティがある場合は、合計エンティティ数の 5％が使用されます。セグメントの推定サイズを生成する方法について詳しくは、セグメントの作成に関するチュートリアルの[予測値の生成に関する節](../tutorials/create-a-segment.md#estimate-and-preview-an-audience)を参照してください。

## 次の手順 {#next-steps}

セグメントビルダーには、マーケティング可能なオーディエンスを [!DNL Real-time Customer Profile] データから分離できる、豊富なワークフローが用意されています。 このガイドをお読みになると、次のことができるようになります。

- 属性、イベントおよび既存のオーディエンスの組み合わせを構成要素として使用して、セグメント定義を作成する。
- ルールビルダーキャンバスとコンテナを使用して、セグメントルールの実行順を制御する。
- 見込みオーディエンスの予測値を表示する。必要に応じてセグメント定義を調整できます。
- スケジュールに沿ったセグメント化に対してすべてのセグメント定義を有効にする。
- ストリーミングによるセグメント化に対して、特定のセグメント定義を有効にする。

[!DNL Segmentation Service] の詳細については、ドキュメントを引き続き読み、関連するビデオを見て学習を補完してください。 [!DNL Segmentation Service] UI の他の部分の詳細については、[[!DNL Segmentation Service]  ユーザーガイド ](./overview.md) を参照してください。
