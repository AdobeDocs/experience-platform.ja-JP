---
keywords: Experience Platform;home;popular topics
solution: Experience Platform
title: セグメントビルダーのUIガイド
topic: ui guide
translation-type: tm+mt
source-git-commit: f44e42a4faa3b10f147dbaf929048054ce0bec42
workflow-type: tm+mt
source-wordcount: '2750'
ht-degree: 0%

---


# [!DNL Segment Builder] ユーザーガイド

[!DNL Adobe Experience Platform Segmentation Service] は、データからセグメント定義を作成するためのRESTful APIおよびユーザーインターフェイスを提供し [!DNL Real-time Customer Profile] ます。

## はじめに

セグメントの定義を使用するには、セグメント化に関連する様々な [!DNL Experience Platform] サービスについて理解しておく必要があります。 このユーザーガイドを読む前に、次のサービスのドキュメントを確認してください。

- [!DNL Segmentation Service](../home.md): Segmentation Serviceを使用すると、個人(顧客、見込み客、ユーザーまたは組織)に関連 [!DNL Experience Platform] するに格納されたデータを、類似した特性を共有し、マーケティング戦略と同様に対応する小さなグループに分割できます。
- [!DNL Real-time Customer Profile](../../profile/home.md): 複数のソースからの集計データに基づいて、統合されたリアルタイムの消費者プロファイルを提供します。
- [!DNL Identity Service](../../identity-service/home.md): Platform [!DNL Real-time Customer Profile] に取り込まれる異なるデータソースのIDをブリッジ化することで有効にします。
- [!DNL Experience Data Model (XDM)](../../xdm/home.md): 顧客体験データを [!DNL Platform] 整理するための標準化されたフレームワーク。

また、このドキュメントを通じて使用される2つの主要用語を知り、それらの違いを理解することも重要です。
- **セグメント定義**: ターゲットオーディエンスの主な特性や動作を記述するために使用されるルールセット。
- **オーディエンス**: セグメント定義の条件を満たすプロファイルの結果セット。

## セグメント定義へのアクセス

でセグメント定義の操作を開始するに [!DNL Adobe Experience Platform]は、左側のナビゲーションで **[!UICONTROL 「セグメント]** 」をクリックします。 組織のすべてのセグメント定義を表示するには、「 *[!UICONTROL 参照]* 」タブをクリックします。 この表示リストでは、評価方法、作成日、最終変更日など、セグメント定義に関する情報を説明します。

評価方法は、ストリーミングまたはバッチのいずれかです。 ストリーミングセグメントは、データがシステムに入るに従って常に評価されます。 バッチセグメントは、設定されたスケジュールに従って評価されます。

バッチセグメントには、最終評価日と次のバッチ評価日の両方を示す追加情報が表示されます。

右上隅の **[!UICONTROL 「セグメントを]** 作成」をクリックすると、セグメントビルダーワークスペースが開き、セグメント定義の作成を開始できます。

![](../images/segment-builder/segment-browse.png)

## [!DNL Segment Builder] ワークスペース

[!DNL Segment Builder] は、データ要素を操作できるリッチワークスペースを提供し [!DNL Profile] ます。 ワークスペースには、ルールを作成および編集するための直感的なコントロールが用意されています。例えば、データプロパティを表すために使用するドラッグ&amp;ドロップタイルを編集できます。

![](../images/segment-builder/segment-builder.png)

## セグメント定義構築ブロック

セグメント定義の基本構成要素は、 **[!UICONTROL 属性]** と **[!UICONTROL イベントです]**。 また、既存の **[!UICONTROL オーディエンスに含まれる属性とイベントを、新しい定義のコンポーネントとして使用することもできます]** 。

これらの構築ブロックは、ワークス *[!UICONTROL ペースの左側の「]* フィールド [!DNL Segment Builder] 」セクションに表示されます。 *[!UICONTROL フィールド]* には、主要構築ブロックのそれぞれに対するタブが含まれます。 **[!UICONTROL 属性]**、 **[!UICONTROL イベント]**、 **[!UICONTROL オーディエンス]**。

![](../images/segment-builder/segment-fields.png)

### 属性

「 **[!UICONTROL 属性]** 」タブでは、 [!DNL Profile] クラスに属する [!DNL XDM Individual Profile] 属性を参照できます。 各フォルダーを展開して、追加の属性を表示できます。各属性は、ワークスペースの中央にあるルールビルダーキャンバスにドラッグできるタイルです。 ル [ールビルダーキャンバスについては](#rule-builder-canvas) 、このガイドで後述します。

![](../images/segment-builder/attributes.png)

### イベント

「 **[!UICONTROL イベント]** 」タブでは、XDM ExperienceEventデータ要素を使用して行われたイベントまたはアクションに基づいてオーディエンスを作成できます。 また、セグメントをより迅速に作成できるようにするためによく使用される **[!UICONTROL イベントの集まりである「イベント]** 」タブにイベントタイプが表示されます。

要素を参照できるだけでなく、 [!DNL ExperienceEvent] イベントタイプを検索することもできます。 イベントタイプはと同じコーディングロジックを使用し [!DNL ExperienceEvents]ます。クラス内を検索して正しいイベントを探す必要はありません [!DNL XDM ExperienceEvent] 。 例えば、検索バーを使用して「cart」を検索すると、「AddCart[!UICONTROL 」と「RemoveCart]」というイベントタイプが返されます。これは、セグメント定義の作成時に非常に一般的に使用される2つの買い物かごアクションです。

検索バーに名前を入力すると、どのようなタイプのコンポーネントでも検索できます。 [Luceneの検索構文が使用されます](https://docs.microsoft.com/en-us/azure/search/query-lucene-syntax)。 単語全体が入力されると、検索結果が入力され始めます。 例えば、XDMフィールドに基づくルールを作成するに `ExperienceEvent.commerce.productViews`は、開始が検索フィールドに「product product表示」と入力します。 「product」という語を入力すると、検索結果が表示され始めます。 各結果には、その結果が属するオブジェクト階層が含まれます。

>[!NOTE]
>
>組織で定義したカスタムスキーマフィールドが表示され、ルールの作成で使用できるようになるまでに最大24時間かかる場合があります。

セグメント定義に簡単に [!DNL ExperienceEvents] イベントタイプをドラッグ&amp;ドロップできます  。

![](../images/segment-builder/events-eventTypes.png)

デフォルトでは、データストアから入力されたスキーマフィールドのみが表示されます。 これには [!UICONTROL イベントタイプが含まれます]。 イベントタイプ [!UICONTROL リストが表示されない場合、または「Any] 」を[!UICONTROL イベントタイプとして選択できる場合は、]Gearアイコンをクリックし、次に [!UICONTROL Gear Iconをクリックして、Gearをクリックし、次に]Select Fields ******** Full Folls Exdm and Available Fieldsをクリックします。 歯車アイコンを再度クリックして「 *[!UICONTROL フィールド]* 」タブに戻り、データが含まれているかどうかに関係なく、複数の [!UICONTROL イベントタイプ] およびスキーマフィールドを表示できるようになります。

![](../images/segment-builder/show-populated.png)

### オーディエンス

「 **[!UICONTROL オーディエンス]** 」タブでは、Adobe Audience Managerなどの外部ソースから読み込んだすべてのオーディエンスと、内で作成したオーディエンスをリスト [!DNL Experience Platform]します。

「 [!UICONTROL オーディエンス] 」タブでは、使用可能なすべてのソースをフォルダーのグループとして表示できます。 これらのフォルダをクリックすると、使用可能なサブフォルダやオーディエンスが表示されます。 また、フォルダアイコン（右端の画像）をクリックしてフォルダ構造を表示し（チェックマークは現在のフォルダを示します）、ツリー内のフォルダ名をクリックすると、簡単にフォルダ間を戻ることができます。

オーディエンスのⓘ横にマウスポインターを置くと、ID、説明、オーディエンスの階層など、オーディエンスに関する表示情報を参照し、を見つけることができます。

![](../images/segment-builder/audience-folder-structure.png)

また、 [!UICONTROL Luceneの検索構文を利用した検索バーを使用して] オーディエンス [を検索することもできます](https://docs.microsoft.com/en-us/azure/search/query-lucene-syntax)。 「 *[!UICONTROL オーディエンス]* 」タブで最上位フォルダを選択すると、検索バーが表示され、そのフォルダ内を検索できます。 検索結果の入力は、単語全体が入力された場合にのみ開始されます。 例えば、という [!UICONTROL オーディエンスを検索するには] 、開始 `Online Shoppers`が検索バーに「Online」と入力します。 「オンライン」という単語を完全に入力すると、「オンライン」という単語を含む検索結果が表示されます。

## ルールビルダーキャンバス {#rule-builder-canvas}

セグメント定義とは、ターゲットオーディエンスの主な特性や動作を記述するために使用されるルールの集まりです。 これらのルールは、の中央にある *[!UICONTROL ルールビルダーキャンバスを使用して作成され]*&#x200B;ま [!DNL Segment Builder]す。

セグメント定義に新しいルールを追加するには、「 *[!UICONTROL フィールド]* 」タブからタイルをドラッグし、ルールビルダーキャンバスにドロップします。 次に、追加するデータのタイプに応じて、コンテキスト固有のオプションが表示されます。 次のようなデータタイプを使用できます。 文字列、日付、 [!DNL ExperienceEvents][!UICONTROL イベントタイプ]、 [!UICONTROL オーディエンス]。

![](../images/segment-builder/rule-builder-canvas.png)

### オーディエンスの追加

オーディエンスを「 *[!UICONTROL オーディエンス]* 」タブからルールビルダーキャンバスにドラッグ&amp;ドロップして、新しいセグメント定義のオーディエンスのメンバーシップを参照できます。 これにより、オーディエンスのメンバーシップを属性として新しいセグメントルールに含めたり、除外したりできます。

を使用して作成された [!DNL Platform] オーディエンスに [!DNL Segment Builder]は、そのオーディエンスのセグメント定義で使用された一連のルールにオーディエンスを変換するオプションが与えられます。 この変換により、ルールロジックのコピーが作成され、元のセグメント定義に影響を与えることなく変更できます。 セグメント定義をルールロジックに変換する前に、セグメント定義に対する最新の変更を保存していることを確認してください。

>[!NOTE]
>
>外部ソースからオーディエンスを追加する場合、オーディエンスのメンバーシップのみが参照されます。 このオーディエンスをルールに変換することはできないので、元のオーディエンスの作成に使用されたルールは、新しいセグメント定義で変更できません。

![](../images/segment-builder/add-audience-to-segment.png)

オーディエンスをルールに変換する際に競合が発生した場合 [!DNL Segment Builder] 、は既存のオプションをその機能を最大限に保持しようとします。

### コード表示

または、で作成したルールのコードベースの表示を行うこともでき [!DNL Segment Builder]ます。 ルールビルダーキャンバス内にルールを作成したら、 **[!UICONTROL コード表示]** を選択して、セグメントをPQLとして表示できます。

![](../images/segment-builder/code-view.png)

コード表示には、API呼び出しで使用するセグメントの値をコピーできるボタンが用意されています。 セグメントの最新バージョンを取得するには、セグメントに対する最新の変更を保存していることを確認します。

![](../images/segment-builder/copy-code.png)

## コンテナ

セグメントルールは、リストに表示された順序で評価されます。 コンテナを使用すると、ネストされたクエリを使用して実行順序を制御できます。

ルールビルダーキャンバスに少なくとも1つのタイルを追加すると、コンテナの追加を開始できます。 新しいコンテナを作成するには、タイルの右上隅にある三点リーダー(...)をクリックし、「 **[!UICONTROL コンテナ]**」をクリックします。

![](../images/segment-builder/add-container.png)

新しいコンテナが最初のコンテナの子として表示されますが、コンテナをドラッグ&amp;移動して階層を調整できます。 コンテナのデフォルトの動作は、提供された属性、イベント、またはオーディエンスを「[!UICONTROL 含める]」ことです。 ルールを「[!UICONTROL 除外]」プロファイルに設定するには、タイルの左上隅にある「 **[!UICONTROL 含める]** 」をクリックし、「除外する」を選択します。

子コンテナの「コンテナを解除」をクリックして、子コンテナを抽出し、親コンテナにインラインで追加することもできます。 子コンテナの右上隅にある三点リーダー(...)をクリックして、このオプションにアクセスします。

![](../images/segment-builder/include-exclude.png)

「 **[!UICONTROL コンテナを解除]** 」をクリックすると、子コンテナが削除され、条件がインラインで表示されます。

>[!NOTE]
>
>コンテナのラッピングを解除する場合、ロジックが引き続き目的のセグメント定義を満たすように注意してください。

![](../images/segment-builder/unwrapped-container-inline.png)

## 結合ポリシー

[!DNL Experience Platform] を使用すると、複数のソースからのデータをまとめ、それを組み合わせて個々の顧客の完全な表示を確認できます。 When bringing this data together, merge policies are the rules that [!DNL Platform] uses to determine how data will be prioritized and what data will be combined to create a profile.

このオーディエンスのマーケティング目的に一致するマージポリシーを選択するか、またはが提供するデフォルトのマージポリシーを使用でき [!DNL Platform]ます。 独自のデフォルトの結合ポリシーの作成など、組織固有の複数の結合ポリシーを作成できます。 組織の結合ポリシーを作成する手順については、UIを使用した結合ポリシーの [操作に関するチュートリアルを参照してください](../../profile/ui/merge-policies.md)。

セグメント定義の結合ポリシーを選択するには、「 *[!UICONTROL フィールド]* 」タブの歯車アイコンをクリックし、 *[!UICONTROL 結合ポリシー](Merge Policy *)ドロップダウンメニューを使用して、使用する結合ポリシーを選択します。

![](../images/segment-builder/merge-policy-selector.png)

## セグメントのプロパティ

セグメント定義を作成すると、ワークスペースの右側の「 *[!UICONTROL セグメントプロパティ]* 」セクションに結果のセグメントのサイズの予測が表示され、オーディエンス自体を作成する前に、必要に応じてセグメント定義を調整できます。

「 *[!UICONTROL セグメントプロパティ]* 」セクションでは、セグメント定義に関する重要な情報( *[!UICONTROL 名前]* 、 **&#x200B;説明など)を指定することもできます。 セグメント定義名は、組織で定義されたセグメントの中でセグメントを識別するために使用されます。したがって、説明的、簡潔、一意である必要があります。

セグメント定義を作成し続ける際に、 **[!UICONTROL 表示プロファイルを選択して、オーディエンスのページ分割プレビューを表示できます]**。

![](../images/segment-builder/segment-properties.png)

>[!NOTE]
>
>オーディエンスの見積もりは、その日のサンプルデータのサンプルサイズを使用して生成されます。 プロファイルストア内のエンティティが100万エンティティ未満の場合は、フルデータセットが使用されます。 100万から2000万のエンティティに対しては、100万のエンティティが使用されます。 2,000万以上のエンティティに対しては全体の5%が使用されます セグメント予測の生成に関する詳細は、セグメント作成チュートリアルの [予測生成セクション](../tutorials/create-a-segment.md#estimate-and-preview-an-audience) を参照してください。

## スケジュール済みセグメントの有効化 {#enable-scheduled-segmentation}

セグメント定義を作成したら、オンデマンドまたは予定（継続的）な評価を通じて、セグメント定義を評価できます。 評価手段は、対応するオーディエンスを生成するために、セグメント定義を介して [!DNL Real-time Customer Profile] データを移動させる。 作成したオーディエンスは保存、保存され、APIを使用して書き出せるようにな [!DNL Experience Platform] ります。

オンデマンド評価では、APIを使用して評価を実行し、必要に応じてオーディエンスを作成します。一方、予定評価（「予定セグメント化」とも呼ばれます）では、特定の時間（最大1日に1回）にセグメント定義を評価する定期的なスケジュールを作成できます。

スケジュールされた評価に対するセグメント定義の有効化は、UIまたはAPIを使用して行うことができます。 UIで、「 *[!UICONTROL セグメント」内の「]* 参照 **[!UICONTROL 」タブに戻り、「すべてのセグメントを]** 評価 **[!UICONTROL 」を切り替えます]**。 これにより、組織が設定したスケジュールに基づいてすべてのセグメントが評価されます。

>[!NOTE]
>
>スケジュールされた評価は、最大5つのマージポリシーを持つサンドボックスに対して有効にでき [!DNL XDM Individual Profile]ます。 1つのSandbox環境内に5つを超えるマージポリシーがある場合、 [!DNL XDM Individual Profile] 予定された評価を使用できません。

スケジュールは現在、APIを使用してのみ作成できます。 APIを使用してスケジュールを作成、編集、および操作する詳細な手順については、APIを使用したスケジュールされた評価の節を含む、セグメント結果の評価とアクセスに関するチュートリアルを参照して [ください](../tutorials/evaluate-a-segment.md#scheduled-evaluation)。

![](../images/segment-builder/scheduled-segmentation.png)

## ストリーミングセグメント {#streaming-segmentation}

>[!NOTE]
>
>ストリーミングセグメントを機能させるには、お客様が組織でスケジュール済みのセグメントを有効にする必要があります。 スケジュールされたセグメント化を有効にする方法の詳細については、このユーザーガイド [の前の節を参照してください](#enable-scheduled-segmentation)。

次のいずれかの条件を満たす場合、クエリはストリーミングセグメント化によって自動的に評価されます。

| クエリ型 | 詳細 | 例 |
| ---------- | ------- | ------- |
| 受信ヒット | 時間制限のない、単一の着信イベントを参照するセグメント定義。 | ![](../images/segment-builder/incoming-hit.png) |
| 相対時間枠内での着信ヒット | 過去7日間に発生した単一のイベントを参照す **るセグメント定義**。 | ![](../images/segment-builder/relative-hit-success.png) |
| プロファイルを参照する着信ヒット | 時間制限のない、1つの着信イベント、および1つ以上のプロファイル属性を参照するセグメント定義。 | ![](../images/segment-builder/profile-hit.png) |
| 相対的な時間枠内のプロファイルを参照する着信ヒット | 過去7日間の、1つの着信イベントと1つ以上のプロファイル属性を参照す **るセグメント定義**。 | ![](../images/segment-builder/profile-relative-success.png) |
| プロファイルを参照する複数のイベント | 過去24時間以内に複数のイベントを参照するセグメント定義 **には** 、1つ以上のプロファイル属性が含まれます。 | ![](../images/segment-builder/event-history-success.png) |

次の節では、ストリーミングセグメントに対して **有効にしないリストセグメント定義の例を示します** 。

| クエリ型 | 詳細 |
| ---------- | ------- | 
| 相対時間枠内での着信ヒット | セグメント定義が、 **過去7日間** 以内でない着信イベントを参照する場合 ****。 例えば、 **過去2週間以内の場合**。 | ![](../images/segment-builder/relative-hit-failure.png) |
| 相対的なウィンドウ内のプロファイルを参照する着信ヒット | 次のオプションは、ストリーミングセグメントをサポートし **ません** 。<ul><li>過去7日間 **以** 内の着信イベント ****。</li><li>セグメントまたは特性を含む [!DNL Adobe Audience Manager (AAM)] セグメント定義。</li></ul> | ![](../images/segment-builder/profile-relative-failure.png) |
| プロファイルを参照する複数のイベント | 次のオプションは、ストリーミングセグメントをサポートし **ません** 。<ul><li>過去24時間以内に **発生しないイベント******。</li><li>Adobe Audience Manager(AAM)のセグメントまたは特性を含むセグメント定義。</li></ul> | ![](../images/segment-builder/event-history-failure.png) |
| マルチエンティティクエリ | マルチエンティティクエリは、全体として、ストリーミングセグメントでは **サポートされていません** 。 |  |

さらに、ストリーミングセグメント化を行う際には、次のようなガイドラインが適用されます。

| クエリ型 | ガイドライン |
| ---------- | -------- |
| 単一イベントクエリ | ルックバックウィンドウは **7日間に制限されています**。 |
| イベント履歴のあるクエリ | <ul><li>ルックバックウィンドウは **1日に制限されます**。</li><li>イベント間に厳密な時間順序条件 **が存在する** 。</li><li>イベント間の単純な時間順（前後）のみが許可されます。</li><li>個々のイベント **を無効にすることはできません** 。 ただし、クエリ全体を無効にす **ることはできます** 。</li></ul> |

### ストリーミングセグメントの監視

ストリーミングが有効なセグメントを作成したら、そのセグメントの詳細を監視できます。

![](../images/segment-builder/monitoring-streaming-segment.png)

特に、条件を満たした *[!UICONTROL オーディエンスの合計サイズ]* の詳細が表示されます。 ジョブが過去24時間以内に実行された場合は、追加されたオーディエンスの折れ線グラフに加えて、ジョブ **[!UICONTROL からのオーディエンスの合計サイズ]** (Total Job Size)が表示されます。 そうでない場合は、ビジュアライゼーションのトレンドラインに加えて **[!UICONTROL 、オーディエンスの推定サイズ]** が表示されます。

![](../images/segment-builder/monitoring-streaming-segment-graph.png)

最後のセグメント評価に関する追加情報は、情報バブルをクリックして確認できます。

![](../images/segment-builder/info-bubble.png)

### ストリーミングセグメントのビデオデモ

次のビデオでは、ストリーミングのセグメント化について理解しておくことを目的としています。 ここには、顧客体験の例を示し、その後インター [!DNL Platform] フェイスの主な機能を簡単に紹介します。

>[!VIDEO](https://video.tv.adobe.com/v/36184?quality=12&learn=on)

## ポリシー違反のスケジュール

>[!NOTE]
>
>SCHEDULEポリシー違反は、宛先に割り当てられたセグメントを作成する場合にのみ適用されます。

セグメントの作成が完了すると、セグメントが分析され、セグメント内にポリシー違反がないこ [!DNL Data Governance] とが確認されます。 DULEとポリシー違反の詳細については、「 [データ使用ラベルの概要](../../data-governance/labels/overview.md)」を参照してください。

![](../images/segment-builder/segment-dule-policy-violations.png)

## 次の手順とその他のリソース {#next-steps}

セグメントビルダーは、マーケティング可能なオーディエンスをデータから分離できる豊富なワークフローを提供し [!DNL Real-time Customer Profile] ます。 このガイドを読むと、次のことができるようになります。

- 属性、イベント、および既存のオーディエンスの組み合わせを構成要素として使用して、セグメント定義を作成します。
- [ルールビルダ]キャンバスとコンテナを使用して、セグメントルールの実行順序を制御します。
- 見込みオーディエンスの表示予測。必要に応じてセグメント定義を調整できます。
- スケジュール済みセグメントのすべてのセグメント定義を有効にします。
- ストリーミングセグメントに対して、指定したセグメント定義を有効にします。

詳しくは、ドキュメントを読み続け [!DNL Segmentation Service]て、以下のビデオを参照して学習内容を補ってください。 APIを使用した作業手順については、APIを使用した [!DNL Segmentation Service] オーディエンスセグメントの [!DNL Segmentation Service] 作成のチュートリアルを参照してください [](../tutorials/create-a-segment.md) 。

>[!WARNING]
>
> 次のビデオに示す [!DNL Platform] UIは古いです。 最新のUIのスクリーンショットと機能については、上記のドキュメントを参照してください。

**セグメントの作成：**

>[!VIDEO](https://video.tv.adobe.com/v/27254?quality=12&learn=on)

**動的セグメントの作成：**

>[!VIDEO](https://video.tv.adobe.com/v/27428?quality=12&learn=on)
