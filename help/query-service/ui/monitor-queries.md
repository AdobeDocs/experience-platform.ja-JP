---
title: スケジュール済みクエリの監視
description: クエリサービス UI を使用してクエリを監視する方法について説明します。
exl-id: 4640afdd-b012-4768-8586-32f1b8232879
source-git-commit: 1b4554e204663d40c3a18da792614305abb7d296
workflow-type: tm+mt
source-wordcount: '1252'
ht-degree: 72%

---

# スケジュール済みクエリの監視

Adobe Experience Platform では、UI を使用して、すべてのクエリジョブのステータスをより的確に把握できるようになりました。「[!UICONTROL スケジュール済みクエリ]」タブで、ステータス、スケジュールの詳細、失敗した場合のエラーメッセージ／コードなど、クエリの実行に関する重要な情報を確認できるようになりました。「[!UICONTROL スケジュール済みクエリ]」タブから、これらの任意のクエリについて、UI を使用して、ステータスに基づくクエリのアラートの配信を登録することもできます。

## [!UICONTROL スケジュール済みクエリ]

この [!UICONTROL 予定クエリ] 「 」タブには、スケジュールされたすべての CTAS および ITAS クエリの概要が表示されます。 すべてのスケジュール済みクエリの実行の詳細と、失敗したクエリのエラーコードおよびメッセージが見つかります。

「[!UICONTROL スケジュール済みクエリ]」タブに移動するには、左側のナビゲーションバーから「**[!UICONTROL クエリ]**」、「**[!UICONTROL スケジュール済みクエリ]**」の順に選択します。

![クエリワークスペースの「スケジュール済みクエリ」タブ](../images/ui/monitor-queries/scheduled-queries.png)

使用可能な各列を以下のテーブルに示します。

>[!NOTE]
>
>名称未設定列の各行に、アラート配信登録アイコンが含まれています。 詳しくは、[アラート配信登録](#alert-subscription)の節を参照してください。

| 列 | 説明 |
|---|---|
| **[!UICONTROL 名前]** | 名前フィールドは、テンプレート名か SQL クエリの最初の数文字のどちらかです。 クエリエディターを使用して UI から作成したクエリは、開始時に名前が付けられます。API を使用してクエリが作成された場合、その名前は、クエリの作成に使用される最初の SQL のスニペットになります。 次から任意の項目を選択： [!UICONTROL 名前] 列を使用して、クエリに関連付けられているすべての実行のリストを表示します。 詳しくは、 [クエリ実行スケジュールの詳細](#query-runs) 」セクションに入力します。 |
| **[!UICONTROL テンプレート]** | クエリのテンプレート名。 テンプレート名を選択してクエリエディターに移動します。 便宜上、クエリエディターにクエリテンプレートが表示されます。 テンプレート名がない場合、行はハイフンでマークされ、クエリエディターにリダイレクトしてクエリを表示することはできません。 |
| **[!UICONTROL SQL]** | SQL クエリのスニペット。 |
| **[!UICONTROL 実行頻度]** | これは、クエリを実行するように設定されるケイデンスです。 指定可能な値は `Run once` と `Scheduled` です。クエリは、実行頻度に従ってフィルタリングできます。 |
| **[!UICONTROL 作成者]** | クエリを作成したユーザーの名前。 |
| **[!UICONTROL 作成日]** | クエリが作成されたときのタイムスタンプ（UTC 形式）。 |
| **[!UICONTROL 前回実行時のタイムスタンプ]** | クエリ実行時の最新のタイムスタンプ。 この列では、現在のスケジュールに従ってクエリが実行されたかどうかがハイライト表示されます。 |
| **[!UICONTROL 前回の実行ステータス]** | 最新のクエリ実行ステータス。 ステータスの値は次のとおりです。 `Success`, `Failed`, `In progress`、および `No runs`. |

>[!TIP]
>
>クエリエディターに移動する場合は、「**[!UICONTROL クエリ]**」を選択して「[!UICONTROL テンプレート]」タブに戻ることができます。

### スケジュール済みクエリのテーブル設定のカスタマイズ

「[!UICONTROL スケジュール済みクエリ]」タブの列は、必要に応じて調整できます。「設定」アイコン（![設定アイコン](../images/ui/monitor-queries/settings-icon.png)）を選択して、[!UICONTROL テーブル設定をカスタマイズ]ダイアログを開き、使用可能な列を編集します。

![「テーブル設定をカスタマイズ」アイコン](../images/ui/monitor-queries/customze-table-settings-icon.png)

該当するチェックボックスを切り替えて、テーブル列を削除または追加します。 次に、「**[!UICONTROL 適用]**」をクリックして選択を確定します。

>[!NOTE]
>
>UI を使用して作成されたクエリは、作成プロセスの一環として名前付きテンプレートになります。 テンプレート列にテンプレート名が表示されます。 API を使用してクエリが作成された場合、テンプレート列は空白になります。

![テーブル設定をカスタマイズダイアログ。](../images/ui/monitor-queries/customize-table-dialog.png)

### アラートの配信を登録 {#alert-subscription}

「[!UICONTROL スケジュールされたクエリ]」タブからアラートの配信を登録できます。クエリ名の横にあるアラート通知アイコン（![アラートアイコン](../images/ui/monitor-queries/alerts-icon.png)）を選択し、[!UICONTROL アラート]ダイアログを開きます。[!UICONTROL アラート]ダイアログでは、UI 通知とメールアラートの両方の配信が登録されます。アラートは、クエリのステータスに基づいています。使用できるオプションは、`start`、`success` および `failure` の 3 つです。該当する 1 つ以上のチェックボックスをオンにし、「**[!UICONTROL 保存]**」を選択して配信を登録します。

![アラートの配信を登録するダイアログ。](../images/ui/monitor-queries/alert-subscription-dialog.png)

詳しくは、 [アラート購読 API ドキュメント](../api/alert-subscriptions.md) を参照してください。

### クエリのフィルタリング {#filter}

実行頻度に基づいてクエリをフィルタリングできます。「[!UICONTROL スケジュールされたクエリ]」タブで、フィルターアイコン（![フィルターアイコン](../images/ui/monitor-queries/filter-icon.png)）を選択して、フィルターサイドバーを開きます。

![フィルターアイコンがハイライト表示された「スケジュールされたクエリ」タブ。](../images/ui/monitor-queries/filter-queries.png)

実行頻度フィルターチェックボックスで「**[!UICONTROL スケジュール済み]**」または「**[!UICONTROL 1 回実行]**」を選択して、クエリのリストをフィルタリングします。

>[!NOTE]
>
>実行されたけれどスケジュールされていないクエリは、[!UICONTROL 1 回実行]と認定されます。

![フィルターサイドバーがハイライト表示された「スケジュールされたクエリ」タブ。](../images/ui/monitor-queries/filter-sidebar.png)

フィルター条件を有効にしたら、「**[!UICONTROL フィルターを非表示]**」を選択して、フィルターパネルを閉じます。

## クエリ実行スケジュールの詳細 {#query-runs}

クエリ名を選択して、スケジュールの詳細ページに移動します。このビューには、スケジュールされたクエリの一部として実行されたすべての実行内容のリストが表示されます。表示される情報に含まれているのは、開始時間と終了時間、ステータス、使用されたデータセットです。

![スケジュールの詳細ページ。](../images/ui/monitor-queries/schedule-details.png)

この情報は 5 列の表として表示されます。各行はクエリを 1 回実行したことを示しています。

| 列名 | 説明 |
|---|---|
| **[!UICONTROL クエリ実行 ID]** | 毎日の実行に対するクエリ実行 ID。を選択します。 **[!UICONTROL クエリ実行 ID]** をクリックして、 [!UICONTROL クエリ実行の概要]. |
| **[!UICONTROL クエリの実行開始]** | クエリが実行されたときのタイムスタンプ。これは UTC 形式です。 |
| **[!UICONTROL クエリの実行完了]** | クエリが完了したときのタイムスタンプ。これは UTC 形式です。 |
| **[!UICONTROL ステータス]** | 最新のクエリ実行ステータス。 ステータス値は `successful`、`failed`、`in progress` のいずれかです。 |
| **[!UICONTROL データセット]** | 実行に使われたデータセット。 |

スケジュールされたクエリの詳細は、[!UICONTROL プロパティ]パネルに表示されています。このパネルには、初回クエリ ID、クライアントタイプ、テンプレート名、クエリ SQL、スケジュールのケイデンスが含まれています。

![プロパティパネルがハイライト表示されたスケジュールの詳細ページ。](../images/ui/monitor-queries/properties-panel.png)

クエリ実行 ID を選択して実行の詳細ページに移動し、クエリ情報を表示します。

![実行 ID がハイライト表示されたスケジュールの詳細画面。](../images/ui/monitor-queries/navigate-to-run-details.png)

## クエリ実行の概要 {#query-run-overview}

この [!UICONTROL クエリ実行の概要] は、このスケジュール済みクエリの個々の実行に関する情報と、実行ステータスの詳細な分類を提供します。 また、このページには、クライアント情報と、クエリの失敗を引き起こした可能性のあるエラーの詳細も含まれます。

![概要セクションがハイライト表示された実行の詳細画面。](../images/ui/monitor-queries/query-run-details.png)

クエリステータスセクションには、クエリが失敗した場合のエラーコードとエラーメッセージが表示されます。

![エラーセクションが強調表示された実行の詳細画面](../images/ui/monitor-queries/failed-query.png)

このビューからクエリ SQL をクリップボードにコピーできます。 SQL スニペットの右上にある「コピー」アイコンを選択して、クエリをコピーします。 コードがコピーされたことを確認するポップアップメッセージが表示されます。

![「SQL コピー」アイコンが強調表示された実行詳細画面](../images/ui/monitor-queries/copy-sql.png)

### 匿名ブロックを含むクエリの詳細を実行 {#anonymous-block-queries}

匿名ブロックを使用して SQL ステートメントを構成するクエリは、個々のサブクエリに分割されます。 これにより、各クエリブロックの実行詳細を個別に調べることができます。

>[!NOTE]
>
>DROP コマンドを使用する匿名ブロックの実行詳細は、次のようになります。 **not** は、別のサブクエリとしてレポートされます。 CTAS クエリ、ITAS クエリ、および匿名ブロックサブクエリとして使用される COPY ステートメントに対して、個別の実行詳細を使用できます。 DROP コマンドの実行の詳細は、現在サポートされていません。

匿名ブロックは、 `$$` プレフィックスを使用します。 詳しくは、 [匿名ブロックドキュメント](../essential-concepts/anonymous-block.md) をクリックして、クエリサービスの匿名ブロックの詳細を確認します。

匿名ブロックサブクエリの実行ステータスの左側にタブがあります。 実行の詳細を表示するタブを選択します。

![匿名ブロッククエリを表示するクエリ実行の概要 複数のクエリタブがハイライト表示されます。](../images/ui/monitor-queries/anonymous-block-overview.png)

匿名ブロッククエリが失敗したイベントでは、この UI を使用してその特定のブロックのエラーコードを見つけることができます。

![クエリ実行の概要では、1 つのブロックのエラーコードがハイライト表示された匿名ブロッククエリを表示します。](../images/ui/monitor-queries/anonymous-block-failed-query.png)

「**[!UICONTROL クエリ]**」を選択してスケジュール詳細画面に戻るか、「**[!UICONTROL スケジュール済みクエリ]**」を選択して「[!UICONTROL スケジュール済みクエリ]」タブに戻ります。

![クエリがハイライト表示された実行詳細画面](../images/ui/monitor-queries/return-navigation.png)
