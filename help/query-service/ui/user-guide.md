---
keywords: Experience Platform;ホーム;人気のトピック;クエリエディター;クエリサービス;
solution: Experience Platform
title: クエリエディター UI ガイド
description: クエリエディターは、Adobe Experience Platform クエリサービスが提供するインタラクティブなツールで、Experience Platform ユーザーインターフェイス内でカスタマーエクスペリエンス（顧客体験）データのクエリを記述、検証および実行できます。クエリエディターでは、分析およびデータ調査のためのクエリを開発できます。また、開発目的でインタラクティブクエリを実行できるほか、非インタラクティブクエリを実行して Experience Platform のデータセットに入力することもできます。
exl-id: d7732244-0372-467d-84e2-5308f42c5d51
source-git-commit: ce937f1335283382189fa40f65aa268735c02715
workflow-type: tm+mt
source-wordcount: '2661'
ht-degree: 44%

---

# [!DNL Query Editor] UI ガイド

[!DNL Query Editor] は、Adobe Experience Platform [!DNL Query Service] が提供するインタラクティブなツールで、[!DNL Experience Platform] ユーザーインターフェイス内でカスタマーエクスペリエンス（顧客体験）データのクエリを記述、検証および実行できます。[!DNL Query Editor] では、分析およびデータ調査のためのクエリを開発できます。また、開発目的でインタラクティブクエリを実行できるほか、非インタラクティブクエリを実行して [!DNL Experience Platform] のデータセットに入力することもできます。

[!DNL Query Service] の概念と機能について詳しくは、[クエリサービスの概要](../home.md)を参照してください。[!DNL Platform] 上でクエリサービスのユーザーインターフェイスを操作する方法について詳しくは、[クエリサービス UI の概要](./overview.md)を参照してください。

>[!NOTE]
>
>クエリサービスの特定の機能は、従来のバージョンのクエリエディターでは提供されていません。 このドキュメントで使用されるスクリーンショットは、特に指定のない限り、クエリエディターの拡張バージョンを使用して取得されています。 のセクションを参照してください。 [クエリエディターの強化](#enhanced-editor-toggle) を参照してください。

## はじめに {#getting-started}

[!DNL Query Editor] は、に接続することで、クエリを柔軟に実行できます。 [!DNL Query Service]、およびクエリは、この接続がアクティブなときにのみ実行されます。

## [!DNL Query Editor] へのアクセス {#accessing-query-editor}

[!DNL Experience Platform] UI で、左側のナビゲーションメニューの「**[!UICONTROL クエリ]**」を選択して、[!DNL Query Service] ワークスペースを開きます。次に、クエリの記述を開始するには、を選択します **[!UICONTROL クエリを作成]** をクリックします。 このリンクは、[!DNL Query Service] ワークスペースのどのページからも利用できます。

![「クエリを作成」がハイライト表示された「クエリワークスペースの概要」タブ](../images/ui/query-editor/create-query.png)

### [!DNL Query Service] への接続  {#connecting-to-query-service}

クエリエディターを開くと、クエリサービスが初期化され接続されるまでに数秒かかります。 クエリサービスに接続されると、コンソールに表示されます（以下を参照）。エディターがクエリサービスに接続される前にクエリを実行しようとすると、接続が完了するまで実行が待機されます。

![初回接続時のクエリエディターのコンソール出力](../images/ui/query-editor/connect.png)

### [!DNL Query Editor] からのクエリの実行方法 {#run-a-query}

から実行されたクエリ [!DNL Query Editor] をインタラクティブに実行します。つまり、ブラウザーを閉じたり、ブラウザーから移動したりすると、クエリはキャンセルされます。 クエリ出力からデータセットを生成するように作成されたクエリについても、同じことが言えます。

クエリエディターの拡張版では、クエリエディターに複数のクエリを書き込み、すべてのクエリを順番に実行できます。 の節を参照してください。 [複数の順次クエリの実行](#execute-multiple-sequential-queries) を参照してください。

## [!DNL Query Editor] を使用したクエリオーサリング {#query-authoring}

[!DNL Query Editor] を使用すると、顧客体験データのクエリを記述、実行および保存できます。[!DNL Query Editor] で実行または保存されたすべてのクエリは、[!DNL Query Service] にアクセスできる組織内のすべてのユーザーが利用できます。

>[!IMPORTANT]
>
>2024 年 4 月 30 日（PT）より、拡張クエリエディターがすべてのユーザーのデフォルトエディターになります。 レガシーエディターは 2024 年 5 月 30 日（PT）に非推奨（廃止予定）となり、使用できなくなります。

## クエリエディターの切り替え機能の強化 {#enhanced-editor-toggle}

>[!CONTEXTUALHELP]
>id="platform_queryService_queryEditor_enhancedEditorToggle"
>title="エディターの切替スイッチの機能強化"
>abstract="クエリエディターのレガシーバージョンと拡張バージョンを切り替えます。レガシーバージョンはデフォルトで有効になっていますが、拡張バージョンはアクセシビリティと複数テーマのサポートを強化します。これらの変更点について詳しくは、ドキュメントを参照してください。"

UI の切り替えにより、クエリエディターのレガシーバージョンと拡張バージョンを切り替えることができます。 レガシーバージョンはデフォルトで有効になっていますが、拡張バージョンはアクセシビリティと複数テーマのサポートを強化します。拡張バージョンを有効にして、クエリエディター設定にアクセスします。

![強化されたクエリエディター切り替えがハイライト表示されたクエリエディター。](../images/ui/query-editor/enhanced-query-editor-toggle.png)

切替スイッチをアクティブ化すると、エディターがライトテーマに切り替わり、構文の読みやすさが向上します。 オートコンプリート切り替えを組み込んだクエリエディター入力フィールドの上に、設定アイコンも表示されます。 設定アイコンから、ダークテーマを有効にしたり、オートコンプリートを無効/有効にしたりできます。

>[!TIP]
>
>強化されたクエリエディターでは、次のことができます [!UICONTROL 構文のオートコンプリートを無効にする] 進行状況を失わずにクエリをオーサリングする場合。 通常、編集時にオートコンプリート機能を無効にすると、クエリに対するすべての変更が失われます。

暗いテーマまたは明るいテーマを有効にするには、設定アイコン（![設定アイコン。](../images/ui/query-editor/settings-icon.png)）に続いて、表示されるドロップダウンメニューのオプションを選択します。

![「設定」アイコンと「ダークテーマを有効にする」ドロップダウンメニューオプションがハイライト表示されたクエリエディター。](../images/ui/query-editor/query-editor-settings.png)

### 複数の順次クエリの実行 {#execute-multiple-sequential-queries}

クエリエディターの強化版を使用すると、クエリエディターで複数のクエリを記述し、すべてのクエリを順番に実行できます。

複数のクエリを順番に実行すると、それぞれログエントリが生成されます。 ただし、クエリエディターコンソールには、最初のクエリの結果のみが表示されます。 実行されたクエリのトラブルシューティングや確認が必要な場合は、クエリログを確認します。 を参照してください。 [クエリログのドキュメント](./query-logs.md) を参照してください。

>[!NOTE]
> 
>クエリエディターで最初のクエリを実行した後に CTAS クエリを実行すると、テーブルは作成されますが、クエリエディターコンソールには出力されません。

### 選択したクエリの実行 {#execute-selected-query}

複数のクエリを記述したが、実行する必要があるクエリが 1 つだけの場合は、選択したクエリをハイライト表示し、
[!UICONTROL 選択したクエリを実行] アイコン。 このアイコンは、エディター内でクエリ構文を選択するまで、デフォルトで無効になっています。

![を使用したクエリエディター [!UICONTROL 選択したクエリを実行] アイコンがハイライト表示されています。](../images/ui/query-editor/run-selected-query.png)

### 結果数 {#result-count}

クエリエディターの出力行は最大 50,000 行です。 クエリエディターコンソールに一度に表示する行数を選択できます。 コンソールに表示される行数を変更するには、 **[!UICONTROL 結果数]** 50、100、150、300、500 の各オプションからドロップダウンおよび選択できます。

![結果数のドロップダウンがハイライト表示されたクエリエディター。](../images/ui/query-editor/result-count.png)

## クエリの記述 {#writing-queries}

[!UICONTROL クエリエディター]は、クエリをできるだけ簡単に記述できるように構成されています。次のスクリーンショットは、UI でエディターがどのように表示されるかを示しています。ここでは、SQL 入力フィールドと「**再生**」がハイライト表示されています。

![SQL 入力フィールドと「再生」がハイライト表示されたクエリエディター](../images/ui/query-editor/editor.png)

開発時間を最小限に抑えるために、返される行数に制限のあるクエリを開発することをお勧めします。 たとえば、`SELECT fields FROM table WHERE conditions LIMIT number_of_rows` のように設定します。クエリが目的どおりの出力を生成することを確認したら、制限を解除して、`CREATE TABLE tablename AS SELECT` と設定してクエリを実行し、データセットを生成します。

## [!DNL Query Editor] の記述ツール {#writing-tools}

- **構文の自動ハイライト表示：** SQL の読み取りと構成が容易になります。

![構文カラーハイライト表示の例を示すクエリエディター内の SQL ステートメント](../images/ui/query-editor/syntax-highlight.png)

- **SQL キーワードのオートコンプリート：**&#x200B;クエリの入力を開始し、矢印キーを使用して目的の用語に移動して、**Enter** キーを押します。

![クエリエディターで SQL を数文字入力するとオートコンプリートドロップダウンメニューに選択肢が表示される様子](../images/ui/query-editor/syntax-auto.png)

- **テーブルとフィールドのオートコンプリート**：`SELECT` 元のテーブル名の入力を開始し、矢印キーを使用して目的の表に移動して、**Enter** キーを押します。テーブルが選択されると、オートコンプリートはそのテーブル内のフィールドを認識します。

![クエリエディターに入力するとドロップダウンにテーブル名の候補が表示される様子](../images/ui/query-editor/tables-auto.png)

### テキストの書式設定 {#format-text}

この [!UICONTROL テキストの書式設定] この機能は、標準化された構文スタイルを追加することで、クエリをわかりやすくします。 を選択 **[!UICONTROL テキストの書式設定]** クエリエディター内のすべてのテキストを標準化します。

>[!NOTE]
>
>この [!UICONTROL テキストの書式設定] この機能は匿名ブロックでは動作しません。 1 つ以上の SQL 文を順番に連結する方法については、を参照してください。 [匿名ブロックドキュメント](../key-concepts/anonymous-block.md).

![クエリエディター： [!UICONTROL テキストの書式設定] ハイライト表示された SQL 文](../images/ui/query-editor/format-text.png)

<!-- ### Undo text {#undo-text}

If you format your SQL in the Query Editor, you can undo the formatting applied by the [!UICONTROL Format text] feature. To return your SQL back to its original form, select **[!UICONTROL Undo text]**.

![The Query Editor with [!UICONTROL Undo text] and the SQL statements highlighted.](../images/ui/query-editor/undo-text.png) -->

### SQL をコピー {#copy-sql}

コピーアイコンを選択して、クエリエディターからクリップボードに SQL をコピーします。 このコピー機能は、クエリテンプレートと、クエリエディターで新しく作成されたクエリの両方で使用できます。

![コピーアイコンがハイライト表示されたサンプルクエリテンプレートを含むクエリワークスペース。](../images/ui/query-editor/copy-sql.png)

### オートコンプリート UI 設定の切り替え {#auto-complete}

[!DNL Query Editor] では、クエリの記述時に、可能性のある SQL キーワードとテーブル名または列名の候補を自動的に表示します。オートコンプリート機能はデフォルトで有効になっており、クエリエディターの右上にある[!UICONTROL 構文のオートコンプリート]を切り替えることで、いつでも無効または有効にすることができます。

オートコンプリートの設定はユーザーごとに行われ、そのユーザーが次にログインしたときも記憶されています。

>[!NOTE]
>
>構文のオートコンプリート切り替えは、クエリエディターのレガシーバージョンでのみ使用できます。

![構文のオートコンプリート切り替えがハイライト表示されたクエリエディター](../images/ui/query-editor/auto-complete-toggle.png)

この機能を無効にすると、いくつかのメタデータコマンドが処理されなくなり、クエリの編集時に作成者のスピードアップにつながるレコメンデーションが提案されます。

切り替えスイッチを使用してオートコンプリート機能を有効にすると、短い一時停止の後、テーブル名や列名の推奨候補や SQL キーワードを使用できるようになります。 クエリエディターの下のコンソールに表示される成功メッセージは、この機能がアクティブであることを示します。

オートコンプリート機能を無効にした場合は、ページを更新して設定を反映させる必要があります。 [!UICONTROL 構文のオートコンプリート]切り替えを無効にすると、3 つのオプションを含んだ確認ダイアログが表示されます。

- [!UICONTROL キャンセル]
- [!UICONTROL 変更を保存して更新]
- [!UICONTROL 変更を保存せずに更新]

>[!IMPORTANT]
>
>この機能を無効にしてクエリを記述または編集する場合、ページを更新する前にクエリに対する変更を保存する必要があります。さもないと、進捗がすべて失われます。

![オートコンプリート機能を無効にするための確認ダイアログ。](../images/ui/query-editor/confirmation-dialog.png)

オートコンプリート機能を無効にするには、適切な確認オプションを選択します。

### エラーの検出 {#error-detection}

[!DNL Query Editor] は、クエリを記述する際に自動的に検証を行い、汎用 SQL 検証と特定の実行検証を行ないます。以下の画像のように、クエリの下に赤い下線が表示される場合は、クエリ内にエラーがあります。

<!-- ... Image below needs updating couldn't replicate the effect -->

![SQL を赤で下線付きで表示するクエリエディター入力は、エラーを示します。](../images/ui/query-editor/syntax-error-highlight.png)

エラーが検出された場合、SQL コードの上にカーソルを置くと、特定のエラーメッセージが表示されます。

<!-- ... Image below needs updating couldn't replicate the effect -->

![エラーメッセージを含むダイアログ。](../images/ui/query-editor/linting-error.png)

### クエリの詳細 {#query-details}

クエリエディターでクエリを表示するには、保存済みのテンプレートを次から選択します [!UICONTROL テンプレート] タブ。 クエリの詳細パネルには、選択したクエリを管理するための詳細情報とツールが表示されます。 また、クエリの最終変更日時や最終変更者（該当する場合）などの便利なメタデータも表示されます。

>[!NOTE]
>
>この [!UICONTROL スケジュールを表示], [!UICONTROL スケジュールを追加] および [!UICONTROL クエリを削除] オプションは、クエリがテンプレートとして保存された後でのみ使用できます。 この [!UICONTROL スケジュールを追加] オプションを選択すると、クエリエディターからスケジュールビルダーに直接移動します。 この [!UICONTROL スケジュールを表示] 「」オプションを選択すると、そのクエリのスケジュール在庫に直接移動します。 方法については、クエリスケジュールのドキュメントを参照してください [ui でのクエリスケジュールの作成](./query-schedules.md#create-schedule).

![クエリの詳細パネルがハイライト表示されたクエリエディター。](../images/ui/query-editor/query-details.png)

詳細パネルでは、UI から直接出力データセットを生成したり、表示されたクエリを削除または名前付けしたり、クエリ実行スケジュールを表示したり、クエリをスケジュールに追加したりできます。

出力データセットを生成するには、以下を選択します **[!UICONTROL CTAS として実行]**. この **[!UICONTROL 出力データセットの詳細を入力]** ダイアログが表示されます。 名前と説明を入力し、選択します **[!UICONTROL CTAS として実行]**. 新しいデータセットがに表示されます **[!UICONTROL データセット]** 「参照」タブ 参照： [データセットの表示ドキュメント](../../catalog/datasets/user-guide.md#view-datasets) 組織で使用可能なデータセットの詳細については、こちらを参照してください。

>[!NOTE]
>
>この [!UICONTROL CTAS として実行] オプションは、クエリに次の条件を満たす場合にのみ使用できます **ではない** がスケジュールされました。

![この [!UICONTROL 出力データセットの詳細を入力] ダイアログ。](../images/ui/query-editor/output-dataset-details.png)

を実行した後、 **[!UICONTROL CTAS として実行]** アクションが実行されると、確認メッセージがポップアップ表示され、アクションが成功したことが通知されます。 このポップアップメッセージには、クエリログワークスペースに移動するのに便利な方法を提供するリンクが含まれています。 を参照してください。 [クエリログのドキュメント](./query-logs.md) クエリログについて詳しくは、こちらを参照してください。

### クエリの保存 {#saving-queries}

[!DNL Query Editor] にはクエリを保存して後で作業できる保存機能があります。クエリを保存するには、次を選択します **[!UICONTROL 保存]** 右上隅に [!DNL Query Editor]. クエリを保存する前に、**[!UICONTROL クエリの詳細]**&#x200B;パネルを使用してクエリに名前を付ける必要があります。

>[!NOTE]
>
>クエリエディターを使用してで名前を付けて保存したクエリは、クエリダッシュボードの「[!UICONTROL テンプレート]」タブ内でテンプレートとして使用できます。 詳しくは、[テンプレートのドキュメント](./query-templates.md)を参照してください。

クエリエディターでクエリを保存すると、確認メッセージがポップアップ表示され、アクションが成功したことが通知されます。 このポップアップメッセージには、クエリスケジュールワークスペースに移動する便利な方法を提供するリンクが含まれています。 を参照してください。 [クエリのスケジュール設定ドキュメント](./query-schedules.md) カスタムケイデンスでクエリを実行する方法を説明します。

### スケジュール済みクエリ {#scheduled-queries}

テンプレートとして保存したクエリは、クエリエディターからスケジュールできます。 クエリをスケジュール設定すると、カスタムケイデンスでクエリの実行を自動化できます。 頻度、日時に基づいてクエリのスケジュールを設定したり、必要に応じて結果の出力データセットを選択したりできます。 クエリスケジュールは、UI から無効または削除することもできます。

スケジュールは、クエリエディターで設定します。 クエリエディターを使用する場合、既に作成、保存、実行されたクエリにのみスケジュールを追加できます。 次の場合も同じ制限は適用されません。 [!DNL Query Service] API:

方法については、クエリスケジュールのドキュメントを参照してください [ui でのクエリスケジュールの作成](./query-schedules.md). または、API を使用してスケジュールを追加する方法については、以下を参照してください。 [スケジュール済みクエリエンドポイントガイド](../api/scheduled-queries.md).

スケジュールされたクエリが「」のリストに追加されます [!UICONTROL スケジュール済みクエリ] タブ。 そのワークスペースから、UI を使用して、スケジュールされたすべてのクエリジョブのステータスを監視できます。 日 [!UICONTROL スケジュール済みクエリ] タブでは、クエリの実行に関する重要な情報を見つけたり、アラートを購読したりできます。 使用可能な情報には、ステータス、スケジュールの詳細、実行が失敗した場合のエラーメッセージ/コードが含まれます。 を参照してください。 [スケジュール済みクエリドキュメントの監視](./monitor-queries.md) を参照してください。


### 以前のクエリを検索する方法 {#previous-queries}

[!DNL Query Editor] で実行したクエリはすべて「ログ」テーブルに保存されます。「**[!UICONTROL ログ]**」タブの検索機能を使用して、クエリの実行を検索できます。保存したクエリは「**[!UICONTROL テンプレート]**」タブに表示されます。

クエリがスケジュールされている場合、「[!UICONTROL スケジュールされたクエリ]」タブでは、UI を使用してこれらのクエリジョブをより明確に表示できます。 詳しくは、[クエリ監視のドキュメント](./monitor-queries.md)を参照してください。

>[!NOTE]
>
>実行されなかったクエリは「ログ」に保存されません。クエリを [!DNL Query Service] で使用できるようにするには、[!DNL Query Editor] でクエリを実行するか保存する必要があります。

## クエリエディターを使用してクエリを実行する {#executing-queries}

[!DNL Query Editor] でクエリを実行するには、エディターに SQL を入力するか、「**[!UICONTROL ログ]**」タブまたは「**[!UICONTROL テンプレート]**」タブから以前のクエリを読み込み、「**再生**」を選択します。クエリ実行のステータスは下の「**[!UICONTROL コンソール]**」タブに表示され、出力データは「**[!UICONTROL 結果]**」タブに表示されます。

### コンソール {#console}

コンソールには、[!DNL Query Service] のステータスと処理に関する情報が表示されます。コンソールには、[!DNL Query Service] への接続状態、実行中のクエリ操作、およびこれらのクエリによるエラーメッセージが表示されます。

![クエリエディターコンソールの「コンソール」タブ](../images/ui/query-editor/console.png)

>[!NOTE]
>
>コンソールには、クエリの実行結果として発生したエラーのみが表示されます。 クエリの実行前に発生したクエリ検証エラーは表示されません。

### クエリの結果 {#query-results}

クエリが完了すると、結果が「**[!UICONTROL コンソール]**」タブの横の「**[!UICONTROL 結果]**」タブに表示されます。この表示には、クエリの表形式出力が表示され、選択した結果に応じて 50～500 行の結果が表示されます [結果数](#result-count). このビューを使用すると、クエリが目的どおりの出力を生成することを確認できます。クエリでデータセットを生成するには、返される行の制限を解除し、`CREATE TABLE tablename AS SELECT` と設定してクエリを実行します。[!DNL Query Editor] でクエリの結果からデータセットを生成する方法については、[データセットの生成についてのチュートリアル](./create-datasets.md)を参照してください。

![クエリ実行の結果を表示するクエリエディターコンソールの「結果」タブ](../images/ui/query-editor/query-results.png)

## ユースケース {#use-cases}

クエリサービスは、業界やビジネスシナリオをまたいだ様々なユースケースに対するソリューションを提供します。 これらの実例は、サービスが多様なニーズに対応する上で柔軟性と効果を発揮していることを示しています。 終了 [クエリサービスを使用して、特定のビジネスニーズにどのように価値を提供できるかを明らかにします](../use-cases/overview.md)の使用例に関するドキュメントの包括的なコレクションを確認します。 クエリサービスを使用して、運用効率とビジネス成功を強化するためのインサイトとソリューションを提供する方法を説明します。

## [!DNL Query Service] チュートリアルビデオを使用したクエリの実行 {#query-tutorial-video}

次のビデオでは、Adobe Experience Platform インターフェイスおよび PSQL クライアントでクエリを実行する方法を説明します。 また、このビデオでは、XDM オブジェクト内での個々のプロパティの使用、Adobe定義関数、CREATE TABLE AS SELECT （CTAS）クエリの使用方法についても説明します。

>[!VIDEO](https://video.tv.adobe.com/v/29796?quality=12&learn=on)

## 次の手順

[!DNL Query Editor] で使用できる機能とアプリケーションの操作方法について説明しました。これで、独自のクエリを [!DNL Platform] で直接記述できます。[!DNL Data Lake] のデータセットに対して SQL クエリを実行する方法については、[クエリの実行](../best-practices/writing-queries.md)に関するガイドを参照してください。
