---
keywords: Experience Platform;ホーム;人気のトピック;クエリエディター;クエリサービス;
solution: Experience Platform
title: クエリエディター UI ガイド
description: クエリエディターは、Adobe Experience Platform クエリサービスが提供するインタラクティブなツールで、Experience Platform ユーザーインターフェイス内でカスタマーエクスペリエンス（顧客体験）データのクエリを記述、検証および実行できます。クエリエディターでは、分析およびデータ調査のためのクエリを開発できます。また、開発目的でインタラクティブクエリを実行できるほか、非インタラクティブクエリを実行して Experience Platform のデータセットに入力することもできます。
exl-id: d7732244-0372-467d-84e2-5308f42c5d51
source-git-commit: 58eadaaf461ecd9598f3f508fab0c192cf058916
workflow-type: tm+mt
source-wordcount: '2100'
ht-degree: 98%

---

# [!DNL Query Editor] UI ガイド

[!DNL Query Editor] は、Adobe Experience Platform [!DNL Query Service] が提供するインタラクティブなツールで、[!DNL Experience Platform] ユーザーインターフェイス内でカスタマーエクスペリエンス（顧客体験）データのクエリを記述、検証および実行できます。[!DNL Query Editor] では、分析およびデータ調査のためのクエリを開発できます。また、開発目的でインタラクティブクエリを実行できるほか、非インタラクティブクエリを実行して [!DNL Experience Platform] のデータセットに入力することもできます。

[!DNL Query Service] の概念と機能について詳しくは、[クエリサービスの概要](../home.md)を参照してください。[!DNL Platform] 上でクエリサービスのユーザーインターフェイスを操作する方法について詳しくは、[クエリサービス UI の概要](./overview.md)を参照してください。

## はじめに {#getting-started}

[!DNL Query Editor] では、[!DNL Query Service] に接続することでクエリを柔軟に実行できます。クエリは、この接続がアクティブなときにのみ実行されます。

### [!DNL Query Service] への接続  {#connecting-to-query-service}

[!DNL Query Editor] を開くと、初期化と [!DNL Query Service] への接続に数秒かかります。クエリサービスに接続されると、コンソールに表示されます（以下を参照）。エディターがクエリサービスに接続される前にクエリを実行しようとすると、接続が完了するまで実行が待機されます。

![初回接続時のクエリエディターのコンソール出力](../images/ui/query-editor/connect.png)

### [!DNL Query Editor] からのクエリの実行方法 {#run-a-query}

[!DNL Query Editor] から実行されるクエリはインタラクティブに実行されます。つまり、ブラウザーを閉じたり、別の場所に移動したりすると、クエリはキャンセルされます。また、クエリ出力からデータセットを生成するために実行するクエリも同様です。

## [!DNL Query Editor] を使用したクエリオーサリング {#query-authoring}

[!DNL Query Editor] を使用すると、顧客体験データのクエリを記述、実行および保存できます。[!DNL Query Editor] で実行または保存されたすべてのクエリは、[!DNL Query Service] にアクセスできる組織内のすべてのユーザーが利用できます。

### [!DNL Query Editor] へのアクセス {#accessing-query-editor}

[!DNL Experience Platform] UI で、左側のナビゲーションメニューの「**[!UICONTROL クエリ]**」を選択して、[!DNL Query Service] ワークスペースを開きます。次に、画面の右上にある「**[!UICONTROL クエリを作成]**」を選択して、クエリの記述を開始します。このリンクは、[!DNL Query Service] ワークスペースのどのページからも利用できます。

![「クエリを作成」がハイライト表示された「クエリワークスペースの概要」タブ](../images/ui/query-editor/create-query.png)

### クエリの記述 {#writing-queries}

[!UICONTROL クエリエディター]は、クエリをできるだけ簡単に記述できるように構成されています。次のスクリーンショットは、UI でエディターがどのように表示されるかを示しています。ここでは、SQL 入力フィールドと「**再生**」がハイライト表示されています。

![SQL 入力フィールドと「再生」がハイライト表示されたクエリエディター](../images/ui/query-editor/editor.png)

開発時間を最小限に抑えるために、返される行を制限してクエリを開発することをお勧めします。たとえば、`SELECT fields FROM table WHERE conditions LIMIT number_of_rows` のように設定します。クエリが目的どおりの出力を生成することを確認したら、制限を解除して、`CREATE TABLE tablename AS SELECT` と設定してクエリを実行し、データセットを生成します。

### [!DNL Query Editor] の記述ツール {#writing-tools}

- **構文の自動ハイライト表示：** SQL の読み取りと構成が容易になります。

![構文カラーハイライト表示の例を示すクエリエディター内の SQL ステートメント](../images/ui/query-editor/syntax-highlight.png)

- **SQL キーワードのオートコンプリート：**&#x200B;クエリの入力を開始し、矢印キーを使用して目的の用語に移動して、**Enter** キーを押します。

![クエリエディターで SQL を数文字入力するとオートコンプリートドロップダウンメニューに選択肢が表示される様子](../images/ui/query-editor/syntax-auto.png)

- **テーブルとフィールドのオートコンプリート**：`SELECT` 元のテーブル名の入力を開始し、矢印キーを使用して目的の表に移動して、**Enter** キーを押します。テーブルを選択すると、オートコンプリートによってそのテーブルのフィールドが認識されます。

![クエリエディターに入力するとドロップダウンにテーブル名の候補が表示される様子](../images/ui/query-editor/tables-auto.png)

### （限定的なリリース）オートコンプリート UI 設定切り替え {#auto-complete}

>[!IMPORTANT]
>
>オートコンプリート UI 設定の切り替えは、現在、限られたリリースになっており、すべてのお客様が利用できるわけではありません。

[!DNL Query Editor] では、クエリの記述時に、可能性のある SQL キーワードとテーブル名または列名の候補を自動的に表示します。オートコンプリート機能はデフォルトで有効になっており、クエリエディターの右上にある[!UICONTROL 構文のオートコンプリート]を切り替えることで、いつでも無効または有効にすることができます。

オートコンプリートの設定はユーザーごとに行われ、そのユーザーが次にログインしたときも記憶されています。

![構文のオートコンプリート切り替えがハイライト表示されたクエリエディター](../images/ui/query-editor/auto-complete-toggle.png)

この機能を無効にすると、いくつかのメタデータコマンドが処理されなくなり、クエリの編集時に作成者のスピードアップにつながる推奨事項が提案されます。

切り替えスイッチを使用してオートコンプリート機能を有効にすると、短い一時停止の後、テーブル名や列名の推奨候補や SQL キーワードを使用できるようになります。 クエリエディターの下部のコンソールに表示される成功メッセージは、この機能がアクティブであることを示します。

オートコンプリート機能を無効にした場合は、ページを更新して設定を反映させる必要があります。 [!UICONTROL 構文のオートコンプリート]切り替えを無効にすると、3 つのオプションを含んだ確認ダイアログが表示されます。

- [!UICONTROL キャンセル]
- [!UICONTROL 変更を保存して更新]
- [!UICONTROL 変更を保存せずに更新]

>[!IMPORTANT]
>
>この機能を無効にしてクエリを記述または編集する場合、ページを更新する前にクエリに対する変更を保存する必要があります。さもないと、すべての変更が失われます。

![オートコンプリート機能を無効にするための確認ダイアログ。](../images/ui/query-editor/confirmation-dialog.png)

オートコンプリート機能を無効にするには、適切なオプションを選択します。

### エラーの検出 {#error-detection}

[!DNL Query Editor] は、クエリを記述する際に自動的に検証を行い、汎用 SQL 検証と特定の実行検証を行ないます。以下の画像のように、クエリの下に赤い下線が表示される場合は、クエリ内にエラーがあります。

![SQL を赤で下線付きで表示するクエリエディター入力は、エラーを示します。](../images/ui/query-editor/syntax-error-highlight.png)

エラーが検出された場合、SQL コードの上にカーソルを置くと、特定のエラーメッセージが表示されます。

![エラーメッセージを含むダイアログ。](../images/ui/query-editor/linting-error.png)

### クエリの詳細 {#query-details}

「[!UICONTROL テンプレート]」タブから保存済みのテンプレートを選択して、クエリエディターで表示します。クエリの詳細パネルには、選択したクエリを管理する詳細情報とツールが表示されます。

![クエリの詳細パネルがハイライト表示されたクエリエディター。](../images/ui/query-editor/query-details.png)

このパネルを使用すると、UI から直接出力データセットを生成し、表示されたクエリを削除または名前付け、クエリにスケジュールを追加できます。

このパネルには、クエリの最終変更日時や最終変更者（該当する場合）などの有効なメタデータも表示されます。データセットを生成するには、「**[!UICONTROL データセットを出力]**」を選択します。**[!UICONTROL データセットを出力]**&#x200B;ダイアログが表示されます。名前と説明を入力し、「**[!UICONTROL クエリを実行]**」を選択します。[!DNL Platform] で [!DNL Query Service] ユーザーインターフェイスの「**[!UICONTROL データセット]**」タブに、新しいデータセットが表示されます。

### スケジュール済みクエリ {#scheduled-queries}

>[!IMPORTANT]
>
>次に、クエリエディターを使用する場合のスケジュールされたクエリの制限事項を示します。[!DNL Query Service] API には適用されません：<br/>既に作成、保存、実行されたクエリにのみスケジュールを追加できます。<br/>パラメーター化クエリにスケジュールを追加することは&#x200B;**できません**。<br/>スケジュールされたクエリに匿名ブロックを含めることは&#x200B;**できません**。

スケジュールは、クエリエディターで設定します。ただし、既にテンプレートとして保存されているクエリのみをスケジュールできます。クエリにスケジュールを追加するには、「[!UICONTROL テンプレート]」タブまたは「[!UICONTROL スケジュールされたクエリ]」タブからクエリテンプレートを選択して、クエリエディターに移動します。

API を使用してスケジュールを追加する方法について詳しくは、[スケジュールされたクエリのエンドポイントガイド](../api/scheduled-queries.md)を参照してください。

保存したクエリにクエリエディターからアクセスすると、「[!UICONTROL スケジュール]」タブがクエリ名の下に表示されます。「**[!UICONTROL スケジュール]**」を選択します。

![「スケジュール」タブがハイライトされたクエリエディター。](../images/ui/query-editor/schedules-tab.png)

スケジュールワークスペースが表示されます。「**[!UICONTROL スケジュールを追加]**」を選択して、スケジュールを作成します。

![「スケジュールを追加」がハイライト表示されたクエリエディタースケジュールのワークスペース。](../images/ui/query-editor/add-schedule.png)

スケジュールの詳細ページが表示されます。このページでは、スケジュールされたクエリの頻度、開始日と終了日、スケジュールされたクエリが実行される曜日およびクエリのエクスポート先のデータセットを選択できます。

![ハイライト表示されたスケジュールの詳細パネル。](../images/ui/query-editor/schedule-details.png)

**[!UICONTROL 頻度]**&#x200B;では、次のオプションが選択できます。

- **[!UICONTROL 毎時]**：スケジュールされたクエリは、1 時間ごとに、選択した期間で実行されます。
- **[!UICONTROL 毎日]**：スケジュールされたクエリは、 X 日ごとに、選択した時間、期間に実行されます。選択した時間は、ローカルタイムゾーンではなく、**UTC**&#x200B;であることに注意してください。
- **[!UICONTROL 毎週]**：選択したクエリは、選択した曜日、時間および期間に実行されます。選択した時間は、ローカルタイムゾーンではなく、**UTC**&#x200B;であることに注意してください。
- **[!UICONTROL 毎月]**：選択したクエリは、毎月、選択した日、時間および期間に実行されます。選択した時間は、ローカルタイムゾーンではなく、**UTC**&#x200B;であることに注意してください。
- **[!UICONTROL 毎年]**：選択したクエリは、毎年、選択した日、月、時間および期間に実行されます。選択した時間は、ローカルタイムゾーンではなく、**UTC**&#x200B;であることに注意してください。

データセットの場合は、既存のデータセットを使用するかまたは新しいデータセットを作成するかのどちらかを選択できます。

>[!IMPORTANT]
>
> 既存のデータセットを使用または新しいデータセットを作成する際は、データセットは既に設定されているため、`INSERT INTO` または `CREATE TABLE AS SELECT` をクエリの一部として含める必要は&#x200B;**ありません**。`INSERT INTO` または `CREATE TABLE AS SELECT` をスケジュールされたクエリの一部として含めた場合、エラーが発生します。

これらの詳細をすべて確認したら、「**[!UICONTROL 保存]**」を選択して、スケジュールを作成します。スケジュールワークスペースに戻ると、新しく作成したスケジュールの詳細（スケジュール ID、スケジュール自体、スケジュールの出力データセットなど）が表示されます。 スケジュール ID を使用して、スケジュールされたクエリ自体の実行に関する詳細を検索できます。詳しくは、[スケジュールされたクエリ実行エンドポイントガイド](../api/runs-scheduled-queries.md)を参照してください。

![新しく作成されたスケジュールがハイライト表示されたスケジュールワークスペース。](../images/ui/query-editor/schedules-workspace.png)

#### スケジュールを削除または無効にする {#delete-schedule}

スケジュールワークスペースからスケジュールを削除または無効にできます。「[!UICONTROL テンプレート]」タブまたは「[!UICONTROL スケジュールされたクエリ]」タブからクエリテンプレートを選択してクエリエディターに移動し、「**[!UICONTROL スケジュール]**」を選択してスケジュールワークスペースにアクセスする必要があります。

使用可能なスケジュールの行からスケジュールを選択します。切替スイッチを使用して、スケジュールされたクエリを無効または有効にできます。

>[!IMPORTANT]
>
>スケジュールを無効にしてから、クエリのスケジュールを削除する必要があります。

「**[!UICONTROL スケジュールを削除]**」を選択して、無効なスケジュールを削除します。

![「スケジュールを無効にする」と「スケジュールを削除」が強調表示されたスケジュールワークスペース。](../images/ui/query-editor/delete-schedule.png)

### クエリの保存 {#saving-queries}

[!DNL Query Editor] にはクエリを保存して後で作業できる保存機能があります。クエリを保存するには、[!DNL Query Editor] の右上隅にある「**[!UICONTROL 保存]**」を選択します。クエリを保存する前に、**[!UICONTROL クエリの詳細]**&#x200B;パネルを使用してクエリに名前を付ける必要があります。

>[!NOTE]
>
>クエリエディターを使用してで名前を付けて保存したクエリは、クエリダッシュボードの「[!UICONTROL テンプレート]」タブ内でテンプレートとして使用できます。 詳しくは、[テンプレートのドキュメント](./query-templates.md)を参照してください。

### 以前のクエリを検索する方法 {#previous-queries}

[!DNL Query Editor] で実行したクエリはすべて「ログ」テーブルに保存されます。「**[!UICONTROL ログ]**」タブの検索機能を使用して、クエリの実行を検索できます。保存したクエリは「**[!UICONTROL テンプレート]**」タブに表示されます。

クエリがスケジュールされている場合、「[!UICONTROL スケジュールされたクエリ]」タブでは、UI を使用してこれらのクエリジョブをより明確に表示できます。 詳しくは、[クエリ監視のドキュメント](../monitor-queries.md)を参照してください。

>[!NOTE]
>
>実行されなかったクエリは「ログ」に保存されません。クエリを [!DNL Query Service] で使用できるようにするには、[!DNL Query Editor] でクエリを実行するか保存する必要があります。

## クエリエディターを使用してクエリを実行する {#executing-queries}

[!DNL Query Editor] でクエリを実行するには、エディターに SQL を入力するか、「**[!UICONTROL ログ]**」タブまたは「**[!UICONTROL テンプレート]**」タブから以前のクエリを読み込み、「**再生**」を選択します。クエリ実行のステータスは下の「**[!UICONTROL コンソール]**」タブに表示され、出力データは「**[!UICONTROL 結果]**」タブに表示されます。

### コンソール {#console}

コンソールには、[!DNL Query Service] のステータスと処理に関する情報が表示されます。コンソールには、[!DNL Query Service] への接続状態、実行中のクエリ操作、およびこれらのクエリによるエラーメッセージが表示されます。

![クエリエディターコンソールの「コンソール」タブ](../images/ui/query-editor/console.png)

>[!NOTE]
>
>コンソールには、クエリの実行時に発生したエラーのみが表示されます。クエリを実行する前に、クエリ検証エラーは表示されません。

### クエリの結果 {#query-results}

クエリが完了すると、結果が「**[!UICONTROL コンソール]**」タブの横の「**[!UICONTROL 結果]**」タブに表示されます。このビューには、クエリの出力が表形式で出力され、最大 100 行まで表示されます。このビューを使用すると、クエリが目的どおりの出力を生成することを確認できます。クエリでデータセットを生成するには、返される行の制限を解除し、`CREATE TABLE tablename AS SELECT` と設定してクエリを実行します。[!DNL Query Editor] でクエリの結果からデータセットを生成する方法については、[データセットの生成についてのチュートリアル](./create-datasets.md)を参照してください。

![クエリ実行の結果を表示するクエリエディターコンソールの「結果」タブ](../images/ui/query-editor/query-results.png)

## [!DNL Query Service] チュートリアルビデオを使用したクエリの実行 {#query-tutorial-video}

次のビデオでは、Adobe Experience Platform インターフェイスおよび PSQL クライアントでクエリを実行する方法を説明します。 また、XDM オブジェクト内での個々のプロパティの使用方法、アドビ定義関数の使用方法、CREATE TABLE AS SELECT（CTAS）の使用方法も説明します。

>[!VIDEO](https://video.tv.adobe.com/v/29796?quality=12&learn=on)

## 次の手順

[!DNL Query Editor] で使用できる機能とアプリケーションの操作方法について説明しました。これで、独自のクエリを [!DNL Platform] で直接記述できます。[!DNL Data Lake] のデータセットに対して SQL クエリを実行する方法については、[クエリの実行](../best-practices/writing-queries.md)に関するガイドを参照してください。
