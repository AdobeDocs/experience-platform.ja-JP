---
title: 動的データストリーム設定の作成
description: 動的データストリーム設定を作成し、ルールに基づいて様々なExperience Cloud サービスにデータをルーティングする方法について説明します。
hide: true
hidefromtoc: true
badge: label="ベータ版" type="Informative"
exl-id: 528ddf89-ad87-4021-b5a6-8e25b4469ac4
source-git-commit: c193a6aa45d179acdf655a70987875bf0da51b2b
workflow-type: tm+mt
source-wordcount: '1146'
ht-degree: 4%

---

# 動的データストリーム設定の作成

>[!AVAILABILITY]
>
>* 動的データストリーム設定を定義するオプションは、現在Betaにあり、限られた数のお客様が利用できます。 この機能へのアクセス権を取得するには、Adobe担当者にお問い合わせください。 ドキュメントと機能は変更される場合があります。

デフォルトでは、Experience Platform Edge Networkは、データストリームに対して有効にしたすべてのExperience Cloud [ サービス ](configure.md#add-services) に、データストリームに到達するすべてのイベントを送信します。 ユースケースによっては、これが常に理想的なワークフローであるとは限りません。

動的データストリーム設定は、データストリームに対して有効な各サービスに対してユーザーが定義する一連のルールを使用して設定でき、各タイプのデータを受け取るExperience Cloud ソリューションを指定できるため、この問題に対処できます。

## 前提条件 {#prerequisites}

データストリームの動的設定を作成するには、次の 2 つの条件を満たす必要があります。

* 操作するデータストリームを *少なくとも* 1 つ作成している必要があります。 詳しくは、[ データストリームの作成 ](configure.md) 方法に関するドキュメントを参照してください。
* データストリームに *少なくとも* 1 つのExperience Cloud サービスを追加する必要があります。 詳しくは、データストリームに [ サービスを追加 ](configure.md#add-services) する方法のドキュメントを参照してください。

データストリームを作成し、Experience Cloud サービスを追加したら、[ 動的設定を作成 ](#create-dynamic-configuration) できます。

## ガードレール {#guardrails}

動的データストリーム設定には、最適なシステムパフォーマンスとデータ処理効率を確保するための特定の制限とパフォーマンスの制約があります。 動的データストリームルールを設定する際には、次のガードレールが適用されます。

| ガードレール | 上限 | 制限タイプ |
|---------|------------|------|
| Experience Platform サービスのデータストリームごとの動的データストリーム設定の最大数 | 5 | パフォーマンスガードレール |
| Adobe Analyticsのデータストリームごとの動的データストリーム設定の最大数 | 5 | パフォーマンスガードレール |
| Adobe Targetのデータストリームごとの動的データストリーム設定の最大数 | 5 | パフォーマンスガードレール |
| Adobe Audience Managerのデータストリームごとの動的データストリーム設定の最大数 | 5 | パフォーマンスガードレール |
| 1 つのルール内で組み合わせることができる条件（述語）の最大数 | 100 | パフォーマンスガードレール |
| データストリームごとの、すべての動的データストリーム設定の評価がタイムアウトするまでの最大許容時間 | 25 ミリ秒 | システムに適用されたガードレール |

## 動的データストリーム設定とデータストリーム設定の上書き {#dynamic-versus-overrides}

動的データストリーム設定と [ データストリーム設定の上書き ](overrides.md) は、相互に排他的な機能です。

つまり、データストリーム設定の上書きと共に動的データストリーム設定を使用することはできません。 どちらかを選ばなければなりません。

動的データストリーム設定およびデータストリーム設定の上書きの両方を有効にした場合は、設定の上書きが優先され、動的データストリーム設定のルールは無視されます。

## 動的データストリーム設定の作成 {#create-dynamic-configuration}

[ データストリームを作成 ](configure.md) して [ サービスを追加 ](configure.md#add-services) した後、次の手順に従ってサービスに動的設定を追加します。

1. **[!UICONTROL データ収集]**/**[!UICONTROL データストリーム]** ページに移動し、作成したデータストリームを選択します。

   ![ データストリームのリストを表示するデータストリームのユーザーインターフェイスの画像 ](assets/configure-dynamic-datastream/select-datastream.png)

1. 動的設定を定義するサービスの **[!UICONTROL 編集]** オプションを選択します。

   ![ データストリームに追加されたサービスを示すデータストリームのユーザーインターフェイスの画像 ](assets/configure-dynamic-datastream/select-service.png)

1. **[!UICONTROL 設定]** ページで、「**[!UICONTROL 動的設定を保存して編集]**」を選択します。

   ![ データストリーム設定ページを示すデータストリームのユーザーインターフェイスの画像 ](assets/configure-dynamic-datastream/save-and-edit.png)

1. 「**[!UICONTROL 動的設定を追加]**」を選択します。

   ![ ルールが追加されていない動的設定を示すデータストリームのユーザーインターフェイスの画像 ](assets/configure-dynamic-datastream/add-dynamic-config.png)

1. **[!UICONTROL リソース]** パネルから、ルールを作成する項目をウィンドウの右側にドラッグ&amp;ドロップします。 複数のリソースを組み合わせて、複雑なルールを作成できます。

   各リソースのオプション（**[!UICONTROL equals]**、**[!UICONTROL not equal]**、**[!UICONTROL exists]** など）を使用して、ルールを微調整します。

   ![ 動的設定ルールを示すデータストリームのユーザーインターフェイスの画像 ](assets/configure-dynamic-datastream/drag-resources.png)

1. 「**[!UICONTROL 設定]**」セクションでは、データを各サービスに送信するかどうかに応じて、ルールごとに有効または無効にするサービスを切り替えます。 トグルをオフにすると、サービスのルーティングが無効になり、アップストリームサービスに *データなし* が送信されます。

   ![ 動的設定ルールを示すデータストリームのユーザーインターフェイスの画像 ](assets/configure-dynamic-datastream/enable-service.png)

1. ルールの設定が完了したら、「**[!UICONTROL 保存]**」を選択します。

## ルールの優先度の考慮事項 {#considerations}

動的データストリーム設定ごとに複数のルールを定義できます。 ただし、データが複数のルールの条件に一致する場合は、リスト内の最初の一致するルールのみが考慮され、他のすべての一致するルールは無視されます。

目的のデータのルーティング動作を実現するには、ルールを配置する順序に注意を払います。

ルールの順序を設定するには、目的の順序でルールウィンドウをドラッグ&amp;ドロップします。

![ ドラッグ&amp;ドロップでルールの順序を変更する方法を示すGIF](assets/configure-dynamic-datastream/move-rules.gif)

## ルールの実施要件条件 {#eligibility-criteria}

動的データストリーム設定では、高いパフォーマンス、保守性、明確さを確保するために、特定の実施要件条件を満たす必要があります。 ルールを定義するための主な要件とベストプラクティスを以下に示します。

### サポートされるデータタイプ {#supported-data-types}

動的データストリーム設定ルールは、特定のデータタイプと連携して、最適なパフォーマンスと信頼性の高いデータルーティングを確保します。 サポートされているデータタイプを理解すると、データを効率的に処理する効果的なルールを作成するのに役立ちます。

| データタイプ | ステータス | メモ |
|-----------|--------|-------|
| 文字列 | 許可 | - |
| 数値（整数、ロング、ショート、バイト） | 許可 | - |
| 列挙 | 許可 | - |
| ブール値 | 許可 | - |
| 日付 | 許可 | - |
| 配列 | 許可されていません | 配列に基づくルールは、パフォーマンスが低下する可能性があるので、サポートされていません。 |
| マップ | 許可されていません | マップに基づくルールは、パフォーマンスが低下する可能性があるので、サポートされていません。 |

### サポートされる演算子 {#supported-operators}

ルールでは、データタイプに応じて次の演算子を使用できます。

| データタイプ | サポートされる演算子 |
|-----------|-------------------|
| **文字列** | `equals`, `starts with`, `ends with`, `contains`, `exists`, `does not equal`, `does not start with`, `does not end with`, `does not contain`, `does not exist` |
| **数値（Long、Integer、Short、Byte）** | `equals`, `does not equal`, `greater than`, `less than`, `greater than or equal to`, `less than or equal to`, `exists`, `does not exist` |
| **ブール値** | `equals true/false`, `does not equal true/false` |
| **列挙** | `equals`、`does not equal`、`exists`、`does not exist` |
| **日付** | `today`, `yesterday`, `this month`, `this year`, `custom date`, `in last`, `from`, `during`, `within`, `before`, `after`, `rolling range`, `in next`, `exists`, `does not exist` |
| **論理** | `INCLUDE`、`ANY/ALL` （AND/OR と同等） |

>[!NOTE]
>
>**[!UICONTROL EXCLUDE]** 演算子は直接サポートされていませんが、**[!UICONTROL INCLUDE]** を使用して、比較演算子を否定して（例：「等しくない」）、同等のロジックを実現できます。

### ルール構造 {#rule-structure}

動的データストリーム設定のルールを作成する場合は、最適なパフォーマンスとシステムの互換性を確保するための構造要件を理解することが重要です。 ルール構造は、データがシステム上で処理およびルーティングされる効率に直接影響します。

**フラットな式のみを使用** します。 ルールはフラットな論理式として定義する必要があります。 （コンテナまたは複数レベルの AND/OR を使用した）ネストされた論理式はサポートされていません。 複雑なロジックが必要な場合は、複数のフラットルールに分割します。

例えば、次の画像に示す複雑なルールについて考えてみましょう。

![ 複雑なルールを示す Platform UI 画像。](assets/configure-dynamic-datastream/complex-rule.png)

このルールは、次のより単純なルールに分割できます。

![ 複雑なルールを示す Platform UI 画像。](assets/configure-dynamic-datastream/simple-rule-1.png)

![ 複雑なルールを示す Platform UI 画像。](assets/configure-dynamic-datastream/simple-rule-2.png)

**複雑なルールは避けます**。 ルールを簡素化することで、迅速な評価とメンテナンス性の向上を実現します。

### ベストプラクティス {#best-practices}

動的データストリーム設定ルールを作成する際のベストプラクティスに従うと、最適なパフォーマンス、システムの信頼性、維持可能な設定が確保されます。 これらのガイドラインは、一般的な落とし穴を回避し、プラットフォームのアーキテクチャとシームレスに連携する効率的なルールを作成するのに役立ちます。

* **ルールはシンプルかつフラットにします。** 複雑なロジックを表現する必要がある場合は、ネストの代わりに複数のルールを使用します。
* **[ サポートされているデータ型 ](#supported-data-types) および [ 演算子 ](#supported-operators) のみを使用してください。**
* **パフォーマンスに関するルールをテストする。** 過度に複雑なルールやサポートされていないルールは、システムにより拒否されるか、システムのパフォーマンスに影響を与える可能性があります。





